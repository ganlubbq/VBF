

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the library &mdash; VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation" href="index.html"/>
        <link rel="next" title="Representations and characterizations" href="representations.html"/>
        <link rel="prev" title="Introduction" href="intro.html"/> 

  
  <script src="static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms
          

          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using the library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#an-example-program">An Example Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="#compiling">Compiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="#how-to-evaluate-new-algorithms">How to evaluate new algorithms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="representations.html">Representations and characterizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="criteria.html">Cryptographic Criteria</a></li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations and constructions over Vector Boolean Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="aes.html">Analysis of AES competition cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="cryptec.html">Analysis of CRYPTEC project cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="nessie.html">Analysis of NESSIE project cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Analysis of other cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design of cryptographically robust Vector Boolean functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Using the library</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="sources/using.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="using-the-library">
<h1>Using the library<a class="headerlink" href="#using-the-library" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#an-example-program" id="id1">An Example Program</a></li>
<li><a class="reference internal" href="#compiling" id="id2">Compiling</a></li>
<li><a class="reference internal" href="#how-to-evaluate-new-algorithms" id="id3">How to evaluate new algorithms</a></li>
</ul>
</div>
<p>This chapter describes how to compile programs that use VBF and how to evaluate new algorithms.</p>
<div class="section" id="an-example-program">
<h2><a class="toc-backref" href="#id1">An Example Program</a><a class="headerlink" href="#an-example-program" title="Permalink to this headline">¶</a></h2>
<p>The following program demonstrates the use of the library to analyze Vector Boolean Functions represented in decimal representation of its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;VBF.h&quot;</span><span class="cp"></span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">vec_long</span> <span class="n">vec_F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span>   <span class="n">c</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">A</span><span class="p">,</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span>  <span class="n">W</span><span class="p">,</span> <span class="n">LP</span><span class="p">,</span> <span class="n">DP</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span>  <span class="n">Ac</span><span class="p">;</span>
   <span class="kt">long</span> <span class="n">a</span><span class="p">;</span>
   <span class="kt">int</span>  <span class="n">n</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">file</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

   <span class="c1">// Load VBF definitions</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.dec&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">vec_F</span><span class="p">;</span>
   <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
   <span class="n">F</span><span class="p">.</span><span class="n">putDecTT</span><span class="p">(</span><span class="n">vec_F</span><span class="p">,</span><span class="n">n</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.anf&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">A</span> <span class="o">=</span> <span class="n">ANF</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Argument Dimension = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">.</span><span class="n">n</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Argument space has &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">.</span><span class="n">spacen</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; elements.&quot;</span><span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Image Dimension = &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">.</span><span class="n">m</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Image space has &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">.</span><span class="n">spacem</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; elements.&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Algebraic Normal Form to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[Columns = Image components]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">A</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.tt&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output1</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">T</span> <span class="o">=</span> <span class="n">TT</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Truth Table to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[Columns = Image components]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output1</span> <span class="o">&lt;&lt;</span> <span class="n">T</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output1</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.wal&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output2</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output2</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">W</span> <span class="o">=</span> <span class="n">Walsh</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Walsh Spectrum to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span><span class="n">endl</span><span class="p">;</span>
   <span class="n">output2</span> <span class="o">&lt;&lt;</span> <span class="n">W</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output2</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.lp&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output3</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output3</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">LP</span> <span class="o">=</span> <span class="n">LAT</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Linear Profile to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[To normalize divide by &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">LP</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output3</span> <span class="o">&lt;&lt;</span> <span class="n">LP</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output3</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.dp&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output4</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output4</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">DP</span> <span class="o">=</span> <span class="n">DAT</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Differential Profile to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[To normalize divide by &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">DP</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output4</span> <span class="o">&lt;&lt;</span> <span class="n">DP</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output4</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.pol&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output5</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output5</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing the polynomials in ANF to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">Pol</span><span class="p">(</span><span class="n">output5</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">output5</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.ls&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output6</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output6</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Linear structures to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">LS</span><span class="p">(</span><span class="n">output6</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">output6</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.ac&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output7</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output7</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">Ac</span> <span class="o">=</span> <span class="n">AC</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Autocorrelation Spectrum to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output7</span> <span class="o">&lt;&lt;</span> <span class="n">Ac</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">output7</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.cy&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ofstream</span> <span class="n">output8</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output8</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Writing Cycle Structure to file: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">printCycle</span><span class="p">(</span><span class="n">output8</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">output8</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span>  <span class="s">&quot;Nonlinearity: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">nlr</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="mi">2</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Second order Nonlinearity: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">a</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Linearity distance: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ld</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Algebraic degree: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">deg</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Algebraic immunity: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">AI</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Absolute indicator: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">maxAC</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Sum-of-squares indicator: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">sigma</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Linear potential: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">lp</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Differential potential: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Maximum Nonlinearity (if n is even): &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">nlmax</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Maximum Linearity distance: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">ldmax</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="kt">int</span> <span class="n">type</span><span class="p">;</span>
   <span class="n">typenl</span><span class="p">(</span><span class="n">type</span><span class="p">,</span> <span class="n">F</span><span class="p">);</span>

   <span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">BENT</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;It is a bent function&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">ALMOST_BENT</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;It is an almost bent function&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="p">}</span> <span class="k">else</span> <span class="k">if</span> <span class="p">(</span><span class="n">type</span> <span class="o">==</span> <span class="n">LINEAR</span><span class="p">)</span> <span class="p">{</span>
     <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;It is a linear function&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="p">}</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The fixed points are: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">fixedpoints</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The negated fixed points are: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">negatedfixedpoints</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Correlation immunity: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">CI</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="k">if</span> <span class="p">(</span><span class="n">Bal</span><span class="p">(</span><span class="n">F</span><span class="p">))</span>
   <span class="p">{</span>
     <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;It is a balanced function&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="p">}</span> <span class="k">else</span>
   <span class="p">{</span>
     <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;It is a non-balanced function&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The function is PC of degree &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">PC</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A set of files associated with the decimal representation of KASUMI S-boxes (S7.dec and S9.dec) are in the &#8220;Example&#8221; directory. If we use as input of the program above &#8220;S7.dec&#8221; (S7 Decimal representation), the output files would be:</p>
<ol class="arabic simple">
<li>S7.ac (Autocorrelation Spectrum)</li>
<li>S7.anf (ANF Table)</li>
<li>S7.cy (Cycle structure)</li>
<li>S7.dp (Differential Profile)</li>
<li>S7.lp (Linear Profile)</li>
<li>S7.ls (Linear structures): It is an empty vector because there is no linear structures</li>
<li>S7.pol (Polynomial representation)</li>
<li>S7.tt (Truth Table)</li>
<li>S7.wal (Walsh Spectrum)</li>
</ol>
<p>The same applies to S9 S-box analysis.</p>
</div>
<div class="section" id="compiling">
<h2><a class="toc-backref" href="#id2">Compiling</a><a class="headerlink" href="#compiling" title="Permalink to this headline">¶</a></h2>
<p>There is only one library header files called &#8220;VBF.h&#8221;. You should include a statement like this in the program that make use of VBF library,</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cp">#include</span> <span class="cpf">&quot;VBF.h&quot;</span><span class="cp"></span>
</pre></div>
</div>
<p>If the directory is not installed on the standard search path of your compiler you will also need to provide its location to the preprocessor as a command line flag. The default location of the ‘NTL’ directory is ‘/usr/local/include/NTL’. A typical compilation command for a source file ‘ex.cpp’ with the GNU C++ compiler g++ included in a Makefile is,</p>
<div class="highlight-c"><div class="highlight"><pre><span></span>GPP=g++
LIBS=-lntl
NTLINC= -I/usr/local/include -L/usr/local/lib

ex: ex.cpp VBF.h
     $(GPP) $(NTLINC) -Wall ex.cpp -o ex.exe $(LIBS)
</pre></div>
</div>
<p>This results in an executable file ‘ex.exe’ if the following command is executed:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> make ex
</pre></div>
</div>
<p>In order to execute the example program included in the &#8220;Example&#8221; program with S7.dec and S9.dec, the following commands must be executed:</p>
<div class="highlight-console"><div class="highlight"><pre><span></span><span class="gp">$</span> ./ex.exe S7 <span class="m">7</span>
<span class="gp">$</span> ./ex.exe S9 <span class="m">9</span>
</pre></div>
</div>
</div>
<div class="section" id="how-to-evaluate-new-algorithms">
<h2><a class="toc-backref" href="#id3">How to evaluate new algorithms</a><a class="headerlink" href="#how-to-evaluate-new-algorithms" title="Permalink to this headline">¶</a></h2>
<p>In order to evaluate an algorithm, we need to obtain a representation of this algorithm that can be used to initialize a VBF class. These representations are the Truth Table, Hexadecimal representation (only for Boolean functions), Decimal representation of its Truth Table, its trace together with the irreducible polynomial, Polynomials in ANF, ANF Table, Characteristic Function, Walsh Spectrum, permutation representation, Expansion and Compression DES vector representation, DES S-Box representation.</p>
<p>As an example we are going to describe the procedure followed to evaluate FI function in KASUMI algorithm. We used an implementation of KASUMI in c as you can see below:</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="cm">/*-----------------------------------------------------------------------</span>
<span class="cm"> *                                              Kasumi.c</span>
<span class="cm"> *-----------------------------------------------------------------------</span>
<span class="cm"> *</span>
<span class="cm"> *      A sample implementation of KASUMI, the core algorithm for the</span>
<span class="cm"> *      3GPP Confidentiality and Integrity algorithms.</span>
<span class="cm"> *</span>
<span class="cm"> *      This has been coded for clarity, not necessarily for efficiency.</span>
<span class="cm"> *</span>
<span class="cm"> *      This will compile and run correctly on both Intel (little endian)</span>
<span class="cm"> *      and Sparc (big endian) machines. (Compilers used supported 32-bit ints).</span>
<span class="cm"> *</span>
<span class="cm"> *      Version 1.1             08 May 2000</span>
<span class="cm"> *</span>
<span class="cm"> *-----------------------------------------------------------------------*/</span>

<span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;fstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;string&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&lt;sstream&gt;</span><span class="cp"></span>
<span class="cp">#include</span> <span class="cpf">&quot;VBF.h&quot;</span><span class="cp"></span>

<span class="cp">#include</span> <span class="cpf">&quot;Kasumi.h&quot;</span><span class="cp"></span>

<span class="cm">/*--------- 16 bit rotate left ------------------------------------------*/</span>

<span class="cp">#define ROL16(a,b) (u16)((a&lt;&lt;b)|(a&gt;&gt;(16-b)))</span>

<span class="cm">/*------- unions: used to remove &quot;endian&quot; issues ------------------------*/</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
        <span class="n">u32</span> <span class="n">b32</span><span class="p">;</span>
        <span class="n">u16</span> <span class="n">b16</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
        <span class="n">u8</span>  <span class="n">b8</span><span class="p">[</span><span class="mi">4</span><span class="p">];</span>
<span class="p">}</span> <span class="n">DWORD</span><span class="p">;</span>

<span class="k">typedef</span> <span class="k">union</span> <span class="p">{</span>
        <span class="n">u16</span> <span class="n">b16</span><span class="p">;</span>
        <span class="n">u8</span>  <span class="n">b8</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="p">}</span> <span class="n">WORD</span><span class="p">;</span>

<span class="cm">/*-------- globals: The subkey arrays -----------------------------------*/</span>

<span class="k">static</span> <span class="n">u16</span> <span class="n">KLi1</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">KLi2</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="k">static</span> <span class="n">u16</span> <span class="n">KOi1</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">KOi2</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">KOi3</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
<span class="k">static</span> <span class="n">u16</span> <span class="n">KIi1</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">KIi2</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">KIi3</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>


<span class="cm">/*---------------------------------------------------------------------</span>
<span class="cm"> *      FI()</span>
<span class="cm"> *              The FI function (fig 3).  It includes the S7 and S9 tables.</span>
<span class="cm"> *              Transforms a 16-bit value.</span>
<span class="cm"> *---------------------------------------------------------------------*/</span>

<span class="k">static</span> <span class="n">u16</span> <span class="nf">FI</span><span class="p">(</span> <span class="n">u16</span> <span class="n">in</span><span class="p">,</span> <span class="n">u16</span> <span class="n">subkey</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="n">u16</span> <span class="n">nine</span><span class="p">,</span> <span class="n">seven</span><span class="p">;</span>
        <span class="k">static</span> <span class="n">u16</span> <span class="n">S7</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">54</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span>
                <span class="mi">55</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">47</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span>
                <span class="mi">53</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span>
                <span class="mi">20</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span> <span class="mi">72</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span>
                <span class="mi">117</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span><span class="mi">126</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span>
                <span class="mi">112</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">97</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span>
                <span class="mi">102</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span>
                <span class="mi">64</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span><span class="mi">119</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span> <span class="mi">3</span><span class="p">};</span>
        <span class="k">static</span> <span class="n">u16</span> <span class="n">S9</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mi">167</span><span class="p">,</span><span class="mi">239</span><span class="p">,</span><span class="mi">161</span><span class="p">,</span><span class="mi">379</span><span class="p">,</span><span class="mi">391</span><span class="p">,</span><span class="mi">334</span><span class="p">,</span>  <span class="mi">9</span><span class="p">,</span><span class="mi">338</span><span class="p">,</span> <span class="mi">38</span><span class="p">,</span><span class="mi">226</span><span class="p">,</span> <span class="mi">48</span><span class="p">,</span><span class="mi">358</span><span class="p">,</span><span class="mi">452</span><span class="p">,</span><span class="mi">385</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span><span class="mi">397</span><span class="p">,</span>
                <span class="mi">183</span><span class="p">,</span><span class="mi">253</span><span class="p">,</span><span class="mi">147</span><span class="p">,</span><span class="mi">331</span><span class="p">,</span><span class="mi">415</span><span class="p">,</span><span class="mi">340</span><span class="p">,</span> <span class="mi">51</span><span class="p">,</span><span class="mi">362</span><span class="p">,</span><span class="mi">306</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">262</span><span class="p">,</span> <span class="mi">82</span><span class="p">,</span><span class="mi">216</span><span class="p">,</span><span class="mi">159</span><span class="p">,</span><span class="mi">356</span><span class="p">,</span><span class="mi">177</span><span class="p">,</span>
                <span class="mi">175</span><span class="p">,</span><span class="mi">241</span><span class="p">,</span><span class="mi">489</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span><span class="mi">206</span><span class="p">,</span> <span class="mi">17</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span><span class="mi">333</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span><span class="mi">254</span><span class="p">,</span><span class="mi">378</span><span class="p">,</span> <span class="mi">58</span><span class="p">,</span><span class="mi">143</span><span class="p">,</span><span class="mi">220</span><span class="p">,</span> <span class="mi">81</span><span class="p">,</span><span class="mi">400</span><span class="p">,</span>
                 <span class="mi">95</span><span class="p">,</span>  <span class="mi">3</span><span class="p">,</span><span class="mi">315</span><span class="p">,</span><span class="mi">245</span><span class="p">,</span> <span class="mi">54</span><span class="p">,</span><span class="mi">235</span><span class="p">,</span><span class="mi">218</span><span class="p">,</span><span class="mi">405</span><span class="p">,</span><span class="mi">472</span><span class="p">,</span><span class="mi">264</span><span class="p">,</span><span class="mi">172</span><span class="p">,</span><span class="mi">494</span><span class="p">,</span><span class="mi">371</span><span class="p">,</span><span class="mi">290</span><span class="p">,</span><span class="mi">399</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span>
                <span class="mi">165</span><span class="p">,</span><span class="mi">197</span><span class="p">,</span><span class="mi">395</span><span class="p">,</span><span class="mi">121</span><span class="p">,</span><span class="mi">257</span><span class="p">,</span><span class="mi">480</span><span class="p">,</span><span class="mi">423</span><span class="p">,</span><span class="mi">212</span><span class="p">,</span><span class="mi">240</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span><span class="mi">462</span><span class="p">,</span><span class="mi">176</span><span class="p">,</span><span class="mi">406</span><span class="p">,</span><span class="mi">507</span><span class="p">,</span><span class="mi">288</span><span class="p">,</span><span class="mi">223</span><span class="p">,</span>
                <span class="mi">501</span><span class="p">,</span><span class="mi">407</span><span class="p">,</span><span class="mi">249</span><span class="p">,</span><span class="mi">265</span><span class="p">,</span> <span class="mi">89</span><span class="p">,</span><span class="mi">186</span><span class="p">,</span><span class="mi">221</span><span class="p">,</span><span class="mi">428</span><span class="p">,</span><span class="mi">164</span><span class="p">,</span> <span class="mi">74</span><span class="p">,</span><span class="mi">440</span><span class="p">,</span><span class="mi">196</span><span class="p">,</span><span class="mi">458</span><span class="p">,</span><span class="mi">421</span><span class="p">,</span><span class="mi">350</span><span class="p">,</span><span class="mi">163</span><span class="p">,</span>
                <span class="mi">232</span><span class="p">,</span><span class="mi">158</span><span class="p">,</span><span class="mi">134</span><span class="p">,</span><span class="mi">354</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span><span class="mi">250</span><span class="p">,</span><span class="mi">491</span><span class="p">,</span><span class="mi">142</span><span class="p">,</span><span class="mi">191</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span><span class="mi">193</span><span class="p">,</span><span class="mi">425</span><span class="p">,</span><span class="mi">152</span><span class="p">,</span><span class="mi">227</span><span class="p">,</span><span class="mi">366</span><span class="p">,</span><span class="mi">135</span><span class="p">,</span>
                <span class="mi">344</span><span class="p">,</span><span class="mi">300</span><span class="p">,</span><span class="mi">276</span><span class="p">,</span><span class="mi">242</span><span class="p">,</span><span class="mi">437</span><span class="p">,</span><span class="mi">320</span><span class="p">,</span><span class="mi">113</span><span class="p">,</span><span class="mi">278</span><span class="p">,</span> <span class="mi">11</span><span class="p">,</span><span class="mi">243</span><span class="p">,</span> <span class="mi">87</span><span class="p">,</span><span class="mi">317</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">93</span><span class="p">,</span><span class="mi">496</span><span class="p">,</span> <span class="mi">27</span><span class="p">,</span>
                <span class="mi">487</span><span class="p">,</span><span class="mi">446</span><span class="p">,</span><span class="mi">482</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">68</span><span class="p">,</span><span class="mi">156</span><span class="p">,</span><span class="mi">457</span><span class="p">,</span><span class="mi">131</span><span class="p">,</span><span class="mi">326</span><span class="p">,</span><span class="mi">403</span><span class="p">,</span><span class="mi">339</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">39</span><span class="p">,</span><span class="mi">115</span><span class="p">,</span><span class="mi">442</span><span class="p">,</span><span class="mi">124</span><span class="p">,</span>
                <span class="mi">475</span><span class="p">,</span><span class="mi">384</span><span class="p">,</span><span class="mi">508</span><span class="p">,</span> <span class="mi">53</span><span class="p">,</span><span class="mi">112</span><span class="p">,</span><span class="mi">170</span><span class="p">,</span><span class="mi">479</span><span class="p">,</span><span class="mi">151</span><span class="p">,</span><span class="mi">126</span><span class="p">,</span><span class="mi">169</span><span class="p">,</span> <span class="mi">73</span><span class="p">,</span><span class="mi">268</span><span class="p">,</span><span class="mi">279</span><span class="p">,</span><span class="mi">321</span><span class="p">,</span><span class="mi">168</span><span class="p">,</span><span class="mi">364</span><span class="p">,</span>
                <span class="mi">363</span><span class="p">,</span><span class="mi">292</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span><span class="mi">499</span><span class="p">,</span><span class="mi">393</span><span class="p">,</span><span class="mi">327</span><span class="p">,</span><span class="mi">324</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span><span class="mi">456</span><span class="p">,</span><span class="mi">267</span><span class="p">,</span><span class="mi">157</span><span class="p">,</span><span class="mi">460</span><span class="p">,</span><span class="mi">488</span><span class="p">,</span><span class="mi">426</span><span class="p">,</span><span class="mi">309</span><span class="p">,</span><span class="mi">229</span><span class="p">,</span>
                <span class="mi">439</span><span class="p">,</span><span class="mi">506</span><span class="p">,</span><span class="mi">208</span><span class="p">,</span><span class="mi">271</span><span class="p">,</span><span class="mi">349</span><span class="p">,</span><span class="mi">401</span><span class="p">,</span><span class="mi">434</span><span class="p">,</span><span class="mi">236</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span><span class="mi">209</span><span class="p">,</span><span class="mi">359</span><span class="p">,</span> <span class="mi">52</span><span class="p">,</span> <span class="mi">56</span><span class="p">,</span><span class="mi">120</span><span class="p">,</span><span class="mi">199</span><span class="p">,</span><span class="mi">277</span><span class="p">,</span>
                <span class="mi">465</span><span class="p">,</span><span class="mi">416</span><span class="p">,</span><span class="mi">252</span><span class="p">,</span><span class="mi">287</span><span class="p">,</span><span class="mi">246</span><span class="p">,</span>  <span class="mi">6</span><span class="p">,</span> <span class="mi">83</span><span class="p">,</span><span class="mi">305</span><span class="p">,</span><span class="mi">420</span><span class="p">,</span><span class="mi">345</span><span class="p">,</span><span class="mi">153</span><span class="p">,</span><span class="mi">502</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">61</span><span class="p">,</span><span class="mi">244</span><span class="p">,</span><span class="mi">282</span><span class="p">,</span>
                <span class="mi">173</span><span class="p">,</span><span class="mi">222</span><span class="p">,</span><span class="mi">418</span><span class="p">,</span> <span class="mi">67</span><span class="p">,</span><span class="mi">386</span><span class="p">,</span><span class="mi">368</span><span class="p">,</span><span class="mi">261</span><span class="p">,</span><span class="mi">101</span><span class="p">,</span><span class="mi">476</span><span class="p">,</span><span class="mi">291</span><span class="p">,</span><span class="mi">195</span><span class="p">,</span><span class="mi">430</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">79</span><span class="p">,</span><span class="mi">166</span><span class="p">,</span><span class="mi">330</span><span class="p">,</span>
                <span class="mi">280</span><span class="p">,</span><span class="mi">383</span><span class="p">,</span><span class="mi">373</span><span class="p">,</span><span class="mi">128</span><span class="p">,</span><span class="mi">382</span><span class="p">,</span><span class="mi">408</span><span class="p">,</span><span class="mi">155</span><span class="p">,</span><span class="mi">495</span><span class="p">,</span><span class="mi">367</span><span class="p">,</span><span class="mi">388</span><span class="p">,</span><span class="mi">274</span><span class="p">,</span><span class="mi">107</span><span class="p">,</span><span class="mi">459</span><span class="p">,</span><span class="mi">417</span><span class="p">,</span> <span class="mi">62</span><span class="p">,</span><span class="mi">454</span><span class="p">,</span>
                <span class="mi">132</span><span class="p">,</span><span class="mi">225</span><span class="p">,</span><span class="mi">203</span><span class="p">,</span><span class="mi">316</span><span class="p">,</span><span class="mi">234</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span><span class="mi">301</span><span class="p">,</span> <span class="mi">91</span><span class="p">,</span><span class="mi">503</span><span class="p">,</span><span class="mi">286</span><span class="p">,</span><span class="mi">424</span><span class="p">,</span><span class="mi">211</span><span class="p">,</span><span class="mi">347</span><span class="p">,</span><span class="mi">307</span><span class="p">,</span><span class="mi">140</span><span class="p">,</span><span class="mi">374</span><span class="p">,</span>
                 <span class="mi">35</span><span class="p">,</span><span class="mi">103</span><span class="p">,</span><span class="mi">125</span><span class="p">,</span><span class="mi">427</span><span class="p">,</span> <span class="mi">19</span><span class="p">,</span><span class="mi">214</span><span class="p">,</span><span class="mi">453</span><span class="p">,</span><span class="mi">146</span><span class="p">,</span><span class="mi">498</span><span class="p">,</span><span class="mi">314</span><span class="p">,</span><span class="mi">444</span><span class="p">,</span><span class="mi">230</span><span class="p">,</span><span class="mi">256</span><span class="p">,</span><span class="mi">329</span><span class="p">,</span><span class="mi">198</span><span class="p">,</span><span class="mi">285</span><span class="p">,</span>
                 <span class="mi">50</span><span class="p">,</span><span class="mi">116</span><span class="p">,</span> <span class="mi">78</span><span class="p">,</span><span class="mi">410</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span><span class="mi">205</span><span class="p">,</span><span class="mi">510</span><span class="p">,</span><span class="mi">171</span><span class="p">,</span><span class="mi">231</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span><span class="mi">139</span><span class="p">,</span><span class="mi">467</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">86</span><span class="p">,</span><span class="mi">505</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span>
                 <span class="mi">72</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span><span class="mi">342</span><span class="p">,</span><span class="mi">150</span><span class="p">,</span><span class="mi">313</span><span class="p">,</span><span class="mi">490</span><span class="p">,</span><span class="mi">431</span><span class="p">,</span><span class="mi">238</span><span class="p">,</span><span class="mi">411</span><span class="p">,</span><span class="mi">325</span><span class="p">,</span><span class="mi">149</span><span class="p">,</span><span class="mi">473</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span><span class="mi">119</span><span class="p">,</span><span class="mi">174</span><span class="p">,</span><span class="mi">355</span><span class="p">,</span>
                <span class="mi">185</span><span class="p">,</span><span class="mi">233</span><span class="p">,</span><span class="mi">389</span><span class="p">,</span> <span class="mi">71</span><span class="p">,</span><span class="mi">448</span><span class="p">,</span><span class="mi">273</span><span class="p">,</span><span class="mi">372</span><span class="p">,</span> <span class="mi">55</span><span class="p">,</span><span class="mi">110</span><span class="p">,</span><span class="mi">178</span><span class="p">,</span><span class="mi">322</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span><span class="mi">469</span><span class="p">,</span><span class="mi">392</span><span class="p">,</span><span class="mi">369</span><span class="p">,</span><span class="mi">190</span><span class="p">,</span>
                  <span class="mi">1</span><span class="p">,</span><span class="mi">109</span><span class="p">,</span><span class="mi">375</span><span class="p">,</span><span class="mi">137</span><span class="p">,</span><span class="mi">181</span><span class="p">,</span> <span class="mi">88</span><span class="p">,</span> <span class="mi">75</span><span class="p">,</span><span class="mi">308</span><span class="p">,</span><span class="mi">260</span><span class="p">,</span><span class="mi">484</span><span class="p">,</span> <span class="mi">98</span><span class="p">,</span><span class="mi">272</span><span class="p">,</span><span class="mi">370</span><span class="p">,</span><span class="mi">275</span><span class="p">,</span><span class="mi">412</span><span class="p">,</span><span class="mi">111</span><span class="p">,</span>
                <span class="mi">336</span><span class="p">,</span><span class="mi">318</span><span class="p">,</span>  <span class="mi">4</span><span class="p">,</span><span class="mi">504</span><span class="p">,</span><span class="mi">492</span><span class="p">,</span><span class="mi">259</span><span class="p">,</span><span class="mi">304</span><span class="p">,</span> <span class="mi">77</span><span class="p">,</span><span class="mi">337</span><span class="p">,</span><span class="mi">435</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span><span class="mi">357</span><span class="p">,</span><span class="mi">303</span><span class="p">,</span><span class="mi">332</span><span class="p">,</span><span class="mi">483</span><span class="p">,</span> <span class="mi">18</span><span class="p">,</span>
                 <span class="mi">47</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span><span class="mi">497</span><span class="p">,</span><span class="mi">474</span><span class="p">,</span><span class="mi">289</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">269</span><span class="p">,</span><span class="mi">296</span><span class="p">,</span><span class="mi">478</span><span class="p">,</span><span class="mi">270</span><span class="p">,</span><span class="mi">106</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span><span class="mi">104</span><span class="p">,</span><span class="mi">433</span><span class="p">,</span> <span class="mi">84</span><span class="p">,</span>
                <span class="mi">414</span><span class="p">,</span><span class="mi">486</span><span class="p">,</span><span class="mi">394</span><span class="p">,</span> <span class="mi">96</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span><span class="mi">154</span><span class="p">,</span><span class="mi">511</span><span class="p">,</span><span class="mi">148</span><span class="p">,</span><span class="mi">413</span><span class="p">,</span><span class="mi">361</span><span class="p">,</span><span class="mi">409</span><span class="p">,</span><span class="mi">255</span><span class="p">,</span><span class="mi">162</span><span class="p">,</span><span class="mi">215</span><span class="p">,</span><span class="mi">302</span><span class="p">,</span><span class="mi">201</span><span class="p">,</span>
                <span class="mi">266</span><span class="p">,</span><span class="mi">351</span><span class="p">,</span><span class="mi">343</span><span class="p">,</span><span class="mi">144</span><span class="p">,</span><span class="mi">441</span><span class="p">,</span><span class="mi">365</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">298</span><span class="p">,</span><span class="mi">251</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span><span class="mi">182</span><span class="p">,</span><span class="mi">509</span><span class="p">,</span><span class="mi">138</span><span class="p">,</span><span class="mi">210</span><span class="p">,</span><span class="mi">335</span><span class="p">,</span><span class="mi">133</span><span class="p">,</span>
                <span class="mi">311</span><span class="p">,</span><span class="mi">352</span><span class="p">,</span><span class="mi">328</span><span class="p">,</span><span class="mi">141</span><span class="p">,</span><span class="mi">396</span><span class="p">,</span><span class="mi">346</span><span class="p">,</span><span class="mi">123</span><span class="p">,</span><span class="mi">319</span><span class="p">,</span><span class="mi">450</span><span class="p">,</span><span class="mi">281</span><span class="p">,</span><span class="mi">429</span><span class="p">,</span><span class="mi">228</span><span class="p">,</span><span class="mi">443</span><span class="p">,</span><span class="mi">481</span><span class="p">,</span> <span class="mi">92</span><span class="p">,</span><span class="mi">404</span><span class="p">,</span>
                <span class="mi">485</span><span class="p">,</span><span class="mi">422</span><span class="p">,</span><span class="mi">248</span><span class="p">,</span><span class="mi">297</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span><span class="mi">213</span><span class="p">,</span><span class="mi">130</span><span class="p">,</span><span class="mi">466</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span><span class="mi">217</span><span class="p">,</span><span class="mi">283</span><span class="p">,</span> <span class="mi">70</span><span class="p">,</span><span class="mi">294</span><span class="p">,</span><span class="mi">360</span><span class="p">,</span><span class="mi">419</span><span class="p">,</span><span class="mi">127</span><span class="p">,</span>
                <span class="mi">312</span><span class="p">,</span><span class="mi">377</span><span class="p">,</span>  <span class="mi">7</span><span class="p">,</span><span class="mi">468</span><span class="p">,</span><span class="mi">194</span><span class="p">,</span>  <span class="mi">2</span><span class="p">,</span><span class="mi">117</span><span class="p">,</span><span class="mi">295</span><span class="p">,</span><span class="mi">463</span><span class="p">,</span><span class="mi">258</span><span class="p">,</span><span class="mi">224</span><span class="p">,</span><span class="mi">447</span><span class="p">,</span><span class="mi">247</span><span class="p">,</span><span class="mi">187</span><span class="p">,</span> <span class="mi">80</span><span class="p">,</span><span class="mi">398</span><span class="p">,</span>
                <span class="mi">284</span><span class="p">,</span><span class="mi">353</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">390</span><span class="p">,</span><span class="mi">299</span><span class="p">,</span><span class="mi">471</span><span class="p">,</span><span class="mi">470</span><span class="p">,</span><span class="mi">184</span><span class="p">,</span> <span class="mi">57</span><span class="p">,</span><span class="mi">200</span><span class="p">,</span><span class="mi">348</span><span class="p">,</span> <span class="mi">63</span><span class="p">,</span><span class="mi">204</span><span class="p">,</span><span class="mi">188</span><span class="p">,</span> <span class="mi">33</span><span class="p">,</span><span class="mi">451</span><span class="p">,</span>
                 <span class="mi">97</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span><span class="mi">310</span><span class="p">,</span><span class="mi">219</span><span class="p">,</span> <span class="mi">94</span><span class="p">,</span><span class="mi">160</span><span class="p">,</span><span class="mi">129</span><span class="p">,</span><span class="mi">493</span><span class="p">,</span> <span class="mi">64</span><span class="p">,</span><span class="mi">179</span><span class="p">,</span><span class="mi">263</span><span class="p">,</span><span class="mi">102</span><span class="p">,</span><span class="mi">189</span><span class="p">,</span><span class="mi">207</span><span class="p">,</span><span class="mi">114</span><span class="p">,</span><span class="mi">402</span><span class="p">,</span>
                <span class="mi">438</span><span class="p">,</span><span class="mi">477</span><span class="p">,</span><span class="mi">387</span><span class="p">,</span><span class="mi">122</span><span class="p">,</span><span class="mi">192</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span><span class="mi">381</span><span class="p">,</span>  <span class="mi">5</span><span class="p">,</span><span class="mi">145</span><span class="p">,</span><span class="mi">118</span><span class="p">,</span><span class="mi">180</span><span class="p">,</span><span class="mi">449</span><span class="p">,</span><span class="mi">293</span><span class="p">,</span><span class="mi">323</span><span class="p">,</span><span class="mi">136</span><span class="p">,</span><span class="mi">380</span><span class="p">,</span>
                 <span class="mi">43</span><span class="p">,</span> <span class="mi">66</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span><span class="mi">455</span><span class="p">,</span><span class="mi">341</span><span class="p">,</span><span class="mi">445</span><span class="p">,</span><span class="mi">202</span><span class="p">,</span><span class="mi">432</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span><span class="mi">237</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span><span class="mi">376</span><span class="p">,</span><span class="mi">436</span><span class="p">,</span><span class="mi">464</span><span class="p">,</span> <span class="mi">59</span><span class="p">,</span><span class="mi">461</span><span class="p">};</span>

        <span class="cm">/* The sixteen bit input is split into two unequal halves,  *</span>
<span class="cm">         * nine bits and seven bits - as is the subkey                    */</span>

        <span class="n">nine</span>  <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">in</span><span class="o">&gt;&gt;</span><span class="mi">7</span><span class="p">);</span>
        <span class="n">seven</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">in</span><span class="o">&amp;</span><span class="mh">0x7F</span><span class="p">);</span>

        <span class="cm">/* Now run the various operations */</span>

        <span class="n">nine</span>  <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">S9</span><span class="p">[</span><span class="n">nine</span><span class="p">]</span>  <span class="o">^</span> <span class="n">seven</span><span class="p">);</span>
        <span class="n">seven</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">S7</span><span class="p">[</span><span class="n">seven</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">nine</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">));</span>

        <span class="n">seven</span> <span class="o">^=</span> <span class="p">(</span><span class="n">subkey</span><span class="o">&gt;&gt;</span><span class="mi">9</span><span class="p">);</span>
        <span class="n">nine</span>  <span class="o">^=</span> <span class="p">(</span><span class="n">subkey</span><span class="o">&amp;</span><span class="mh">0x1FF</span><span class="p">);</span>

        <span class="n">nine</span>  <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">S9</span><span class="p">[</span><span class="n">nine</span><span class="p">]</span>  <span class="o">^</span> <span class="n">seven</span><span class="p">);</span>
        <span class="n">seven</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">S7</span><span class="p">[</span><span class="n">seven</span><span class="p">]</span> <span class="o">^</span> <span class="p">(</span><span class="n">nine</span> <span class="o">&amp;</span> <span class="mh">0x7F</span><span class="p">));</span>

        <span class="n">in</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)((</span><span class="n">seven</span><span class="o">&lt;&lt;</span><span class="mi">9</span><span class="p">)</span> <span class="o">+</span> <span class="n">nine</span><span class="p">);</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">in</span> <span class="p">);</span>
<span class="p">}</span>


<span class="cm">/*---------------------------------------------------------------------</span>
<span class="cm"> * FO()</span>
<span class="cm"> *              The FO() function.</span>
<span class="cm"> *              Transforms a 32-bit value.  Uses &lt;index&gt; to identify the</span>
<span class="cm"> *              appropriate subkeys to use.</span>
<span class="cm"> *---------------------------------------------------------------------*/</span>
<span class="k">static</span> <span class="n">u32</span> <span class="nf">FO</span><span class="p">(</span> <span class="n">u32</span> <span class="n">in</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="n">u16</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">;</span>
        <span class="n">u16</span> <span class="n">l</span><span class="p">,</span><span class="n">r</span><span class="p">;</span>

        <span class="cm">/* Split the input into two 16-bit words */</span>

        <span class="n">left</span>  <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">in</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">);</span>
        <span class="n">right</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)</span> <span class="n">in</span><span class="p">;</span>

        <span class="n">l</span> <span class="o">=</span> <span class="n">left</span><span class="p">;</span>
        <span class="n">r</span> <span class="o">=</span> <span class="n">right</span><span class="p">;</span>

        <span class="cm">/* Now apply the same basic transformation three times         */</span>

        <span class="n">left</span> <span class="o">^=</span> <span class="n">KOi1</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

        <span class="n">left</span>  <span class="o">=</span> <span class="n">FI</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">KIi1</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">);</span>

        <span class="n">left</span> <span class="o">^=</span> <span class="n">right</span><span class="p">;</span>

        <span class="n">right</span> <span class="o">^=</span> <span class="n">KOi2</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

        <span class="n">right</span>  <span class="o">=</span> <span class="n">FI</span><span class="p">(</span> <span class="n">right</span><span class="p">,</span> <span class="n">KIi2</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">);</span>

        <span class="n">right</span> <span class="o">^=</span> <span class="n">left</span><span class="p">;</span>

        <span class="n">left</span> <span class="o">^=</span> <span class="n">KOi3</span><span class="p">[</span><span class="n">index</span><span class="p">];</span>

        <span class="n">left</span>  <span class="o">=</span> <span class="n">FI</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">KIi3</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="p">);</span>

        <span class="n">left</span> <span class="o">^=</span> <span class="n">right</span><span class="p">;</span>

        <span class="n">in</span> <span class="o">=</span> <span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">right</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span><span class="o">+</span><span class="n">left</span><span class="p">;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">in</span> <span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*---------------------------------------------------------------------</span>
<span class="cm"> * FL()</span>
<span class="cm"> *              The FL() function.</span>
<span class="cm"> *              Transforms a 32-bit value.  Uses &lt;index&gt; to identify the</span>
<span class="cm"> *              appropriate subkeys to use.</span>
<span class="cm"> *---------------------------------------------------------------------*/</span>
<span class="k">static</span> <span class="n">u32</span> <span class="nf">FL</span><span class="p">(</span> <span class="n">u32</span> <span class="n">in</span><span class="p">,</span> <span class="kt">int</span> <span class="n">index</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="n">u16</span> <span class="n">l</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">;</span>

        <span class="cm">/* split out the left and right halves */</span>

        <span class="n">l</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">in</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">);</span>
        <span class="n">r</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">in</span><span class="p">);</span>

        <span class="cm">/* do the FL() operations                       */</span>

        <span class="n">a</span>  <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)</span> <span class="p">(</span><span class="n">l</span> <span class="o">&amp;</span> <span class="n">KLi1</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>
        <span class="n">r</span> <span class="o">^=</span> <span class="n">ROL16</span><span class="p">(</span><span class="n">a</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

        <span class="n">b</span>  <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">r</span> <span class="o">|</span> <span class="n">KLi2</span><span class="p">[</span><span class="n">index</span><span class="p">]);</span>
        <span class="n">l</span> <span class="o">^=</span> <span class="n">ROL16</span><span class="p">(</span><span class="n">b</span><span class="p">,</span><span class="mi">1</span><span class="p">);</span>

        <span class="cm">/* put the two halves back together */</span>

        <span class="n">in</span> <span class="o">=</span> <span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">l</span><span class="p">)</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span> <span class="o">+</span> <span class="n">r</span><span class="p">;</span>

        <span class="k">return</span><span class="p">(</span> <span class="n">in</span> <span class="p">);</span>
<span class="p">}</span>


<span class="cm">/*---------------------------------------------------------------------</span>
<span class="cm"> * Kasumi()</span>
<span class="cm"> *              the Main algorithm (fig 1).  Apply the same pair of operations</span>
<span class="cm"> *              four times.  Transforms the 64-bit input.</span>
<span class="cm"> *---------------------------------------------------------------------*/</span>
<span class="kt">void</span> <span class="nf">Kasumi</span><span class="p">(</span> <span class="n">u8</span> <span class="o">*</span><span class="n">data</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="n">u32</span> <span class="n">left</span><span class="p">,</span> <span class="n">right</span><span class="p">,</span> <span class="n">temp</span><span class="p">;</span>
        <span class="n">DWORD</span> <span class="o">*</span><span class="n">d</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>

        <span class="cm">/* Start by getting the data into two 32-bit words (endian correct) */</span>

        <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">DWORD</span><span class="o">*</span><span class="p">)</span><span class="n">data</span><span class="p">;</span>

        <span class="n">left</span>  <span class="o">=</span> <span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">)</span><span class="o">+</span><span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span>
<span class="o">+</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
        <span class="n">right</span> <span class="o">=</span> <span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="mi">24</span><span class="p">)</span><span class="o">+</span><span class="p">(((</span><span class="n">u32</span><span class="p">)</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span><span class="o">&lt;&lt;</span><span class="mi">16</span><span class="p">)</span>
<span class="o">+</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span><span class="o">+</span><span class="p">(</span><span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
        <span class="k">do</span><span class="p">{</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">FL</span><span class="p">(</span> <span class="n">left</span><span class="p">,</span> <span class="n">n</span>   <span class="p">);</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">FO</span><span class="p">(</span> <span class="n">temp</span><span class="p">,</span>  <span class="n">n</span><span class="o">++</span> <span class="p">);</span>
                <span class="n">right</span> <span class="o">^=</span> <span class="n">temp</span><span class="p">;</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">FO</span><span class="p">(</span> <span class="n">right</span><span class="p">,</span> <span class="n">n</span>   <span class="p">);</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">FL</span><span class="p">(</span> <span class="n">temp</span><span class="p">,</span>   <span class="n">n</span><span class="o">++</span> <span class="p">);</span>
                <span class="n">left</span> <span class="o">^=</span> <span class="n">temp</span><span class="p">;</span>
        <span class="p">}</span><span class="k">while</span><span class="p">(</span> <span class="n">n</span><span class="o">&lt;=</span><span class="mi">7</span> <span class="p">);</span>

        <span class="cm">/* return the correct endian result */</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">left</span><span class="o">&gt;&gt;</span><span class="mi">24</span><span class="p">);</span>            <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">right</span><span class="o">&gt;&gt;</span><span class="mi">24</span><span class="p">);</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">left</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">);</span>            <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">right</span><span class="o">&gt;&gt;</span><span class="mi">16</span><span class="p">);</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">left</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">);</span>             <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">right</span><span class="o">&gt;&gt;</span><span class="mi">8</span><span class="p">);</span>
        <span class="n">d</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">left</span><span class="p">);</span>                <span class="n">d</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u8</span><span class="p">)(</span><span class="n">right</span><span class="p">);</span>
<span class="p">}</span>

<span class="cm">/*---------------------------------------------------------------------</span>
<span class="cm"> * KeySchedule()</span>
<span class="cm"> *              Build the key schedule.  Most &quot;key&quot; operations use 16-bit</span>
<span class="cm"> *              subkeys so we build u16-sized arrays that are &quot;endian&quot; correct.</span>
<span class="cm"> *---------------------------------------------------------------------*/</span>
<span class="kt">void</span> <span class="nf">KeySchedule</span><span class="p">(</span> <span class="n">u8</span> <span class="o">*</span><span class="n">k</span> <span class="p">)</span>
<span class="p">{</span>
        <span class="k">static</span> <span class="n">u16</span> <span class="n">C</span><span class="p">[]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="mh">0x0123</span><span class="p">,</span><span class="mh">0x4567</span><span class="p">,</span><span class="mh">0x89AB</span><span class="p">,</span><span class="mh">0xCDEF</span><span class="p">,</span> <span class="mh">0xFEDC</span><span class="p">,</span><span class="mh">0xBA98</span><span class="p">,</span><span class="mh">0x7654</span><span class="p">,</span><span class="mh">0x3210</span> <span class="p">};</span>
        <span class="n">u16</span> <span class="n">key</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">Kprime</span><span class="p">[</span><span class="mi">8</span><span class="p">];</span>
        <span class="n">WORD</span> <span class="o">*</span><span class="n">k16</span><span class="p">;</span>
        <span class="kt">int</span> <span class="n">n</span><span class="p">;</span>

        <span class="cm">/* Start by ensuring the subkeys are endian correct on a 16-bit basis */</span>

        <span class="n">k16</span> <span class="o">=</span> <span class="p">(</span><span class="n">WORD</span> <span class="o">*</span><span class="p">)</span><span class="n">k</span><span class="p">;</span>
        <span class="k">for</span><span class="p">(</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">n</span> <span class="p">)</span>
                <span class="n">key</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)((</span><span class="n">k16</span><span class="p">[</span><span class="n">n</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">&lt;&lt;</span><span class="mi">8</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span><span class="n">k16</span><span class="p">[</span><span class="n">n</span><span class="p">].</span><span class="n">b8</span><span class="p">[</span><span class="mi">1</span><span class="p">]));</span>

        <span class="cm">/* Now build the K&#39;[] keys */</span>

        <span class="k">for</span><span class="p">(</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">n</span> <span class="p">)</span>
                <span class="n">Kprime</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">u16</span><span class="p">)(</span><span class="n">key</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">^</span> <span class="n">C</span><span class="p">[</span><span class="n">n</span><span class="p">]);</span>

        <span class="cm">/* Finally construct the various sub keys */</span>

        <span class="k">for</span><span class="p">(</span> <span class="n">n</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">n</span><span class="o">&lt;</span><span class="mi">8</span><span class="p">;</span> <span class="o">++</span><span class="n">n</span> <span class="p">)</span>
        <span class="p">{</span>
                <span class="n">KLi1</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROL16</span><span class="p">(</span><span class="n">key</span><span class="p">[</span><span class="n">n</span><span class="p">],</span><span class="mi">1</span><span class="p">);</span>
                <span class="n">KLi2</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kprime</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">2</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">];</span>
                <span class="n">KOi1</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROL16</span><span class="p">(</span><span class="n">key</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">],</span><span class="mi">5</span><span class="p">);</span>
                <span class="n">KOi2</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROL16</span><span class="p">(</span><span class="n">key</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">5</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">],</span><span class="mi">8</span><span class="p">);</span>
                <span class="n">KOi3</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">ROL16</span><span class="p">(</span><span class="n">key</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">6</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">],</span><span class="mi">13</span><span class="p">);</span>
                <span class="n">KIi1</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kprime</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">4</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">];</span>
                <span class="n">KIi2</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kprime</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">3</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">];</span>
                <span class="n">KIi3</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">=</span> <span class="n">Kprime</span><span class="p">[(</span><span class="n">n</span><span class="o">+</span><span class="mi">7</span><span class="p">)</span><span class="o">&amp;</span><span class="mh">0x7</span><span class="p">];</span>
        <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In the main procedure, we defined an algorithm to obtain the Truth Table of FI function for the key values that are between &#8220;first&#8221; and &#8220;last&#8221; parameters.</p>
<div class="highlight-c"><div class="highlight"><pre><span></span><span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">u16</span> <span class="n">l</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
   <span class="kt">long</span> <span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">first</span><span class="p">,</span><span class="n">last</span><span class="p">;</span>
   <span class="n">std</span><span class="o">::</span><span class="n">stringstream</span> <span class="n">number</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">file</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">vec_GF2</span> <span class="n">vn</span><span class="p">,</span><span class="n">vs</span><span class="p">;</span>

   <span class="n">first</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">last</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>

   <span class="k">for</span> <span class="p">(</span><span class="n">i</span> <span class="o">=</span> <span class="n">first</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;=</span> <span class="n">last</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span>
   <span class="p">{</span>
     <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%ld.tt&quot;</span><span class="p">,</span><span class="n">i</span><span class="p">);</span>
     <span class="n">ofstream</span> <span class="n">output</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
     <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">output</span><span class="p">)</span>
     <span class="p">{</span>
        <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
        <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;[&quot;</span><span class="p">;</span>

     <span class="n">number</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">;</span>
     <span class="n">number</span> <span class="o">&gt;&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">hex</span> <span class="o">&gt;&gt;</span> <span class="n">k</span><span class="p">;</span>

     <span class="k">for</span> <span class="p">(</span><span class="n">j</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mi">65536</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">)</span>
     <span class="p">{</span>
        <span class="n">number</span> <span class="o">&lt;&lt;</span> <span class="n">j</span><span class="p">;</span>
        <span class="n">number</span> <span class="o">&gt;&gt;</span> <span class="n">std</span><span class="o">::</span><span class="n">hex</span> <span class="o">&gt;&gt;</span> <span class="n">l</span><span class="p">;</span>

        <span class="n">l</span>  <span class="o">=</span> <span class="n">FI</span><span class="p">(</span> <span class="n">l</span><span class="p">,</span> <span class="n">k</span> <span class="p">);</span>

        <span class="n">vn</span> <span class="o">=</span> <span class="n">to_vecGF2</span><span class="p">(</span><span class="n">l</span><span class="p">,</span><span class="mi">16</span><span class="p">);</span>

        <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="n">vn</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="n">output</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;]&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
     <span class="n">output</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
   <span class="p">}</span>

<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="representations.html" class="btn btn-neutral float-right" title="Representations and characterizations" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="intro.html" class="btn btn-neutral" title="Introduction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jose Antonio Alvarez Cubero.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.1',
            LANGUAGE:'None',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>