

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Optimization of Boolean functions via Genetic Algorithms &mdash; VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation" href="../index.html"/> 

  
  <script src="../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms
          

          
            
            <img src="../static/wrapping_paper-binary.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../preface.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using.html">3. Using the library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../representations.html">4. Representations and characterizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../criteria.html">5. Cryptographic Criteria</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations.html">6. Operations and constructions over Vector Boolean Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aes.html">7. Analysis of AES competition cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cryptec.html">8. Analysis of CRYPTEC project cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nessie.html">9. Analysis of NESSIE project cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">10. Analysis of other cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">11. Design of cryptographically robust Vector Boolean functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">12. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">13. Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Optimization of Boolean functions via Genetic Algorithms</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../sources/design_d/genetic.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="optimization-of-boolean-functions-via-genetic-algorithms">
<h1>Optimization of Boolean functions via Genetic Algorithms<a class="headerlink" href="#optimization-of-boolean-functions-via-genetic-algorithms" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<div class="section" id="galib">
<h3>Galib<a class="headerlink" href="#galib" title="Permalink to this headline">¶</a></h3>
<p>The Genetic Algorithm Library called GAlib was (straightforwardly) linked with our VBF library to perform a search of Boolean functions with good combined cryptographic criteria. In using the GAlib library we will work primarily with two classes: a genome and a genetic algorithm. Each genome instance represents a single solution to our optimization problem. The genetic algorithm object defines how the evolution should take place. The genetic algorithm uses an objective function to determine how ‘fit’ each genome is for survival. It uses the genome operators (built into the genome) and selection/replacement strategies (built into the genetic algorithm) to generate new individuals.</p>
<p>The following three items must be defined in order to solve an optimization problem using a genetic algorithm: A representation, the genetic operators and the objective function.</p>
<p>The <em>genetic algorithm</em> object determines which individuals should survive, which should reproduce, and which should die. It also records statistics and decides how long the evolution should continue. The algorithm updates the population of solutions over a number of iterations (or generations*). We have used the number of generations as a stopping measure. In each iteration a number of steps are involved:</p>
<ol class="arabic simple">
<li>Selection of parents from the current population of solutions.</li>
<li>Crossover of parents to produce offspring.</li>
<li>Mutation of the offspring.</li>
<li>Selection from the mutated offspring and the current population of solutions to determine the population of solutions for the next iteration.</li>
</ol>
<p>Among the many different types of genetic algorithms offered by GAlib we have chosen the standard ‘simple genetic algorithm’ described by Goldberg in his book <a class="reference internal" href="../bibliography.html#goldberg-1989" id="id1">[Goldberg:1989]</a>. This algorithm uses non-overlapping populations and optional elitism. Each generation the algorithm creates an entirely new population of individuals.</p>
</div>
<div class="section" id="representation">
<h3>Representation<a class="headerlink" href="#representation" title="Permalink to this headline">¶</a></h3>
<p>When you use a genetic algorithm to solve an optimization problem, you must be able to represent a single solution to your problem in a single <em>data structure</em>. The genetic algorithm will create a population of solutions based on a sample data structure that you provide. The genetic algorithm then operates on the population to evolve the best solution. In GAlib, the sample data structure is called a GAGenome (some people refer to it as a chromosome). We have used a type of genome called GA2DBinaryStringGenome. This class is derived from the base GAGenome class and a data structure class which consists of a 2-dimensional array of Boolean with <img class="math" src="../images/math/836454ccac1cb1f57b1820a677f32adb63e52a57.png" alt="2^n"/> elements (the binary string is the Truth Table of the Boolean function).</p>
</div>
<div class="section" id="genetic-operators">
<h3>Genetic operators<a class="headerlink" href="#genetic-operators" title="Permalink to this headline">¶</a></h3>
<p>Each genome has three primary <em>operators</em>: initialization, mutation, and crossover. With these operators you can bias an initial population, define a mutation or crossover specific to our representation, or evolve parts of the genetic algorithm as our population evolves.</p>
<p>The <em>initialization operator</em> determines how the genome is initialized. It is called when you initialize a population or the genetic algorithm. This operator does not actually create new genomes, rather it ‘stuffs’ the genomes with the primordial genetic material from which all solutions will evolve. We have used a uniform random initialization operator.</p>
<p>The <em>mutation operator</em> defines the procedure for mutating each genome. The mutation operation introduces randomness to the population of solutions. Mutation is generally applied to the children which result from the breeding process. We have used the typical mutator for a binary string genome which flips the bits in the string with a given probability (uniform random bit flip).</p>
<p>The <em>crossover operator</em> defines the procedure for generating a child from two parent genomes in order to obtain offspring. The crossover operation involves selecting two “parents” from the current population of solutions, picking a random point in the binary string representing each of the parents and swapping the values beyond that point between the two parents. This process results in two “children” with some characteristics of each of the parents.</p>
</div>
<div class="section" id="weighted-objective-functions">
<h3>Weighted Objective Functions<a class="headerlink" href="#weighted-objective-functions" title="Permalink to this headline">¶</a></h3>
<p>In addition to the three primary operators, each genome must also contain an <em>Objective Function</em>. The Objective Function is used to evaluate the
genome in order to know how good it is compared to the other genomes. Several objective functions were employed gradually involving more criteria in a weighted manner:</p>
<p>1. Nonlinearity of the Boolean function: <img class="math" src="../images/math/ee93a4aa0d857058ed88625aeb1b3cde5b3f6e43.png" alt="\crit{NL}(f)"/>. This cryptographic criterion is represented by a locally smooth fitness
function:</p>
<div class="math">
<p><img src="../images/math/b6af269a0b7f7ccccc9ab6a30153af56740982b9.png" alt="o_1 = \crit{NL}(f)"/></p>
</div><ol class="arabic simple" start="2">
<li>The sum of the nonlinearity and linearity distance of the Boolean function, normalized with respect to their (a priori known) maximum values:</li>
</ol>
<div class="math">
<p><img src="../images/math/42cd4e84e9969676bf5b91e11c58f81bf837fcbf.png" alt="o_2 = \frac{\crit{NL}(f)}{maxNL} + \frac{\crit{LD}(f)}{maxLD}"/></p>
</div><p>where <em>maxNL</em> and <em>maxLD</em> are the maximum values of nonlinearity and linearity distance which can be achieved by a Boolean function with the same number of input variables as <em>f</em> respectively.</p>
<ol class="arabic simple" start="3">
<li>The sum of nonlinearity, algebraic degree and linearity distance of the Boolean function normalized with respect to their (a priori known) maximum values:</li>
</ol>
<div class="math">
<p><img src="../images/math/1cdfad4716e79e94849b3d6aa1d6f063e5a041a1.png" alt="o_3 =  \frac{\crit{NL}(f)}{maxNL} + \frac{\crit{deg}(f)}{maxDEG} + \frac{\crit{LD}(f)}{maxLD}"/></p>
</div><p>where <em>maxNL</em>, <em>maxDEG</em> and <em>maxLD</em> are respectively the maximum values of nonlinearity, algebraic degree and linearity distance which can be achieved by a Boolean function with the same number of input variables as <em>f</em>.</p>
<ol class="arabic simple" start="4">
<li>The sum of nonlinearity, algebraic degree, algebraic immunity and linearity distance of the Boolean function normalized with respect to their (a priori known) maximum values:</li>
</ol>
<div class="math">
<p><img src="../images/math/882cf81a2372044ed216642f820a63ac30c77eb9.png" alt="o_4 = \frac{\crit{NL}(f)}{maxNL} + \frac{\crit{deg}(f)}{maxDEG} + \frac{\crit{AI}(f)}{maxAI} + \frac{\crit{LD}(f)}{maxLD}"/></p>
</div><p>where <em>maxNL</em>, <em>maxDEG</em>, <em>maxAI</em> and <em>maxLD</em> are respectively the maximum values of nonlinearity, algebraic degree, algebraic immunity and linearity distance which can be achieved by a Boolean function with the same number of input variables as <em>f</em>.</p>
<ol class="arabic simple" start="5">
<li>The sum of nonlinearity, algebraic degree, algebraic immunity and linearity distance of the Boolean function normalized with respect to their (a priori known) maximum values:</li>
</ol>
<div class="math">
<p><img src="../images/math/ce8eb4421c86dbe20d666535e4cc6da4906c3f50.png" alt="o_5 = \frac{\crit{NL}(f)}{maxNL} + \frac{\crit{deg}(f)}{maxDEG} + \frac{\crit{AI}(f)}{maxAI} + \frac{\crit{LD}(f)}{maxLD} + \frac{2^{3n}-\sigma(f)}{max\sigma-min\sigma}"/></p>
</div><p>where <em>maxNL</em>, <em>maxDEG</em>, <em>maxAI</em>, <em>maxLD</em>, <img class="math" src="../images/math/67ff6d4c31bc4b03f3a95fa316381e48f909eaaf.png" alt="max\sigma"/> are respectively the maximum values of nonlinearity, algebraic degree, algebraic immunity, linearity distance and sum-of-square indicator which can be achieved by a Boolean function with the same number of input variables as $f$; and <img class="math" src="../images/math/61ab85ce1b1b4f87ab6182b62453c935affddabe.png" alt="min\sigma"/> is the minimum value of the sum-of-square indicator achievable by a Boolean function with the same number of input variables as <em>f</em>.</p>
</div>
</div>
<div class="section" id="implementation">
<h2>Implementation<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h2>
<p>In order to use Galib library, the installation instructions described in <a class="reference external" href="http://lancet.mit.edu/galib-2.4/Installation.html">Installation Instructions for GAlib</a> must be followed. Once Galib is installed, we can use this library in conjunction with VBF library by using the following Makefile:</p>
<div class="highlight-c"><div class="highlight"><pre>include makevars

############# User settings ######################

# set your C++ compiler and options here...
GPP=g++
LIBS=-lntl
NTLINC= -I/usr/local/include -L/usr/local/lib
GA_LIB_DIR= ga
LIB_DIRS= -L$(GA_LIB_DIR)

############# End of user settings ###############

o1: o1.cpp VBF.h
        $(GPP) $(NTLINC) -Wall o1.cpp -o o1.exe $(LIBS) $(LIB_DIRS) -lga

o2: o2.cpp VBF.h
        $(GPP) $(NTLINC) -Wall o2.cpp -o o2.exe $(LIBS) $(LIB_DIRS)  -lga

o3: o3.cpp VBF.h
        $(GPP) $(NTLINC) -Wall o3.cpp -o o3.exe $(LIBS) $(LIB_DIRS) -lga

o4: o4.cpp VBF.h
        $(GPP) $(NTLINC) -Wall o4.cpp -o o4.exe $(LIBS) $(LIB_DIRS) -lga

o5: o5.cpp VBF.h
        $(GPP) $(NTLINC) -Wall o5.cpp -o o5.exe $(LIBS) $(LIB_DIRS) -lga

clean:
        rm -f *.exe
</pre></div>
</div>
<p>Note that a file called “makevars” must be present in the same directory as the Makefile file.</p>
<p>Example program for each of the objective functions could be the following:</p>
<div class="literal-block-wrapper container" id="o1-cpp">
<div class="code-block-caption"><span class="caption-text">o1.cpp</span><a class="headerlink" href="#o1-cpp" title="Permalink to this code">¶</a></div>
<div class="highlight-c"><div class="highlight"><pre>     <span class="cp">#include &lt;ga/GASimpleGA.h&gt;      </span><span class="c1">// we&#39;re going to use the simple GA</span>
     <span class="cp">#include &lt;ga/GA2DBinStrGenome.h&gt; </span><span class="c1">// and the 2D binary string genome</span>
     <span class="cp">#include &lt;ga/std_stream.h&gt;</span>
     <span class="cp">#include &quot;VBF.h&quot;</span>

     <span class="cp">#define cout STD_COUT</span>

     <span class="kt">float</span> <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span> <span class="o">&amp;</span><span class="p">);</span>    <span class="c1">// This is the declaration of our obj function.</span>

     <span class="kt">int</span>
     <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
     <span class="p">{</span>
       <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">popsize</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ngen</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pmut</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pcross</span><span class="p">;</span>

   <span class="c1">// We generate random seed</span>

       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">argc</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="o">++</span><span class="p">],</span><span class="s">&quot;seed&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="n">GARandomSeed</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="p">]));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
       <span class="kt">int</span> <span class="n">width</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">height</span>   <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
       <span class="n">popsize</span>  <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
       <span class="n">ngen</span>     <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
       <span class="n">pmut</span>   <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
       <span class="n">pcross</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="n">genome</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">Objective</span><span class="p">);</span>

       <span class="n">GASimpleGA</span> <span class="n">ga</span><span class="p">(</span><span class="n">genome</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">populationSize</span><span class="p">(</span><span class="n">popsize</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">nGenerations</span><span class="p">(</span><span class="n">ngen</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pMutation</span><span class="p">(</span><span class="n">pmut</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pCrossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">evolve</span><span class="p">();</span>

     <span class="c1">// Now we print out the best genome that the GA found.</span>

       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">().</span><span class="n">bestIndividual</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="kt">float</span>
     <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>

       <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

       <span class="n">VBF</span> <span class="n">F</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span> <span class="n">nonlin</span><span class="p">;</span>
       <span class="kt">long</span> <span class="n">spacen</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span> <span class="n">genome</span> <span class="o">=</span> <span class="p">(</span><span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">g</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

       <span class="n">spacen</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">width</span><span class="p">();</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>

       <span class="n">T</span><span class="p">.</span><span class="n">SetDims</span><span class="p">(</span><span class="n">spacen</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">spacen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
         <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_GF2</span><span class="p">(</span><span class="n">genome</span><span class="p">.</span><span class="n">gene</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
       <span class="n">nonlin</span> <span class="o">=</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">conv</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">nonlin</span><span class="p">);</span>

       <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
     <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="o2-cpp">
<div class="code-block-caption"><span class="caption-text">o2.cpp</span><a class="headerlink" href="#o2-cpp" title="Permalink to this code">¶</a></div>
<div class="highlight-c"><div class="highlight"><pre>     <span class="cp">#include &lt;ga/GASimpleGA.h&gt;      </span><span class="c1">// we&#39;re going to use the simple GA</span>
     <span class="cp">#include &lt;ga/GA2DBinStrGenome.h&gt; </span><span class="c1">// and the 2D binary string genome</span>
     <span class="cp">#include &lt;ga/std_stream.h&gt;</span>
     <span class="cp">#include &quot;VBF.h&quot;</span>

     <span class="cp">#define cout STD_COUT</span>

     <span class="kt">float</span> <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span> <span class="o">&amp;</span><span class="p">);</span>    <span class="c1">// This is the declaration of our obj function.</span>

     <span class="kt">int</span>
     <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
     <span class="p">{</span>
       <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">popsize</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ngen</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pmut</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pcross</span><span class="p">;</span>

   <span class="c1">// We generate random seed</span>

       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">argc</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="o">++</span><span class="p">],</span><span class="s">&quot;seed&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="n">GARandomSeed</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="p">]));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
       <span class="kt">int</span> <span class="n">width</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">height</span>   <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
       <span class="n">popsize</span>  <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
       <span class="n">ngen</span>     <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
       <span class="n">pmut</span>   <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
       <span class="n">pcross</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="n">genome</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">Objective</span><span class="p">);</span>

       <span class="n">GASimpleGA</span> <span class="n">ga</span><span class="p">(</span><span class="n">genome</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">populationSize</span><span class="p">(</span><span class="n">popsize</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">nGenerations</span><span class="p">(</span><span class="n">ngen</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pMutation</span><span class="p">(</span><span class="n">pmut</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pCrossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">evolve</span><span class="p">();</span>

     <span class="c1">// Now we print out the best genome that the GA found.</span>

       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">().</span><span class="n">bestIndividual</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="kt">float</span>
     <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>

       <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

       <span class="n">VBF</span> <span class="n">F</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span> <span class="n">nonlin</span><span class="p">,</span> <span class="n">lind</span><span class="p">,</span> <span class="n">suma</span><span class="p">,</span> <span class="n">nlm</span><span class="p">,</span> <span class="n">ldm</span><span class="p">;</span>
       <span class="kt">long</span> <span class="n">spacen</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span> <span class="n">genome</span> <span class="o">=</span> <span class="p">(</span><span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">g</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

       <span class="n">spacen</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">width</span><span class="p">();</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>

       <span class="n">T</span><span class="p">.</span><span class="n">SetDims</span><span class="p">(</span><span class="n">spacen</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">spacen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
         <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_GF2</span><span class="p">(</span><span class="n">genome</span><span class="p">.</span><span class="n">gene</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
       <span class="n">nonlin</span> <span class="o">=</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">lind</span> <span class="o">=</span> <span class="n">ld</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">nlm</span> <span class="o">=</span> <span class="n">nlmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">ldm</span> <span class="o">=</span> <span class="n">ldmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

       <span class="n">suma</span> <span class="o">=</span> <span class="n">nonlin</span><span class="o">/</span><span class="n">nlm</span><span class="o">+</span><span class="n">lind</span><span class="o">/</span><span class="n">ldm</span><span class="p">;</span>
       <span class="n">conv</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">suma</span><span class="p">);</span>

       <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
     <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="o3-cpp">
<div class="code-block-caption"><span class="caption-text">o3.cpp</span><a class="headerlink" href="#o3-cpp" title="Permalink to this code">¶</a></div>
<div class="highlight-c"><div class="highlight"><pre>     <span class="cp">#include &lt;ga/GASimpleGA.h&gt;      </span><span class="c1">// we&#39;re going to use the simple GA</span>
     <span class="cp">#include &lt;ga/GA2DBinStrGenome.h&gt; </span><span class="c1">// and the 2D binary string genome</span>
     <span class="cp">#include &lt;ga/std_stream.h&gt;</span>
     <span class="cp">#include &quot;VBF.h&quot;</span>

     <span class="cp">#define cout STD_COUT</span>

     <span class="kt">float</span> <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span> <span class="o">&amp;</span><span class="p">);</span>    <span class="c1">// This is the declaration of our obj function.</span>

     <span class="kt">int</span>
     <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
     <span class="p">{</span>
       <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">popsize</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ngen</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pmut</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pcross</span><span class="p">;</span>

   <span class="c1">// We generate random seed</span>

       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">argc</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="o">++</span><span class="p">],</span><span class="s">&quot;seed&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="n">GARandomSeed</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="p">]));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
       <span class="kt">int</span> <span class="n">width</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">height</span>   <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
       <span class="n">popsize</span>  <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
       <span class="n">ngen</span>     <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
       <span class="n">pmut</span>   <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
       <span class="n">pcross</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="n">genome</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">Objective</span><span class="p">);</span>

       <span class="n">GASimpleGA</span> <span class="n">ga</span><span class="p">(</span><span class="n">genome</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">populationSize</span><span class="p">(</span><span class="n">popsize</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">nGenerations</span><span class="p">(</span><span class="n">ngen</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pMutation</span><span class="p">(</span><span class="n">pmut</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pCrossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">evolve</span><span class="p">();</span>

     <span class="c1">// Now we print out the best genome that the GA found.</span>

       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">().</span><span class="n">bestIndividual</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="kt">float</span>
     <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>

       <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

       <span class="n">VBF</span> <span class="n">F</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span> <span class="n">nonlin</span><span class="p">,</span> <span class="n">lind</span><span class="p">,</span> <span class="n">suma</span><span class="p">,</span> <span class="n">nlm</span><span class="p">,</span> <span class="n">ldm</span><span class="p">;</span>
       <span class="kt">long</span> <span class="n">spacen</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">;</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span> <span class="n">genome</span> <span class="o">=</span> <span class="p">(</span><span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">g</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

       <span class="n">spacen</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">width</span><span class="p">();</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>

       <span class="n">T</span><span class="p">.</span><span class="n">SetDims</span><span class="p">(</span><span class="n">spacen</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">spacen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
         <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_GF2</span><span class="p">(</span><span class="n">genome</span><span class="p">.</span><span class="n">gene</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
       <span class="n">nonlin</span> <span class="o">=</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">lind</span> <span class="o">=</span> <span class="n">ld</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">nlm</span> <span class="o">=</span> <span class="n">nlmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">ldm</span> <span class="o">=</span> <span class="n">ldmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">d</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">n</span> <span class="o">=</span> <span class="n">logtwo</span><span class="p">(</span><span class="n">spacen</span><span class="p">);</span>

       <span class="n">suma</span> <span class="o">=</span> <span class="n">nonlin</span><span class="o">/</span><span class="n">nlm</span><span class="o">+</span><span class="n">lind</span><span class="o">/</span><span class="n">ldm</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
       <span class="n">conv</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">suma</span><span class="p">);</span>

       <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
     <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="o4-cpp">
<div class="code-block-caption"><span class="caption-text">o4.cpp</span><a class="headerlink" href="#o4-cpp" title="Permalink to this code">¶</a></div>
<div class="highlight-c"><div class="highlight"><pre>     <span class="cp">#include &lt;ga/GASimpleGA.h&gt;      </span><span class="c1">// we&#39;re going to use the simple GA</span>
     <span class="cp">#include &lt;ga/GA2DBinStrGenome.h&gt; </span><span class="c1">// and the 2D binary string genome</span>
     <span class="cp">#include &lt;ga/std_stream.h&gt;</span>
     <span class="cp">#include &quot;VBF.h&quot;</span>

     <span class="cp">#define cout STD_COUT</span>

     <span class="kt">float</span> <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span> <span class="o">&amp;</span><span class="p">);</span>    <span class="c1">// This is the declaration of our obj function.</span>

     <span class="kt">int</span>
     <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
     <span class="p">{</span>
       <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">popsize</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ngen</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pmut</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pcross</span><span class="p">;</span>

   <span class="c1">// We generate random seed</span>

       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">argc</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="o">++</span><span class="p">],</span><span class="s">&quot;seed&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="n">GARandomSeed</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="p">]));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
       <span class="kt">int</span> <span class="n">width</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">height</span>   <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
       <span class="n">popsize</span>  <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
       <span class="n">ngen</span>     <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
       <span class="n">pmut</span>   <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
       <span class="n">pcross</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="n">genome</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">Objective</span><span class="p">);</span>

       <span class="n">GASimpleGA</span> <span class="n">ga</span><span class="p">(</span><span class="n">genome</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">populationSize</span><span class="p">(</span><span class="n">popsize</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">nGenerations</span><span class="p">(</span><span class="n">ngen</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pMutation</span><span class="p">(</span><span class="n">pmut</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pCrossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">evolve</span><span class="p">();</span>

     <span class="c1">// Now we print out the best genome that the GA found.</span>

       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">().</span><span class="n">bestIndividual</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="kt">float</span>
     <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>

       <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

       <span class="n">VBF</span> <span class="n">F</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span> <span class="n">nonlin</span><span class="p">,</span> <span class="n">lind</span><span class="p">,</span> <span class="n">suma</span><span class="p">,</span> <span class="n">nlm</span><span class="p">,</span> <span class="n">ldm</span><span class="p">;</span>
       <span class="kt">long</span> <span class="n">spacen</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span> <span class="n">maxai</span><span class="p">;</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span> <span class="n">genome</span> <span class="o">=</span> <span class="p">(</span><span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">g</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

       <span class="n">spacen</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">width</span><span class="p">();</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>

       <span class="n">T</span><span class="p">.</span><span class="n">SetDims</span><span class="p">(</span><span class="n">spacen</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">spacen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
         <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_GF2</span><span class="p">(</span><span class="n">genome</span><span class="p">.</span><span class="n">gene</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
       <span class="n">nonlin</span> <span class="o">=</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">lind</span> <span class="o">=</span> <span class="n">ld</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">nlm</span> <span class="o">=</span> <span class="n">nlmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">ldm</span> <span class="o">=</span> <span class="n">ldmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">d</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">n</span> <span class="o">=</span> <span class="n">logtwo</span><span class="p">(</span><span class="n">spacen</span><span class="p">);</span>
       <span class="n">ai</span> <span class="o">=</span> <span class="n">AI</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">maxai</span> <span class="o">=</span> <span class="n">aimax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

       <span class="n">suma</span> <span class="o">=</span> <span class="n">nonlin</span><span class="o">/</span><span class="n">nlm</span><span class="o">+</span><span class="n">lind</span><span class="o">/</span><span class="n">ldm</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">maxai</span><span class="p">);</span>
       <span class="n">conv</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">suma</span><span class="p">);</span>

       <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
     <span class="p">}</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper container" id="o5-cpp">
<div class="code-block-caption"><span class="caption-text">o5.cpp</span><a class="headerlink" href="#o5-cpp" title="Permalink to this code">¶</a></div>
<div class="highlight-c"><div class="highlight"><pre>     <span class="cp">#include &lt;ga/GASimpleGA.h&gt;      </span><span class="c1">// we&#39;re going to use the simple GA</span>
     <span class="cp">#include &lt;ga/GA2DBinStrGenome.h&gt; </span><span class="c1">// and the 2D binary string genome</span>
     <span class="cp">#include &lt;ga/std_stream.h&gt;</span>
     <span class="cp">#include &quot;VBF.h&quot;</span>

     <span class="cp">#define cout STD_COUT</span>

     <span class="kt">float</span> <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span> <span class="o">&amp;</span><span class="p">);</span>    <span class="c1">// This is the declaration of our obj function.</span>

     <span class="kt">int</span>
     <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
     <span class="p">{</span>
       <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">popsize</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">ngen</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pmut</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">pcross</span><span class="p">;</span>

   <span class="c1">// We generate random seed</span>

       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">ii</span><span class="o">=</span><span class="mi">1</span><span class="p">;</span> <span class="n">ii</span><span class="o">&lt;</span><span class="n">argc</span><span class="p">;</span> <span class="n">ii</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
         <span class="k">if</span><span class="p">(</span><span class="n">strcmp</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="o">++</span><span class="p">],</span><span class="s">&quot;seed&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
           <span class="n">GARandomSeed</span><span class="p">((</span><span class="kt">unsigned</span> <span class="kt">int</span><span class="p">)</span><span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="n">ii</span><span class="p">]));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
       <span class="kt">int</span> <span class="n">width</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">height</span>   <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
       <span class="n">popsize</span>  <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
       <span class="n">ngen</span>     <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
       <span class="n">pmut</span>   <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
       <span class="n">pcross</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="n">genome</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">Objective</span><span class="p">);</span>

       <span class="n">GASimpleGA</span> <span class="n">ga</span><span class="p">(</span><span class="n">genome</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">populationSize</span><span class="p">(</span><span class="n">popsize</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">nGenerations</span><span class="p">(</span><span class="n">ngen</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pMutation</span><span class="p">(</span><span class="n">pmut</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">pCrossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">);</span>
       <span class="n">ga</span><span class="p">.</span><span class="n">evolve</span><span class="p">();</span>

     <span class="c1">// Now we print out the best genome that the GA found.</span>

       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
       <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">().</span><span class="n">bestIndividual</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

       <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
     <span class="p">}</span>

     <span class="kt">float</span>
     <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>

       <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

       <span class="n">VBF</span> <span class="n">F</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span> <span class="n">nonlin</span><span class="p">,</span> <span class="n">lind</span><span class="p">,</span> <span class="n">suma</span><span class="p">,</span> <span class="n">nlm</span><span class="p">,</span> <span class="n">ldm</span><span class="p">;</span>
       <span class="n">NTL</span><span class="o">::</span><span class="n">ZZ</span> <span class="n">s</span><span class="p">,</span> <span class="n">smin</span><span class="p">,</span> <span class="n">smax</span><span class="p">;</span>
       <span class="kt">long</span> <span class="n">spacen</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
       <span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span> <span class="n">maxai</span><span class="p">;</span>

       <span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span> <span class="n">genome</span> <span class="o">=</span> <span class="p">(</span><span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">g</span><span class="p">;</span>
       <span class="kt">float</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

       <span class="n">spacen</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">width</span><span class="p">();</span>
       <span class="n">m</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>

       <span class="n">T</span><span class="p">.</span><span class="n">SetDims</span><span class="p">(</span><span class="n">spacen</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
       <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">spacen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
         <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
           <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_GF2</span><span class="p">(</span><span class="n">genome</span><span class="p">.</span><span class="n">gene</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span>
         <span class="p">}</span>
       <span class="p">}</span>

       <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
       <span class="n">nonlin</span> <span class="o">=</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">lind</span> <span class="o">=</span> <span class="n">ld</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">nlm</span> <span class="o">=</span> <span class="n">nlmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">ldm</span> <span class="o">=</span> <span class="n">ldmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">d</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">n</span> <span class="o">=</span> <span class="n">logtwo</span><span class="p">(</span><span class="n">spacen</span><span class="p">);</span>
       <span class="n">ai</span> <span class="o">=</span> <span class="n">AI</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">maxai</span> <span class="o">=</span> <span class="n">aimax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">s</span> <span class="o">=</span> <span class="n">sigma</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">smin</span> <span class="o">=</span> <span class="n">sigmamin</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
       <span class="n">smax</span> <span class="o">=</span> <span class="n">sigmamax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

       <span class="n">suma</span> <span class="o">=</span> <span class="n">nonlin</span><span class="o">/</span><span class="n">nlm</span><span class="o">+</span><span class="n">lind</span><span class="o">/</span><span class="n">ldm</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">maxai</span><span class="p">)</span><span class="o">+</span><span class="mf">1.0</span><span class="o">-</span><span class="p">(</span><span class="n">to_RR</span><span class="p">(</span><span class="n">s</span><span class="o">-</span><span class="n">smin</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">smax</span><span class="o">-</span><span class="n">smin</span><span class="p">));</span>
       <span class="n">conv</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">suma</span><span class="p">);</span>

       <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
     <span class="p">}</span>
</pre></div>
</div>
</div>
<p>The following program illustrates how can be set the seed (included in a file called “seed.bin” with the binary representation of the Truth Table of the function) of the Genetic algorithm for the o4 objective function:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;ga/GASimpleGA.h&gt;      </span><span class="c1">// we&#39;re going to use the simple GA</span>
<span class="cp">#include &lt;ga/GA2DBinStrGenome.h&gt; </span><span class="c1">// and the 2D binary string genome</span>
<span class="cp">#include &lt;ga/std_stream.h&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="cp">#define cout STD_COUT</span>

<span class="kt">float</span> <span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span> <span class="o">&amp;</span><span class="p">);</span>    <span class="c1">// This is the declaration of our obj function.</span>

<span class="kt">int</span>
<span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">)</span>
<span class="p">{</span>
  <span class="kt">int</span> <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">popsize</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">ngen</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">pmut</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">pcross</span><span class="p">;</span>

  <span class="n">n</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
  <span class="kt">int</span> <span class="n">width</span>    <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">height</span>   <span class="o">=</span> <span class="n">m</span><span class="p">;</span>
  <span class="n">popsize</span>  <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">]);</span>
  <span class="n">ngen</span>     <span class="o">=</span> <span class="n">atoi</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">4</span><span class="p">]);</span>
  <span class="n">pmut</span>   <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">5</span><span class="p">]);</span>
  <span class="n">pcross</span> <span class="o">=</span> <span class="n">atof</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">6</span><span class="p">]);</span>

  <span class="n">GA2DBinaryStringGenome</span> <span class="n">genome</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">,</span> <span class="n">Objective</span><span class="p">);</span>

  <span class="n">ifstream</span> <span class="n">inStream</span><span class="p">(</span><span class="s">&quot;seed.bin&quot;</span><span class="p">);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">inStream</span><span class="p">){</span>
    <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Cannot open &quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;seed.bin&quot;</span> <span class="o">&lt;&lt;</span> <span class="s">&quot; for input.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
    <span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
  <span class="p">}</span>
  <span class="n">inStream</span> <span class="o">&gt;&gt;</span> <span class="n">genome</span><span class="p">;</span>
  <span class="n">inStream</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

  <span class="n">GASimpleGA</span> <span class="n">ga</span><span class="p">(</span><span class="n">genome</span><span class="p">);</span>
  <span class="n">ga</span><span class="p">.</span><span class="n">populationSize</span><span class="p">(</span><span class="n">popsize</span><span class="p">);</span>
  <span class="n">ga</span><span class="p">.</span><span class="n">nGenerations</span><span class="p">(</span><span class="n">ngen</span><span class="p">);</span>
  <span class="n">ga</span><span class="p">.</span><span class="n">pMutation</span><span class="p">(</span><span class="n">pmut</span><span class="p">);</span>
  <span class="n">ga</span><span class="p">.</span><span class="n">pCrossover</span><span class="p">(</span><span class="n">pcross</span><span class="p">);</span>
  <span class="n">ga</span><span class="p">.</span><span class="n">evolve</span><span class="p">();</span>

<span class="c1">// Now we print out the best genome that the GA found.</span>

  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ga</span><span class="p">.</span><span class="n">statistics</span><span class="p">().</span><span class="n">bestIndividual</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>

<span class="kt">float</span>
<span class="nf">Objective</span><span class="p">(</span><span class="n">GAGenome</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span> <span class="p">{</span>

  <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

  <span class="n">VBF</span> <span class="n">F</span><span class="p">;</span>
  <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
  <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span> <span class="n">nonlin</span><span class="p">,</span> <span class="n">lind</span><span class="p">,</span> <span class="n">suma</span><span class="p">,</span> <span class="n">nlm</span><span class="p">,</span> <span class="n">ldm</span><span class="p">;</span>
  <span class="kt">long</span> <span class="n">spacen</span><span class="p">,</span> <span class="n">m</span><span class="p">;</span>
  <span class="kt">int</span> <span class="n">d</span><span class="p">,</span> <span class="n">n</span><span class="p">,</span> <span class="n">ai</span><span class="p">,</span> <span class="n">maxai</span><span class="p">;</span>

  <span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span> <span class="n">genome</span> <span class="o">=</span> <span class="p">(</span><span class="n">GA2DBinaryStringGenome</span> <span class="o">&amp;</span><span class="p">)</span><span class="n">g</span><span class="p">;</span>
  <span class="kt">float</span> <span class="n">score</span><span class="o">=</span><span class="mf">0.0</span><span class="p">;</span>

  <span class="n">spacen</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">width</span><span class="p">();</span>
  <span class="n">m</span> <span class="o">=</span> <span class="n">genome</span><span class="p">.</span><span class="n">height</span><span class="p">();</span>

  <span class="n">T</span><span class="p">.</span><span class="n">SetDims</span><span class="p">(</span><span class="n">spacen</span><span class="p">,</span><span class="n">m</span><span class="p">);</span>
  <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">i</span><span class="o">&lt;</span><span class="n">spacen</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">){</span>
    <span class="k">for</span><span class="p">(</span><span class="kt">int</span> <span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span> <span class="n">j</span><span class="o">&lt;</span><span class="n">m</span><span class="p">;</span> <span class="n">j</span><span class="o">++</span><span class="p">){</span>
      <span class="n">T</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="n">to_GF2</span><span class="p">(</span><span class="n">genome</span><span class="p">.</span><span class="n">gene</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">));</span>
    <span class="p">}</span>
  <span class="p">}</span>

  <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
  <span class="n">nonlin</span> <span class="o">=</span> <span class="n">nl</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">lind</span> <span class="o">=</span> <span class="n">ld</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">nlm</span> <span class="o">=</span> <span class="n">nlmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">ldm</span> <span class="o">=</span> <span class="n">ldmax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">d</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">n</span> <span class="o">=</span> <span class="n">logtwo</span><span class="p">(</span><span class="n">spacen</span><span class="p">);</span>
  <span class="n">ai</span> <span class="o">=</span> <span class="n">AI</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">maxai</span> <span class="o">=</span> <span class="n">aimax</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>

  <span class="n">suma</span> <span class="o">=</span> <span class="n">nonlin</span><span class="o">/</span><span class="n">nlm</span><span class="o">+</span><span class="n">lind</span><span class="o">/</span><span class="n">ldm</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">d</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">+</span><span class="n">to_RR</span><span class="p">(</span><span class="n">ai</span><span class="p">)</span><span class="o">/</span><span class="n">to_RR</span><span class="p">(</span><span class="n">maxai</span><span class="p">);</span>
  <span class="n">conv</span><span class="p">(</span><span class="n">score</span><span class="p">,</span><span class="n">suma</span><span class="p">);</span>

  <span class="k">return</span> <span class="n">score</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jose Antonio Alvarez Cubero.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../static/jquery.js"></script>
      <script type="text/javascript" src="../static/underscore.js"></script>
      <script type="text/javascript" src="../static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>