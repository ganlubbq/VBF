

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Representations and characterizations &mdash; VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="static/css/theme.css" type="text/css" />
  

  
    <link rel="top" title="VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation" href="index.html"/>
        <link rel="next" title="Cryptographic Criteria" href="criteria.html"/>
        <link rel="prev" title="Using the library" href="using.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="preface.html">Preface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="preface.html#authors">Authors</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#dedications">Dedications</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#acknowledgements">Acknowledgements</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#book-writing-methodology">Book Writing Methodology</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#who-should-read-this-book">Who Should Read This Book?</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#book-objectives">Book Objectives</a></li>
<li class="toctree-l2"><a class="reference internal" href="preface.html#organization-of-this-book">Organization of this Book</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#functions-available-in-vbf">Functions available in VBF</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#conventions-used-in-this-manual">Conventions used in this manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#software-implementation">Software implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#system-requirements">System requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#preliminaries">Preliminaries</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#design-philosophy">Design Philosophy</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="using.html">Using the library</a><ul>
<li class="toctree-l2"><a class="reference internal" href="using.html#an-example-program">An Example Program</a></li>
<li class="toctree-l2"><a class="reference internal" href="using.html#compiling">Compiling</a></li>
<li class="toctree-l2"><a class="reference internal" href="using.html#how-to-evaluate-new-algorithms">How to evaluate new algorithms</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">Representations and characterizations</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#truth-table">Truth Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#trace-representation">Trace representation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#polynomials-in-anf">Polynomials in ANF</a></li>
<li class="toctree-l2"><a class="reference internal" href="#anf-table">ANF table</a></li>
<li class="toctree-l2"><a class="reference internal" href="#characteristic-function">Characteristic Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#walsh-spectrum">Walsh Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#linear-profile">Linear Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#differential-profile">Differential Profile</a></li>
<li class="toctree-l2"><a class="reference internal" href="#autocorrelation-spectrum">Autocorrelation Spectrum</a></li>
<li class="toctree-l2"><a class="reference internal" href="#affine-function-and-affine-equivalence">Affine function and affine equivalence</a></li>
<li class="toctree-l2"><a class="reference internal" href="#cycle-structure-fixed-points-and-negated-fixed-points">Cycle structure, fixed points and negated fixed points</a></li>
<li class="toctree-l2"><a class="reference internal" href="#permutation-matrix">Permutation matrix</a></li>
<li class="toctree-l2"><a class="reference internal" href="#des-representations">DES representations</a></li>
<li class="toctree-l2"><a class="reference internal" href="#auxiliary-functions">Auxiliary functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="criteria.html">Cryptographic Criteria</a><ul>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#algebraic-degree">Algebraic degree</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#nonlinearity">Nonlinearity</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#r-th-order-nonlinearity">r-th order nonlinearity</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#balancedness">Balancedness</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#correlation-immunity">Correlation Immunity</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#algebraic-immunity">Algebraic immunity</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#global-avalanche-criterion">Global avalanche criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#linearity-distance">Linearity distance</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#propagation-criterion">Propagation criterion</a></li>
<li class="toctree-l2"><a class="reference internal" href="criteria.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="operations.html">Operations and constructions over Vector Boolean Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="operations.html#equality-testing">Equality testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#composition">Composition</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#inverse">Inverse</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#sum">Sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#direct-sum">Direct sum</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#concatenation">Concatenation</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#concatenation-of-polynomials-in-anf">Concatenation of polynomials in ANF</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#addition-of-coordinate-functions">Addition of coordinate functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#bricklayer">Bricklayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="operations.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="aes.html">Analysis of AES competition cryptographic algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="aes.html#cast-256">CAST-256</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#crypton">Crypton</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#deal">DEAL</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#e2">E2</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#loki97">LOKI97</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#magenta">Magenta</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#mars">Mars</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#rijndael">Rijndael</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#safer">Safer+</a></li>
<li class="toctree-l2"><a class="reference internal" href="aes.html#serpent">Serpent</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cryptec.html">Analysis of CRYPTEC project cryptographic algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="cryptec.html#cipherunicorn-e">CIPHERUNICORN-E</a></li>
<li class="toctree-l2"><a class="reference internal" href="cryptec.html#clefia">CLEFIA</a></li>
<li class="toctree-l2"><a class="reference internal" href="cryptec.html#hierocrypt3">Hierocrypt3</a></li>
<li class="toctree-l2"><a class="reference internal" href="cryptec.html#sc2000">SC2000</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="nessie.html">Analysis of NESSIE project cryptographic algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="nessie.html#anubis">Anubis</a></li>
<li class="toctree-l2"><a class="reference internal" href="nessie.html#camellia">Camellia</a></li>
<li class="toctree-l2"><a class="reference internal" href="nessie.html#grand-cru">Grand Cru</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="other.html">Analysis of other cryptographic algorithms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="other.html#des">DES</a></li>
<li class="toctree-l2"><a class="reference internal" href="other.html#kasumi">KASUMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="other.html#macguffin">MacGuffin</a></li>
<li class="toctree-l2"><a class="reference internal" href="other.html#mini-aes">Mini-AES</a></li>
<li class="toctree-l2"><a class="reference internal" href="other.html#square">Square</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="design.html">Design of cryptographically robust Vector Boolean functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="design.html#bent-functions">Bent functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="design.html#optimization-of-boolean-functions-via-genetic-algorithms">Optimization of Boolean functions via Genetic Algorithms</a></li>
<li class="toctree-l2"><a class="reference internal" href="design.html#variable-boolean-functions-with-nonlinearity-242">9-variable Boolean functions with nonlinearity 242</a></li>
<li class="toctree-l2"><a class="reference internal" href="design.html#variable-balanced-boolean-functions-with-nonlinearity-240">9-variable Balanced Boolean functions with nonlinearity 240</a></li>
<li class="toctree-l2"><a class="reference internal" href="design.html#variable-balanced-boolean-functions-with-nonlinearity-992">11-variable Balanced Boolean functions with nonlinearity 992</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a><ul>
<li class="toctree-l2"><a class="reference internal" href="faq.html#general">General</a></li>
<li class="toctree-l2"><a class="reference internal" href="faq.html#using-vbf">Using VBF</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="bibliography.html">Bibliography</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix.html">Appendix</a><ul>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#balanced-boolean-functions-generation">Balanced Boolean functions generation</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#cast-analysis-programs">CAST analysis programs</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#truth-table-format-conversion">Truth table format conversion</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#criteria-calculation">Criteria calculation</a></li>
<li class="toctree-l2"><a class="reference internal" href="appendix.html#affine-equivalence">Affine equivalence</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div></div>
          <div role="main" class="document">
            
  <div class="section" id="representations-and-characterizations">
<h1>Representations and characterizations<a class="headerlink" href="#representations-and-characterizations" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><a class="reference internal" href="#truth-table" id="id48">Truth Table</a><ul>
<li><a class="reference internal" href="#description" id="id49">Description</a></li>
<li><a class="reference internal" href="#library" id="id50">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#trace-representation" id="id51">Trace representation</a><ul>
<li><a class="reference internal" href="#id1" id="id52">Description</a></li>
<li><a class="reference internal" href="#id3" id="id53">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#polynomials-in-anf" id="id54">Polynomials in ANF</a><ul>
<li><a class="reference internal" href="#id5" id="id55">Description</a></li>
<li><a class="reference internal" href="#id8" id="id56">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#anf-table" id="id57">ANF table</a><ul>
<li><a class="reference internal" href="#id10" id="id58">Description</a></li>
<li><a class="reference internal" href="#id11" id="id59">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#characteristic-function" id="id60">Characteristic Function</a><ul>
<li><a class="reference internal" href="#id13" id="id61">Description</a></li>
<li><a class="reference internal" href="#id14" id="id62">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#walsh-spectrum" id="id63">Walsh Spectrum</a><ul>
<li><a class="reference internal" href="#id16" id="id64">Description</a></li>
<li><a class="reference internal" href="#id17" id="id65">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#linear-profile" id="id66">Linear Profile</a><ul>
<li><a class="reference internal" href="#id19" id="id67">Description</a></li>
<li><a class="reference internal" href="#id20" id="id68">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#differential-profile" id="id69">Differential Profile</a><ul>
<li><a class="reference internal" href="#id22" id="id70">Description</a></li>
<li><a class="reference internal" href="#id24" id="id71">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#autocorrelation-spectrum" id="id72">Autocorrelation Spectrum</a><ul>
<li><a class="reference internal" href="#id26" id="id73">Description</a></li>
<li><a class="reference internal" href="#linear-structures" id="id74">Linear structures</a></li>
<li><a class="reference internal" href="#id32" id="id75">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#affine-function-and-affine-equivalence" id="id76">Affine function and affine equivalence</a><ul>
<li><a class="reference internal" href="#id34" id="id77">Description</a></li>
<li><a class="reference internal" href="#id37" id="id78">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#cycle-structure-fixed-points-and-negated-fixed-points" id="id79">Cycle structure, fixed points and negated fixed points</a><ul>
<li><a class="reference internal" href="#id39" id="id80">Description</a></li>
<li><a class="reference internal" href="#id40" id="id81">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#permutation-matrix" id="id82">Permutation matrix</a><ul>
<li><a class="reference internal" href="#id42" id="id83">Description</a></li>
<li><a class="reference internal" href="#id43" id="id84">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#des-representations" id="id85">DES representations</a><ul>
<li><a class="reference internal" href="#id46" id="id86">Library</a></li>
</ul>
</li>
<li><a class="reference internal" href="#auxiliary-functions" id="id87">Auxiliary functions</a></li>
<li><a class="reference internal" href="#summary" id="id88">Summary</a></li>
</ul>
</div>
<p>This chapter presents a review of theory relevant to the study of the typical forms of Vector Boolean function representations and chacterizations. We will consider representations those that uniquely represents a Vector Boolean function. Characterizations does not uniquely determine the Vector Boolean function in contrast to the previous matrices but provide some useful information in the context of cryptography.</p>
<p>Representations included in this chapter are the Truth Table (TT), the polynomials in Algebraic Normal Form (Pol) and ANF Table (ANF), the Image (Char), Component functions Truth Table(LTT), Sequence vectors of Component functions CTT, the Trace Representation (Trace) and Affine function Representation. A definition for all these representations are given and the relationships among them and their various properties are also discussed.</p>
<p>Characterizations such as Linear Profile (LP), Differential Profile (DP), Autocorrelation Spectrum (AC), Linear Structures (LS) are introduced. A definition for all these represen- tations are given and the relationships among them and the above representations and their various properties are also discussed.</p>
<p>The basic concepts of linear and differential cryptanalysis are introduced in terms of the Linear Profile and Differential Profile, together with other properties related with these attacks, such as: linear potential, differential potential, linear or differential relations associated with a specific value.</p>
<p>Affine equivalence analysis of Boolean functions by means of VBF library is described. It is showed how to obtain the Frequency distribution of the absolute values of the Walsh Spectrum and of the Autocorrelation Spectrum.</p>
<p>It is possible to check randomness of a Vector Boolean function outputs with VBF by means of its cycle structure, and the analysis of the presence of fixed points or negated fixed points.</p>
<p>Finally, some other representations useful in block ciphers are described such as the Permutation Vector (Per), Expansion and Compression DES permutations and DES-like S-box representations.
The description of each representation and characterization is complemented with the description of the methods in VBF related to them. Most of the member functions of V BF have an in-line definition, for instance: <code class="code docutils literal"><span class="pre">void</span> <span class="pre">TT(NTL::mat_GF2&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code> is also defined as inline <code class="code docutils literal"><span class="pre">NTL::mat_GF2</span> <span class="pre">TT(VBF&amp;</span> <span class="pre">F)</span></code>.</p>
<p>The figure summarizes the relationships among the different representations.</p>
<a class="reference internal image-reference" href="images/relationshipsrep.png"><img alt="images/relationshipsrep.png" class="align-center" src="images/relationshipsrep.png" style="width: 750px;" /></a>
<p>The representations which are Boolean matrices are coloured in red, those which are Integer matrices are coloured in blue, those that are vector of integers are coloured in yellow and those which are polynomial are coloured in green.</p>
<div class="section" id="truth-table">
<h2><a class="toc-backref" href="#id48">Truth Table</a><a class="headerlink" href="#truth-table" title="Permalink to this headline">¶</a></h2>
<div class="section" id="description">
<h3><a class="toc-backref" href="#id49">Description</a><a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h3>
<p>A Vector Boolean function <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> can be uniquely represented by its Truth Table which is a matrix with <img class="math" src="images/math/372fc4dd1270e8bd966735a2567c798ab49d57c8.png" alt="2^n"/> rows and <em>m</em> columns whose elements are the values of <em>F</em> taken on all possible vector of <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/> ordered lexicographically.</p>
<p>Let <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/>, if we take into account the one-to-one mapping of <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/> onto the set of integers, we are able to define any vector Boolean function by the corresponding set of values:</p>
<div class="math">
<p><img src="images/math/b03c410ac2b115b21156df4a1d6474431a08c9a4.png" alt="F(\boldsymbol{\alpha_i}) \in \gf{V_m} \  \  \fa i \in \{0,\dots,2^n-1\}"/></p>
</div><p>The matrix with <img class="math" src="images/math/372fc4dd1270e8bd966735a2567c798ab49d57c8.png" alt="2^n"/> rows and <img class="math" src="images/math/01069aff128fadf3a7beda62dedbc96983060010.png" alt="m"/> columns will be referred as the <em>Truth Table</em> of <em>F</em> and will be generally written as <img class="math" src="images/math/4dffb5ab64fd80d0e489760b285db76678cb398e.png" alt="\matr{TT}_F"/>:</p>
<div class="math">
<p><img src="images/math/41e75fe7442fa972c2313ae3c17ed8fe55b1f261.png" alt="\matr{TT}_F=\begin{bmatrix} f_1(\boldsymbol{\alpha_0})&amp;\dots&amp;f_{m}(\boldsymbol{\alpha_0}) \\
f_1(\boldsymbol{\alpha_1})&amp;\dots&amp;f_{m}(\boldsymbol{\alpha_1}) \\
\hdotsfor[2]{3} \\
f_1(\boldsymbol{\alpha_{2^n-1}})&amp;\dots&amp;f_{m}(\boldsymbol{\alpha_{2^n-1}}) \end{bmatrix}"/></p>
</div><p>each <img class="math" src="images/math/53d86f8a35f58dc9c8c6cd97d506eceada7bb3ec.png" alt="\boldsymbol{\alpha_i} = (x_1,\dots ,x_n) \in \gf{V_n} \  \  i \in
\{1,\dots,2^n-1\}"/> is a vector whose decimal equivalent is
<img class="math" src="images/math/cfc52bf0c4ff5ae3afde58d1874379b782970629.png" alt="dec(\boldsymbol{\alpha_i})=i=\sum_{j=1}^{n} x_j 2^{n-j}"/>, and all
the vectors of <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/> can be listed so that <img class="math" src="images/math/dbb6c8e8a73138191a6ff9ff74ce5a5cffa42c7c.png" alt="\boldsymbol{\alpha_0} &lt;
\boldsymbol{\alpha_1} &lt; \dotsb &lt; \boldsymbol{\alpha_{2^{n-1}}}"/>.</p>
<p>As a total order is defined over the assignments (inputs) of the Vector Boolean Function, the Truth Table can be uniquely represented by this matrix. Any function <em>F</em> can be uniquely described by its Truth Table <img class="math" src="images/math/594318a659a3ae52df82a5b22406f657d8efeb05.png" alt="\matr{TT}_F \in \matr{M}_{2^n \times m}(\gf{GF(2)})"/> (or by the Truth Tables of its coordinate functions <img class="math" src="images/math/1dbae0dc9046313ed4db6b8d4780d2ac17269fd7.png" alt="\matr{TT}_{f_i} \  \  i \in \{1,\dots,m\}"/>) and it holds that:</p>
<div class="math">
<p><img src="images/math/e0555b82cdd2a6af1c86a1b60f193c128f10d63f.png" alt="\begin{array}{rcl}
 \gamma:\funct{F}_{n,m} &amp;\to&amp; \matr{M}_{2^n \times m}(\gf{GF(2)}) \\
   F &amp;\to&amp; \matr{TT}_F
\end{array}"/></p>
</div><p>is an isomorphism between the vector spaces <img class="math" src="images/math/1f4243b94a9ad5a58dee6e19bc851f9b27fb22ef.png" alt="\funct{F}_{n,m}"/> and <img class="math" src="images/math/7b6140731b37d93136ef99658fb05877cd01433e.png" alt="\matr{M}_{2^n \times m}(\gf{GF(2)})"/>, so that <img class="math" src="images/math/685b082be82303b892380d626c40d3d7ec39d3b7.png" alt="\#\funct{F}_{n,m}=2^{2^n \cdot m}"/>.</p>
<p>The Truth Table for an <em>n</em>-variable Boolean function <em>f</em> should be in
lexicographical form, i.e., <img class="math" src="images/math/fec052e15bbf498934c167333db17be00b402c25.png" alt="\matr{TT}_f = (f(0),f(1),f(2),\ldots,f(2^{n-1}))"/>. Since the
Truth Table length might be too large, we represent it in hexadecimal
rather than in binary notation. The hexadecimal Truth Table is obtained
by replacing each four bits by their corresponding
hexadecimal form. For instance, to enter <img class="math" src="images/math/3d9035a4199697ca6285ec9dae142c4947d999de.png" alt="\matr{TT}_f = (0, 0, 1, 1, 1, 1, 1, 1)"/>
one should just write <img class="math" src="images/math/1e8b0798c8ea6c660d5a2812803e49169afef1b4.png" alt="\matr{TT}_f=3f"/>.</p>
<p>The distance between two Vector Boolean functions <img class="math" src="images/math/a65ea8c7eb524aa2717f4cb7f28e3980927f153a.png" alt="F, G \in \funct{F}_{n,m}"/> is defined as the number of bits that are different in their respective Truth Tables:</p>
<div class="math">
<p><img src="images/math/b5628172b0e3764405e9843bf2ddd2a4773656bd.png" alt="d(F,G) = \sum_{\vec{x} \in \gf{V_n}} d \left( F(\vec{x}), G(\vec{x}) \right)"/></p>
</div><p>where <img class="math" src="images/math/f44fe8b7d9861f029996ae387a5bef80cff77514.png" alt="d\left( F(\vec{x}), G(\vec{x}) \right)"/> is the Hamming distance between the two vectors <img class="math" src="images/math/852e7d29112e8b38aeb161ea06a77f5f18b3d557.png" alt="F(\vec{x}), G(\vec{x}) \in \gf{V_m}"/>.</p>
<p>The weight of a Vector Boolean function <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> is equal to the distance between <em>F</em> and the corresponding zero Vector Boolean function <img class="math" src="images/math/d43f553ec56c55688d2ae9c7308cf87b70a29630.png" alt="0 \in \funct{F}_{n,m}"/> where <img class="math" src="images/math/e6a0b1b3caea5781c20a181a5f7828de80a48d15.png" alt="0(\vec{x})=\vec{0} \ \fa \vec{x} \in \gf{V_n}"/>.</p>
<p>In order to obtain certain characterizations (such as Autocorrelation Spectrum), it is important to take into account two additional representations related to the Truth Table: <img class="math" src="images/math/74999bc1620359cb2df1afad4cf87a1654657076.png" alt="\matr{LTT}"/> and <img class="math" src="images/math/4da58c028fedf9de2fea1b5ea34ed4d6c35bcd54.png" alt="\matr{CTT}"/>.</p>
<p>We will denote by <img class="math" src="images/math/74999bc1620359cb2df1afad4cf87a1654657076.png" alt="\matr{LTT}"/> of <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> the matrix whose columns are the Truth Tables of the <img class="math" src="images/math/151c10fa3095a1bb9c2018384589e8cd0b38edd1.png" alt="2^m"/> component functions of <em>F</em>. We will denote by <img class="math" src="images/math/4da58c028fedf9de2fea1b5ea34ed4d6c35bcd54.png" alt="\matr{CTT}"/> of <em>F</em> the matrix whose columns are the sequence vectors of the <img class="math" src="images/math/151c10fa3095a1bb9c2018384589e8cd0b38edd1.png" alt="2^m"/> component functions of <em>F</em> (Sometimes it is called the Polarity Truth Table).</p>
</div>
<div class="section" id="library">
<h3><a class="toc-backref" href="#id50">Library</a><a class="headerlink" href="#library" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized by a Boolean Matrix representing the Truth Table with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">puttt</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">T</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain the Truth Table of a Vector Boolean function the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">TT</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">X</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>A VBF class can be initialized by a collection of strings separated by carriage returns defined by <em>s</em> with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putHexTT</span><span class="p">(</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>Each row must be the hexadecimal representation of the Truth Table of the coordinate functions of a Vector Boolean function. To obtain the Truth Table in hexadecimal representation the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">getHexTT</span><span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>Analogously a VBF class can be initialized by a collecting of strings with binary representation of the Truth Table of coordinate functions:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putBinTT</span><span class="p">(</span><span class="n">istream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain its Truth Table in binary representation the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">getBinTT</span><span class="p">(</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>A VBF class can be initialized by a Boolean vector representing the decimal representation of the Truth Table of a Vector Boolean Function defined by a vector of outputs in lexicographic order, called <em>d</em>, and knowing the number of component Boolean functions <em>m</em>:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putDecTT</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">vec_long</span><span class="o">&amp;</span> <span class="n">d</span><span class="p">,</span><span class="k">const</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain the Truth Table in decimal representation the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">NTL</span><span class="o">::</span><span class="n">vec_long</span> <span class="n">getDecTT</span><span class="p">()</span> <span class="k">const</span>
</pre></div>
</div>
<p>To obtain the weight of a Vector Boolean function <em>F</em> the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">weight</span><span class="p">(</span><span class="kt">long</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>A VBF class can be initialized by a Boolean Matrix representing the Truth Table of their component functions with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putltt</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">L</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain the Truth Table of the component functions of a Vector Boolean function the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">LTT</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">X</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>A VBF class can be initialized by a Boolean Matrix representing its Polarity Truth Table with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putctt</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain the Polarity Truth Table of a Vector Boolean function the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">CTT</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">X</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>The Truth Table of the NibbleSub S-box is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="p">[[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">]</span>
</pre></div>
</div>
<p>If we use a file with this matrix as the input of the following program, we can obtain its hexadecimal, binary and decimal representation, as well as the Truth Tables of the components functions and its Polarity Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span>
   <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The hexadecimal representation is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">getHexTT</span><span class="p">(</span><span class="n">cout</span><span class="p">);</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The binary representation is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">getBinTT</span><span class="p">(</span><span class="n">cout</span><span class="p">);</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The decimal representation is: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span>
   <span class="o">&lt;&lt;</span> <span class="n">F</span><span class="p">.</span><span class="n">getDecTT</span><span class="p">()</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Truth Table of the component functions is: &quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">LTT</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Polarity Truth Table is: &quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">CTT</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output of this program would be:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The hexadecimal representation is:</span>
<span class="go">a754</span>
<span class="go">e439</span>
<span class="go">8ee1</span>
<span class="go">368d</span>

<span class="go">The binary representation is:</span>
<span class="go">1010011101010100</span>
<span class="go">1110010000111001</span>
<span class="go">1000111011100001</span>
<span class="go">0011011010001101</span>

<span class="go">The decimal representation is:</span>
<span class="go">[14 4 13 1 2 15 11 8 3 10 6 12 5 9 0 7]</span>

<span class="go">The Truth Table of the component functions is:</span>
<span class="go">[[0 0 1 1 1 1 0 0 1 1 0 0 0 0 1 1]</span>
<span class="go">[0 0 0 0 1 1 1 1 0 0 0 0 1 1 1 1]</span>
<span class="go">[0 1 0 1 1 0 1 0 1 0 1 0 0 1 0 1]</span>
<span class="go">[0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1]</span>
<span class="go">[0 0 1 1 0 0 1 1 0 0 1 1 0 0 1 1]</span>
<span class="go">[0 1 1 0 1 0 0 1 1 0 0 1 0 1 1 0]</span>
<span class="go">[0 1 1 0 0 1 1 0 1 0 0 1 1 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 0 1 1 1 1 1 1 1 1]</span>
<span class="go">[0 1 1 0 0 1 1 0 0 1 1 0 0 1 1 0]</span>
<span class="go">[0 0 1 1 0 0 1 1 1 1 0 0 1 1 0 0]</span>
<span class="go">[0 0 1 1 1 1 0 0 0 0 1 1 1 1 0 0]</span>
<span class="go">[0 0 0 0 1 1 1 1 1 1 1 1 0 0 0 0]</span>
<span class="go">[0 1 0 1 1 0 1 0 0 1 0 1 1 0 1 0]</span>
<span class="go">[0 1 0 1 0 1 0 1 1 0 1 0 1 0 1 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 1 1 0 1 0 0 1 0 1 1 0 1 0 0 1]</span>
<span class="go">]</span>

<span class="go">The Polarity Truth Table is:</span>
<span class="go">[[1 1 -1 -1 -1 -1 1 1 -1 -1 1 1 1 1 -1 -1]</span>
<span class="go">[1 1 1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1]</span>
<span class="go">[1 -1 1 -1 -1 1 -1 1 -1 1 -1 1 1 -1 1 -1]</span>
<span class="go">[1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1 1 -1]</span>
<span class="go">[1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1]</span>
<span class="go">[1 -1 -1 1 -1 1 1 -1 -1 1 1 -1 1 -1 -1 1]</span>
<span class="go">[1 -1 -1 1 1 -1 -1 1 -1 1 1 -1 -1 1 1 -1]</span>
<span class="go">[1 1 1 1 1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1]</span>
<span class="go">[1 -1 -1 1 1 -1 -1 1 1 -1 -1 1 1 -1 -1 1]</span>
<span class="go">[1 1 -1 -1 1 1 -1 -1 -1 -1 1 1 -1 -1 1 1]</span>
<span class="go">[1 1 -1 -1 -1 -1 1 1 1 1 -1 -1 -1 -1 1 1]</span>
<span class="go">[1 1 1 1 -1 -1 -1 -1 -1 -1 -1 -1 1 1 1 1]</span>
<span class="go">[1 -1 1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1]</span>
<span class="go">[1 -1 1 -1 1 -1 1 -1 -1 1 -1 1 -1 1 -1 1]</span>
<span class="go">[1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1]</span>
<span class="go">[1 -1 -1 1 -1 1 1 -1 1 -1 -1 1 -1 1 1 -1]</span>
<span class="go">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="trace-representation">
<h2><a class="toc-backref" href="#id51">Trace representation</a><a class="headerlink" href="#trace-representation" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id52">Description</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<p>We identify a Boolean function in <em>n</em> variables with a function from <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/> to <img class="math" src="images/math/b73c0d5e5c24eb46c1dbbeda6ca9e5953792505a.png" alt="\gf{GF(2)}"/> and Vector Boolean function in <em>n</em> variables with a function from <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/> to <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/>.</p>
<p>A <em>trace</em> is a function over a finite field <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/> defined as: <img class="math" src="images/math/1ba1a2a16860458efab24ea6ded4ad60701f1f0e.png" alt="tr(\vec{x}) = \sum_{i=0}^{2^n-1} x^i"/></p>
<p>Since there is is an isomorphism between <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/> and <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/>, it is possible to identify the trace function with a Boolean function in <em>n</em> variables. Analogously, a Vector Boolean function can be identified with trace as follows:</p>
<p>When <em>m=n</em>, we endow <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/> with the structure of the field <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/>. Any <img class="math" src="images/math/841b86f0d9354a22ef8d115f559b85362ce7045d.png" alt="F \in \funct{F}_{n,n}"/> admits a unique <em>univariate polynomial representation</em> over <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/>, of degree at most <img class="math" src="images/math/36c6ac238b52ae7700773d5459ae59fdb0d71ccc.png" alt="2^n-1"/>:</p>
<div class="math">
<p><img src="images/math/d1c796f66c732cd8c2cfacf81983e13865701fc2.png" alt="F(\vec{x}) = \sum_{i=0}^{2^n-1} \delta_i x^i, \ \delta_i \in \gf{GF(2^n)}"/></p>
</div><p>A general way to derive this polynomial representation is given by a Lagrange interpolation from the knowledge of the irreducible polynomial of degree <em>n</em> over <img class="math" src="images/math/b73c0d5e5c24eb46c1dbbeda6ca9e5953792505a.png" alt="\gf{GF(2)}"/> associated with the field <img class="math" src="images/math/0b9d1709e437e136ef683c3007f869f14ab71515.png" alt="GF(2^n)"/> and the Truth Table of <em>F</em>.</p>
<p>The <em>interpolation attack</em> <a class="reference internal" href="bibliography.html#jakobsenk-97" id="id2">[JakobsenK:97]</a> is efficient when the degree of the univariate polynomial representation of the S-box over <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/> is low or when the distance of the S-box to the set of low univariate degree functions is small. This attack exploits the low degree of the algebraic relation between some input (respective output) and intermediate data to infer some keybits relating the output (respective input) and the intermediate data.</p>
</div>
<div class="section" id="id3">
<h3><a class="toc-backref" href="#id53">Library</a><a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its trace <em>f</em> and the irreducible polynomial <em>g</em> with the following methods:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putirrpol</span><span class="p">(</span><span class="n">GF2X</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="kt">void</span> <span class="n">puttrace</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain a Vector Boolean function trace representation the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">Trace</span><span class="p">(</span><span class="n">GF2EX</span><span class="o">&amp;</span> <span class="n">f</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>and to print the trace representation use the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">GF2EX</span><span class="o">&amp;</span> <span class="n">f</span><span class="p">,</span> <span class="k">const</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id4">
<h4>Example<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>The following program provides the Trace representation over <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/> of a Vector Boolean function with Truth Table in a file with extension &#8221;.tt&#8221;. <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/> is constructed with the irreducible polynomial whose corresponding GF2X representation is in a file with extension &#8221;.irr&#8221;. The class GF2X implements polynomial arithmetic modulo 2 and a polynomial is represented as a coefficient vector.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">GF2X</span> <span class="n">g</span><span class="p">;</span>
   <span class="n">GF2EX</span> <span class="n">f</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">file</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.irr&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ifstream</span> <span class="n">input1</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input1</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">putirrpol</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
   <span class="n">input1</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.tt&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The trace representation is &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">f</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">d</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
   <span class="n">print</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">d</span><span class="p">);</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this cipher, <img class="math" src="images/math/a304670c9f29763f9f68c5efbc6720d035f3c4b1.png" alt="\gf{GF(2^8)}"/> is constructed with the irreducible polynomial <img class="math" src="images/math/4258c6ab8c37b686ed09e3cc2537af74f95e8069.png" alt="g(\vec{x}) = {\vec{x}}^8+{\vec{x}}^4+{\vec{x}}^3+\vec{x}+\vec{1}"/>. The inputs of this program would be the Truth Table of <img class="math" src="images/math/d01e8e8d2a96678d2c40a134744a50e24e850d60.png" alt="S_{RD}"/> in a file with extension &#8221;.tt&#8221; and the corresponding GF2X representation of <img class="math" src="images/math/2a0747bc0e5304e646491fcd40995460a5599ed2.png" alt="g: [1 1 0 1 1 0 0 0 1]"/> in a file with extension &#8221;.irr&#8221;. The output of the program would be a GF2EX which represents polynomials over GF2E, and so can be used, for example, for arithmetic in <img class="math" src="images/math/15ff8b4213f948ebec5a2566b2707b94d1c14cd8.png" alt="\gf{GF(2^n)}"/>:</p>
<div class="math">
<p><img src="images/math/796366cd3ff88ed243be46ea13bc64721e6fdec0.png" alt="05 \cdot x^{254} + 09 \cdot x^{253} + f9 \cdot x^{251} + 25 \cdot x^{247} + f4 \cdot x^{239} + 01 \cdot x^{223} + b5 \cdot x^{191} + 8f \cdot x^{127} + 63"/></p>
</div><p>The coefficients are elements of <img class="math" src="images/math/a304670c9f29763f9f68c5efbc6720d035f3c4b1.png" alt="\gf{GF(2^8)}"/>.</p>
</div>
</div>
</div>
<div class="section" id="polynomials-in-anf">
<h2><a class="toc-backref" href="#id54">Polynomials in ANF</a><a class="headerlink" href="#polynomials-in-anf" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id5">
<h3><a class="toc-backref" href="#id55">Description</a><a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>Any vector Boolean function <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> can be uniquely represented by <em>m</em> multivariate polynomials over <img class="math" src="images/math/b73c0d5e5c24eb46c1dbbeda6ca9e5953792505a.png" alt="\gf{GF(2)}"/> (called coordinate functions) where each variable has power at most one. Each of these polynomials can be expressed as a sum of all distinct <a href="#id6"><span class="problematic" id="id7">*</span></a>k*th-order product terms <img class="math" src="images/math/33d558e1593d2c85a3156cea04b4410bea54840e.png" alt="(0 &lt; k \leq n)"/> of the variables in the form:</p>
<div class="math">
<p><img src="images/math/8eb40bf7de3e8a6a6e8626b140b21b364ef12fc4.png" alt="\begin{array}{ll}
f(x_1,\dots,x_n) &amp;= a_0+a_1 x_1+\dotsb+a_n
x_n+a_{12}x_1x_2+\dotsb+a_{n-1,n}x_{n-1}x_n+\dotsb \\ &amp;+a_{12\dots n}x_1x_2\dots x_n
= \sum_{\set{I} \in \set{P}(N)} a_{\set{I}}\left(\prod_{i \in \set{I}} x_i\right) = \sum_{\set{I} \in \set{P}(N)} a_{\set{I}} x^{\set{I}}, \ \ a_{\set{I}} \in \gf{GF(2)}
\end{array}"/></p>
</div><p>where <img class="math" src="images/math/6f08a466e7bae4a71a92973c5ea8690597609699.png" alt="\set{P}(N)"/> denotes the power set of <img class="math" src="images/math/182be6ac99442b8d0e239c40eb8f7edee0c80dc4.png" alt="N=\{1,\dots,n\}"/>. This representation of <em>f</em> is called the <em>algebraic normal form (ANF)</em> of <em>f</em>. The algebraic normal form is thus a set of multivariate polynomials and the constant functions (those obtained by decomposition) are the coefficients of the <img class="math" src="images/math/372fc4dd1270e8bd966735a2567c798ab49d57c8.png" alt="2^n"/> products of input variables (i.e. monomials).</p>
</div>
<div class="section" id="id8">
<h3><a class="toc-backref" href="#id56">Library</a><a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its Polynomials in ANF with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putpol</span><span class="p">(</span><span class="n">vec_pol</span><span class="o">&amp;</span> <span class="n">p</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain its representation as Polynomials in ANF, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">Pol</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id9">
<h4>Example<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>The following program provides the Polynomials in ANF Vector Boolean function from its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">Pol</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">1+x4+x2+x2x3+x2x3x4+x1+x1x2+x1x2x3</span>
<span class="go">1+x3x4+x2+x2x4+x1+x1x3+x1x3x4</span>
<span class="go">1+x4+x3+x3x4+x2x4+x2x3+x1x4+x1x3+x1x2+x1x2x4+x1x2x3</span>
<span class="go">x3+x2x4+x1+x1x4+x1x3x4</span>
</pre></div>
</div>
<p>which corresponds to the coordinate functions of <em>NibbleSub</em> as follows:</p>
<div class="math">
<p><img src="images/math/8357fe0a63f88e6007cbea27f69e3f39af8063f4.png" alt="\begin{array}{ll}
&amp;f_1(NibbleSub) = 1+x_4+x_2+x_2x_3+x_2x_3x_4+x_1+x_1x_2+x_1x_2x_3 \\
&amp;f_2(NibbleSub) = 1+x_3x_4+x_2+x_2x_4+x_1+x_1x_3+x_1x_3x_4 \\
&amp;f_3(NibbleSub) = 1+x_4+x_3+x_3x_4+x_2x_4+x_2x_3+x_1x_4+x_1x_3+x_1x_2+x_1x_2x_4+x_1x_2x_3 \\
&amp;f_4(NibbleSub) = x_3+x_2x_4+x_1+x_1x_4+x_1x_3x_4 \\
\end{array}"/></p>
</div></div>
</div>
</div>
<div class="section" id="anf-table">
<h2><a class="toc-backref" href="#id57">ANF table</a><a class="headerlink" href="#anf-table" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id10">
<h3><a class="toc-backref" href="#id58">Description</a><a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p><em>ANF table</em> of <em>F</em>, denoted by <img class="math" src="images/math/46e83a745a583017dba105fcca9ce48a589ef7cf.png" alt="\matr{ANF}_F \in \matr{M}_{2^n \times m}(\gf{GF(2)})"/>, represents the <img class="math" src="images/math/372fc4dd1270e8bd966735a2567c798ab49d57c8.png" alt="2^n"/> coefficients of the polynomials of each of the m coordinate functions in <em>ANF</em>.</p>
<p>The ANF table of <em>F</em>, denoted by <img class="math" src="images/math/46e83a745a583017dba105fcca9ce48a589ef7cf.png" alt="\matr{ANF}_F \in \matr{M}_{2^n \times m}(\gf{GF(2)})"/>, is defined by <img class="math" src="images/math/3fa7b9f577f94c4fee2c9416651ed97c172e0aed.png" alt="{\matr{ANF}_{F}}^i= \matr{ANF}_{f_i} \  \  i \in \{1,\dots,m\}"/> where <img class="math" src="images/math/7fdb5757666060ec570060bdce7064b52bf52696.png" alt="{\matr{ANF}_{F}}^i"/> is the <em>i</em>-th column of <img class="math" src="images/math/8fdf1df26b40db746e3d4f18d977fe239c0af1fb.png" alt="\matr{ANF}_{F}"/>.</p>
<p>The ANF Table can be derived from the Truth Table by a binary matrix transformation called the Algebraic Normal Form Transformation (implemented in the VBF library with <em>getanf</em> method). The Truth Table can be obtained from the ANF Table using a method we call <em>rev</em>.</p>
</div>
<div class="section" id="id11">
<h3><a class="toc-backref" href="#id59">Library</a><a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its ANF table with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putanf</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">A</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain its representation as ANF table, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">ANF</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">X</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id12">
<h4>Example<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>The following program provides the ANF Table of a Vector Boolean function from its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The ANF Table is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">ANF</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The ANF Table is:</span>
<span class="go">[[1 1 1 0]</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 0 1 1]</span>
<span class="go">[0 1 1 0]</span>
<span class="go">[1 1 0 0]</span>
<span class="go">[0 1 1 1]</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[1 1 0 1]</span>
<span class="go">[0 0 1 1]</span>
<span class="go">[0 1 1 0]</span>
<span class="go">[0 1 0 1]</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[1 0 1 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="characteristic-function">
<h2><a class="toc-backref" href="#id60">Characteristic Function</a><a class="headerlink" href="#characteristic-function" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id13">
<h3><a class="toc-backref" href="#id61">Description</a><a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h3>
<p>The <em>characteristic or indicator</em> function of <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/>, denoted by <img class="math" src="images/math/c397986cbbb9bac262a8043097babd7ffa249b05.png" alt="\theta_F : \gf{V_n} \times \gf{V_m} \to \left\{0,1\right\}"/>, is defined by: <img class="math" src="images/math/fb508f0bfd2aa2b1af55cd71b35828bab0b77d95.png" alt="\theta_{F}(\vec{x},\vec{y}) = \left\{ \begin{array}{cc} 1 &amp; \mbox{if }\vec{y}=F(\vec{x}) \\ 0 &amp; \mbox{if }\vec{y} \neq F(\vec{x}) \end{array} \right."/></p>
<p>The Image of <em>F</em> can be represented by a matrix whose rows are indexed by <img class="math" src="images/math/e638ef401ecd2a3f96a168ae956d6ddb447f0a96.png" alt="\vec{x} \in \gf{V_n}"/> and whose columns are indexed by <img class="math" src="images/math/7ca2250f37943a1b57f3c1b1a065dc94613e2797.png" alt="\vec{y} \in \gf{V_m}"/> in lexicographic order, denoted by <img class="math" src="images/math/6aa6944be3eddfec83d1e258686a5e6e5815c5cf.png" alt="\matr{Img(F)} \in \matr{M}_{2^n \times 2^m}(\gf{GF(2)})"/> and defined as follows:</p>
<div class="math">
<p><img src="images/math/aee3adb1b46fc3930dadf1c81441f8013396104f.png" alt="\matr{Img(F)} = \begin{bmatrix} \theta_{F}(\boldsymbol{\alpha_0},\boldsymbol{\alpha_0})&amp;\dots&amp;\theta_F(\boldsymbol{\alpha_0},\boldsymbol{\alpha_{2^m-1}}) \\
\theta_F(\boldsymbol{\alpha_1},\boldsymbol{\alpha_0})&amp;\dots&amp;\theta_F(\boldsymbol{\alpha_1},\boldsymbol{\alpha_{2^m-1}}) \\
\hdotsfor[2]{3}\\
\theta_F(\boldsymbol{\alpha_{2^n-1}},\boldsymbol{\alpha_0})&amp;\dots&amp;\theta_F(\boldsymbol{\alpha_{2^n-1}},\boldsymbol{\alpha_{2^m-1}}) \\
\end{bmatrix}"/></p>
</div><p>where <img class="math" src="images/math/a7ce60347f06b629b955a69aad4f9cb8dcd8963b.png" alt="\theta_{F}(\vec{x},\vec{y})"/> is the value of the indicator function at <img class="math" src="images/math/616aa19c2c6d8fa1e8684d882a3787cabf5c8009.png" alt="(\vec{x},\vec{y})"/>.</p>
<p>It is clear that all the rows of the matrix <img class="math" src="images/math/a1d616aaffb5ace45ba58395383d70df58f70eb6.png" alt="\matr{Img(F)}"/> have one element equal to one and the rest is zero, that is <img class="math" src="images/math/7a0f2cb663edf7858cc581a2805cf59720b50adc.png" alt="\ \fa i \in \{1,\dots,2^n\}"/>:</p>
<div class="math">
<p><img src="images/math/061b6cfe27cb3ef0609d6804466b5eb2028987c5.png" alt="\begin{array}{rcl}
\matr{Img(F)}_i &amp;=&amp; \begin{bmatrix} a_{i1}&amp;\dots&amp;a_{i2^m} \end{bmatrix} \\
\mbox{ where } \left( \exists!j \in \{1,\dots,2^m\} \ a_{ij}=1 \right) &amp;\wedge&amp; \left( a_{ik} = 0 \ \fa k \neq j \in \{1,\dots,2^m\} \right)
\end{array}"/></p>
</div><p>The Image of <em>F</em> can be derived from the Truth Table by a method implemented in the VBF library called <em>charfunct</em>. The Truth Table can be obtained from the Characteristic function using a method we call <em>truthtable</em>.</p>
</div>
<div class="section" id="id14">
<h3><a class="toc-backref" href="#id62">Library</a><a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its Image with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putchar</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">C</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain its representation as Image, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">Charact</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">C</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id15">
<h4>Example<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>The following program provides the Image of a Vector Boolean function from its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span>  <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Image is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Charact</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Image is:</span>
<span class="go">[[0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 0]</span>
<span class="go">[0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0 0 1 0 0]</span>
<span class="go">[0 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 1 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 1 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 1 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0]</span>
<span class="go">[1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>This matrix can be easily interpreted with the aid of the figure in which the rows and columns are indexed with the corresponding vector:</p>
<a class="reference internal image-reference" href="images/image.png"><img alt="images/image.png" class="align-center" src="images/image.png" style="width: 750px;" /></a>
<p>You can see for instance that the output of <em>0000</em> is <em>1110</em>.</p>
</div>
</div>
</div>
<div class="section" id="walsh-spectrum">
<h2><a class="toc-backref" href="#id63">Walsh Spectrum</a><a class="headerlink" href="#walsh-spectrum" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id16">
<h3><a class="toc-backref" href="#id64">Description</a><a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h3>
<p>Linear and affine functions are considered as cryptographically weak functions. It is important to measure if a Vector Boolean function has some similarity with these functions. The similarity is measured by means of correlation. The values of Walsh Spectrum provide a measure of the correlation of the Vector Boolean function with the different Vector Boolean Linear functions.</p>
<p>Let <img class="math" src="images/math/8376c40e562f8305aa285dc3660d2de91b8d06d1.png" alt="\matr{H_n}"/> be the Walsh-Hadamard matrix of order <img class="math" src="images/math/372fc4dd1270e8bd966735a2567c798ab49d57c8.png" alt="2^n"/>, then the vectors associated with its columns constitute an orthogonal basis for <img class="math" src="images/math/aa5ff39a59a7f93204ab52d6cfcb2b8ef4dc58cb.png" alt="\bbbr^{2^n}"/> over <img class="math" src="images/math/98453f2d6101e5351a0cd0ba9da42487108bdd69.png" alt="\bbbr"/> so that:</p>
<div class="math">
<p><img src="images/math/a44f4beacd10c0ef589f852a13380287247084e6.png" alt="\vec{x} \matr{H_n} = \vec{y} , \fa \vec{x}, \vec{y} \in         \bbbr^{2^n}"/></p>
</div><p>Let <img class="math" src="images/math/74a88d4301d245a75908ffa09fa3b57b450baa06.png" alt="f \in \funct{F}_n"/>, its sequence <img class="math" src="images/math/2dd40efb3784e2a0c50df8d760e4abbd2fcdaab4.png" alt="\xi_f \in \bbbr^{2^n}"/> can be defined as a linear combination of the sequences of all the linear functions over <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/>, as they coincide with the rows of <img class="math" src="images/math/8376c40e562f8305aa285dc3660d2de91b8d06d1.png" alt="\matr{H_n}"/>.</p>
<div class="math">
<p><img src="images/math/c3976d5ca82a9ae12b9f6007a7a53e1bf2853541.png" alt="\xi_f = a_{\boldsymbol{\alpha_{0}}} \xi_{l_{\boldsymbol {\alpha_{0}}}} + \dots + a_{\boldsymbol{\alpha_{2^n-1}}}        \xi_{l_{\boldsymbol{\alpha_{2^n-1}}}}"/></p>
</div><p>where <img class="math" src="images/math/c443fc1ffbd1d702c5d885f6ba326c310962ef44.png" alt="a_{\vec{u}} = \frac{1}{2^n} \left\langle \xi_f, \xi_{l_{\vec{u}}} \right\rangle"/></p>
<p>Let a Boolean function <img class="math" src="images/math/74a88d4301d245a75908ffa09fa3b57b450baa06.png" alt="f \in \funct{F}_n"/>, the <em>Walsh Transform</em> of <em>f</em> at <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> is the <em>n</em>-dimensional Discrete Fourier Transform and can be calculated as follows:</p>
<div class="math">
<p><img src="images/math/bbb2b68eedbc2de9b729a7ab0247a0e1412ff984.png" alt="\W_f(\vec{u}) = \walsh{\chi}_f(\vec{u}) = \W\{ \xi_f \} (\vec{u}) = \left\langle \xi_f, \xi_{l_{\vec{u}}} \right        \rangle = \sum_{\vec{x} \in \gf{V_n}} \chi_f(\vec{x})   \chi_{\vec{u}}(\vec{x})"/></p>
</div><p>or, as it is most often written as:</p>
<div class="math">
<p><img src="images/math/1b194811ad51cf960b7bd77f486734aaa9431729.png" alt="\W_f(\vec{u}) = \sum_{\vec{x} \in \gf{V_n}} (-1)^{f(\vec        {x}) + \vec{u} \cdot \vec{x}}"/></p>
</div><p>As a result, the Walsh Transform of <img class="math" src="images/math/74a88d4301d245a75908ffa09fa3b57b450baa06.png" alt="f \in \funct{F}_n"/> at <img class="math" src="images/math/1a6c1898d32eab11691ec80880b75abfe23fe906.png" alt="\vec{u}"/> is the coefficient of the sequence of <em>f</em> (<img class="math" src="images/math/3956bc41bc2b1c71819ea481829b4e57d4fde56a.png" alt="\xi_f"/>) with respect to the basis constituted by the sequences of linear functions, scaled by a factor of <img class="math" src="images/math/01c9030595f0e201ca3bbdc0433b4b92cb92d767.png" alt="\frac{1}{2^n}"/>. If <img class="math" src="images/math/357252f4e833dd5e6e6355d1501418f6985953fd.png" alt="\W_f"/> is the Walsh transform of <em>f</em>, we say that <img class="math" src="images/math/3956bc41bc2b1c71819ea481829b4e57d4fde56a.png" alt="\xi_f"/> and <img class="math" src="images/math/357252f4e833dd5e6e6355d1501418f6985953fd.png" alt="\W_f"/> form a Transform pair and write:</p>
<div class="math">
<p><img src="images/math/4f4978bd696eb33539508ed10cdbbe5eea50020b.png" alt="\begin{array}{rcl}
\xi_f&amp;\stackrel{W}{\longleftrightarrow}&amp;\W_f \ \ ( \xi_f \mbox{ corresponds to } \W_f )
\end{array}"/></p>
</div><p>The <em>Walsh Spectrum</em> of <em>f</em> can be represented by a matrix whose rows are indexed by <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> in lexicographic order, denoted by <img class="math" src="images/math/5b54e423084608c803f496d9f684deb5d9a72c43.png" alt="\matr{WS}(f) \in \matr{M}_{2^n \times 1}(\bbbr)"/> and defined as follows:</p>
<div class="math">
<p><img src="images/math/b0b608ee2d322adb2f7f261031ff6b546c7f06e4.png" alt="\matr{WS}(f) = \begin{bmatrix} \walsh{\chi}_f(\boldsymbol   {\alpha_0})&amp;\dots&amp;\walsh{\chi}_f(\vec{u})&amp;\dots&amp;\walsh  {\chi}_f(\boldsymbol{\alpha_{2^n-1}}) \end{bmatrix}^{T}"/></p>
</div><p>where <img class="math" src="images/math/8011f36cd4cfb9a17d8ffd4a51f16ff94044ee2f.png" alt="\walsh{\chi}_f(\vec{u})"/> is the value of the spectrum at <img class="math" src="images/math/1a6c1898d32eab11691ec80880b75abfe23fe906.png" alt="\vec{u}"/>. A Boolean function is uniquely determined by its Walsh Spectrum.</p>
<p>Let the vector Boolean function <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/>, the <em>Walsh Transform</em> of <em>F</em> is the two-dimensional Walsh Transform defined by:</p>
<div class="math">
<p><img src="images/math/863669eb0b94c03530ca0e10af59cb3e1c6e34b0.png" alt="\begin{array}{rcl}
\W_F(\vec{u}, \vec{v}) &amp;=&amp; \walsh{\theta}_F(\vec{u}, \vec{v}) = \W\{ \matr{Img(F)} \}(\vec{u}, \vec{v}) = \sum_{\vec{x} \in \gf{V_n}} \sum_{\vec{y} \in \gf{V_m}} \theta_F(\vec{x},\vec{y}) \chi_{(\vec{u},\vec{v})}(\vec{x},\vec{y})
\end{array}"/></p>
</div><p>or, as it is most often written as:</p>
<div class="math">
<p><img src="images/math/229f919cab944046e7b36eca1fba201c2c405d64.png" alt="\W_F(\vec{u}, \vec{v}) = \walsh{\theta}_F(\vec{u}, \vec{v}) = \sum_{\vec{x} \in \gf{V_n}} (-1)^{\vec{u} \cdot \vec{x} + \vec{v} \cdot F(\vec{x})}"/></p>
</div><p>The <em>Walsh Spectrum</em> of <em>F</em> can be represented by a matrix whose rows are indexed by <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> and whose columns are indexed by <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/> in lexicographic order, denoted by <img class="math" src="images/math/56b1bdb13dc48c5d340ae52aafd9d8192e16addc.png" alt="\matr{WS}(F) \in \matr{M}_{2^n \times 2^m}(\bbbr)"/> and defined as follows:</p>
<div class="math">
<p><img src="images/math/cd58e17d7a9fcfbf0779c64805eaca8c5dbf6243.png" alt="\matr{WS}(F) = \begin{bmatrix} \walsh{\theta}_F(\boldsymbol{\alpha_0},\boldsymbol{\alpha_0})&amp;\dots&amp;\walsh{\theta}_F(\boldsymbol{\alpha_0},\boldsymbol{\alpha_{2^m-1}}) \\
\walsh{\theta}_F(\boldsymbol{\alpha_1},\boldsymbol{\alpha_0})&amp;\dots&amp;\walsh{\theta}_F(\boldsymbol{\alpha_1},\boldsymbol{\alpha_{2^m-1}}) \\
\hdotsfor[2]{3}\\
\walsh{\theta}_F(\boldsymbol{\alpha_{2^n-1}},\boldsymbol{\alpha_0})&amp;\dots&amp;\walsh{\theta}_F(\boldsymbol{\alpha_{2^n-1}},\boldsymbol{\alpha_{2^m-1}}) \\
\end{bmatrix}"/></p>
</div><p>where <img class="math" src="images/math/46d94bacf84933f92648ead049f1cc30e5ea4ca3.png" alt="\walsh{\theta}_F(\vec{u},\vec{v})"/> is the value of the spectrum at <img class="math" src="images/math/bde043d0a0f41e905d5d4d0a3b4ced48362d3bd8.png" alt="(\vec{u},\vec{v})"/>.</p>
<p>We can deduce that the columns of this matrix are the spectra of the Boolean functions <img class="math" src="images/math/8fe77bff7cff74ae183ef2e803b91f8b1b4319f7.png" alt="l_{\vec{v}} \circ F"/> for all the linear functions <img class="math" src="images/math/e6ad483d6860e97bca4745cef45791f8c6c9aca7.png" alt="l_{\vec{v}} \in \funct{L}_m"/>.</p>
</div>
<div class="section" id="id17">
<h3><a class="toc-backref" href="#id65">Library</a><a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its Walsh Spectrum with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putwalsh</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">W</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain its representation as Walsh Spectrum the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">Walsh</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">W</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id18">
<h4>Example<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>The following program provides the Walsh Spectrum of a Vector Boolean function from its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Walsh Spectrum is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">Walsh</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Walsh Spectrum is:</span>
<span class="go">[[16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 -4 -4 0 0 -4 12 4 4 0 0 4 4 0 0]</span>
<span class="go">[0 0 -4 -4 0 0 -4 -4 0 0 4 4 0 0 -12 4]</span>
<span class="go">[0 0 0 0 0 0 0 0 4 -12 -4 -4 4 4 -4 -4]</span>
<span class="go">[0 4 0 -4 -4 -8 -4 0 0 -4 0 4 4 -8 4 0]</span>
<span class="go">[0 -4 -4 0 -4 0 8 4 -4 0 -8 4 0 -4 -4 0]</span>
<span class="go">[0 4 -4 8 4 0 0 4 0 -4 4 8 -4 0 0 -4]</span>
<span class="go">[0 -4 0 4 4 -8 4 0 -4 0 4 0 8 4 0 4]</span>
<span class="go">[0 0 0 0 0 0 0 0 -4 4 4 -4 4 -4 -4 -12]</span>
<span class="go">[0 0 -4 -4 0 0 -4 -4 -8 0 -4 4 0 8 4 -4]</span>
<span class="go">[0 8 -4 4 -8 0 4 -4 4 4 0 0 4 4 0 0]</span>
<span class="go">[0 8 0 -8 8 0 8 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 -4 8 -4 -4 0 4 0 4 0 4 8 0 4 0 -4]</span>
<span class="go">[0 4 4 0 -4 8 0 4 -8 -4 4 0 4 0 0 4]</span>
<span class="go">[0 4 4 0 -4 -8 0 4 -4 0 0 -4 -8 4 -4 0]</span>
<span class="go">[0 -4 -8 -4 -4 0 4 0 0 -4 8 -4 -4 0 4 0]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>We can see that the Walsh Spectrum of <img class="math" src="images/math/918c8aa77c2fccdd71699522c32129fecbb0a2fa.png" alt="f_1(NibbleSub)"/> where</p>
<div class="math">
<p><img src="images/math/0ac4140c2696885474e00be8b9fc0b87de57eb51.png" alt="NibbleSub=(f_1(NibbleSub),f_2(NibbleSub),f_3(NibbleSub),f_4(NibbleSub))"/></p>
</div><p>corresponds to the Spectrum of <img class="math" src="images/math/66239dd460dbc218f4d159362959817ed79da895.png" alt="l_{(1,0,0,0)} \circ NibbleSub"/>. As a consequence, the Walsh Spectrum of <img class="math" src="images/math/918c8aa77c2fccdd71699522c32129fecbb0a2fa.png" alt="f_1(NibbleSub)"/> coincides with the <em>9</em>-th column of <img class="math" src="images/math/b8dd4ee6129767841dde3f9f99b57c77f47c5e2c.png" alt="\matr{WS}(NibbleSub)"/>, that is, the column indexed by the vector <img class="math" src="images/math/ea4988e6dad1e15edab2ff2e9ec096317b50790f.png" alt="(1,0,0,0)"/>.</p>
</div>
</div>
</div>
<div class="section" id="linear-profile">
<h2><a class="toc-backref" href="#id66">Linear Profile</a><a class="headerlink" href="#linear-profile" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id19">
<h3><a class="toc-backref" href="#id67">Description</a><a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h3>
<div class="section" id="overview-of-linear-cryptanalysis">
<h4>Overview of Linear Cryptanalysis<a class="headerlink" href="#overview-of-linear-cryptanalysis" title="Permalink to this headline">¶</a></h4>
<p>A complete enumeration of all linear approximations of the S-box is given in the <em>Linear Profile</em> (In the literature, an equivalent matrix called Linear Approximation Table is used as well), which is a matrix whose rows are indexed by <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> and whose columns are indexed by <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/> in lexicographic order, denoted by <img class="math" src="images/math/72454ee6f5c816510f97abbe59acba4ddcef7cc9.png" alt="\matr{LP}(F) \in \matr{M}_{2^n \times 2^m}(\bbbr)"/>. It holds that <img class="math" src="images/math/492a43362f3325feb166fd3acf883f03e3ad1cf3.png" alt="\matr{LP}(F)(\vec{u},\vec{v}) =|\matr{WS}(F)(\vec{u},\vec{v})|^2"/>. The lower bound of the Linear Profile values is <em>0</em> and the upper bound is <img class="math" src="images/math/1af88eaa5f7d2e67634e9ea17488b34d89ee89dd.png" alt="2^{2n}"/>.</p>
<p>If we divide each element in the Linear Profile by the value on <img class="math" src="images/math/450e4df12d4ef35d661038b796f8809935eb6572.png" alt="\matr{LP}(F)(\vec{0},\vec{0})"/>, these values represent the number of matches between the linear equation represented in hexadecimal as &#8220;Input Sum&#8221; and the sum of the output bits represented in hexadecimal as &#8220;Output Sum&#8221;. Hence, subtracting to these values <img class="math" src="images/math/01df72481ee6b50bc2f19ba0580ae112eb261ee5.png" alt="\frac{1}{2}"/> give the probability bias for the particular linear combination of input and output bits. The hexadecimal value representing a sum, when viewed as a binary value indicates the variables involved in the sum. For a linear combination of input variables represented as <img class="math" src="images/math/ec1f983ceae40c72fbe24a42ddc3472bc80a56d7.png" alt="u_1 \cdot x_1+ \cdots +u_n \cdot x_n"/> where <img class="math" src="images/math/d7ae4f145b20ba60ae61493d31ac2282a0c525dc.png" alt="u_i \in \gf{GF(2)}"/>, the hexadecimal value represents the binary value <img class="math" src="images/math/f17707d7d18acbc093ca0ed3178f5271b6ce4212.png" alt="u_1 \ldots u_n"/>, where <img class="math" src="images/math/26285b7175c0503d39437e45b81f330a6070b82f.png" alt="u_1"/> is the most significant bit. Similarly, for a linear combination of output bits <img class="math" src="images/math/f9c69764541537774baa122265da83a337b786ab.png" alt="v_1 \cdot y_1+ \cdots +v_m \cdot y_m"/> where <img class="math" src="images/math/075d9557bf9a8dcc062c998b1e3150200dce9dc8.png" alt="v_i \in \gf{GF(2)}"/>, the hexadecimal value represents the binary vector <img class="math" src="images/math/6c8bf69aabd9f9dce2603bf6acedd73ff347f27b.png" alt="v_1 \ldots v_m"/>.</p>
<p>In Linear Profiles, we are looking for entries with large value. If all of the entries are small, then the S-box does not have a very linear structure, and it may make Linear Cryptanalysis on the cipher difficult. The <em>Linear potential</em> of <em>F</em>, defined as <img class="math" src="images/math/feb46c889cb204d1549df5bf792098c74dff901d.png" alt="\crit{lp}(F) = \frac{1}{2^{2n}} \cdot \stackrel{*}{\max} \left( {\matr{WS}(F)(\vec{u},\vec{v})}^2 \right)"/> is a measure of linearity in Linear Cryptanalysis, and satisfies <img class="math" src="images/math/da2c0abb93edee6123f99cba88d1766a3ddc4757.png" alt="2^{-n} \leq \crit{lp}(F) \leq 1"/> so that the lower bound holds if and only if <em>F</em> has maximum nonlinearity (<em>F</em> is bent) and the upper bound is reached when <em>F</em> is linear or affine. This criterion can take values from <img class="math" src="images/math/01c9030595f0e201ca3bbdc0433b4b92cb92d767.png" alt="\frac{1}{2^n}"/> to 1. The larger <img class="math" src="images/math/04f62a2429149460254866186c1e12613c61c8a1.png" alt="\crit{lp}(F)"/> is, the &#8220;closer&#8221; to a Linear Vector Boolean function is <em>F</em>.</p>
</div>
</div>
<div class="section" id="id20">
<h3><a class="toc-backref" href="#id68">Library</a><a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h3>
<p>Note that the Linear Profile does not uniquely determine a Vector Boolean function. Thus, a VBF class cannot be initialized by its Linear Profile. To obtain its representation as Linear Profile, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">LAT</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">LP</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>In the VBF library, several methods have been defined in order to analyse the feasibility of Linear Cryptanalysis: Linear potential and Linear relations associated with a specific value of the Linear Profile. The method used to obtain the linear potential is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">lp</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">RR</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>If we want to obtain the linear expressions associated with the value of the Linear Profile &#8220;w&#8221;, we will use this method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">linear</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="n">ZZ</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<p>If we want to obtain the probability bias <img class="math" src="images/math/0e6c3f5d7ab4dd4a72edfbce9108c2f9045fc71a.png" alt="|p_L-\frac{1}{2}|"/> that a linear expression holds with the value of the Linear Profile &#8220;w&#8221;, we will use this method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">ProbLin</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">RR</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="n">NTL</span><span class="o">::</span><span class="n">ZZ</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id21">
<h4>Example<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>The following program finds out the Linear Profile of a Vector Boolean function together with the linear expressions that have the highest value, except from the value in <img class="math" src="images/math/450e4df12d4ef35d661038b796f8809935eb6572.png" alt="\matr{LP}(F)(\vec{0},\vec{0})"/>, their probability, this highest value and the linear potential.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
  <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

  <span class="n">VBF</span>     <span class="n">F</span><span class="p">;</span>
  <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
  <span class="n">NTL</span><span class="o">::</span><span class="n">ZZ</span>   <span class="n">w</span><span class="p">;</span>
  <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span>   <span class="n">bias</span><span class="p">;</span>

  <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
  <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
   <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
  <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
  <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Linear Profile is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">LAT</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="n">w</span> <span class="o">=</span> <span class="n">maxLAT</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The highest value of the Linear Profile is= &quot;</span>
  <span class="o">&lt;&lt;</span> <span class="n">w</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The linear expressions that have the highest value are:&quot;</span>
  <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">linear</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>

  <span class="n">ProbLin</span><span class="p">(</span><span class="n">bias</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;These expressions hold with probability bias= &quot;</span>
  <span class="o">&lt;&lt;</span> <span class="n">bias</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The linear potential is= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">lp</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

  <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Linear Profile is:</span>
<span class="go">[[256 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 16 16 0 0 16 144 16 16 0 0 16 16 0 0]</span>
<span class="go">[0 0 16 16 0 0 16 16 0 0 16 16 0 0 144 16]</span>
<span class="go">[0 0 0 0 0 0 0 0 16 144 16 16 16 16 16 16]</span>
<span class="go">[0 16 0 16 16 64 16 0 0 16 0 16 16 64 16 0]</span>
<span class="go">[0 16 16 0 16 0 64 16 16 0 64 16 0 16 16 0]</span>
<span class="go">[0 16 16 64 16 0 0 16 0 16 16 64 16 0 0 16]</span>
<span class="go">[0 16 0 16 16 64 16 0 16 0 16 0 64 16 0 16]</span>
<span class="go">[0 0 0 0 0 0 0 0 16 16 16 16 16 16 16 144]</span>
<span class="go">[0 0 16 16 0 0 16 16 64 0 16 16 0 64 16 16]</span>
<span class="go">[0 64 16 16 64 0 16 16 16 16 0 0 16 16 0 0]</span>
<span class="go">[0 64 0 64 64 0 64 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 16 64 16 16 0 16 0 16 0 16 64 0 16 0 16]</span>
<span class="go">[0 16 16 0 16 64 0 16 64 16 16 0 16 0 0 16]</span>
<span class="go">[0 16 16 0 16 64 0 16 16 0 0 16 64 16 16 0]</span>
<span class="go">[0 16 64 16 16 0 16 0 0 16 64 16 16 0 16 0]</span>
<span class="go">]</span>

<span class="go">The highest value of the Linear Profile is= 144</span>

<span class="go">The linear expressions that have the highest value are:</span>
<span class="go">x4=y2+y3+y4</span>
<span class="go">x3=y1+y2+y3</span>
<span class="go">x3+x4=y1+y4</span>
<span class="go">x1=y1+y2+y3+y4</span>

<span class="go">These expressions hold with probability bias= 0.0625</span>

<span class="go">The linear potential is= 0.5625</span>
</pre></div>
</div>
<p>The figure represents the Linear Profile of <em>NibbleSub</em> and emphasizes in red the elements which achieve the highest value.</p>
<a class="reference internal image-reference" href="images/LP.png"><img alt="images/LP.png" class="align-center" src="images/LP.png" style="width: 750px;" /></a>
</div>
</div>
</div>
<div class="section" id="differential-profile">
<h2><a class="toc-backref" href="#id69">Differential Profile</a><a class="headerlink" href="#differential-profile" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id22">
<h3><a class="toc-backref" href="#id70">Description</a><a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h3>
<p>The first step of Differential Cryptanalysis is to compute the characteristics of inputs and the outputs of the S-boxes, which we will then combine together to form a characteristic for the complete cipher. Consider a <img class="math" src="images/math/b5ed9eeee5f84041f3948f1eb1b4385832706f8c.png" alt="n \times m"/> S-box with input <img class="math" src="images/math/227491a6063a1ff941eef98da6368606ba2ec452.png" alt="\vec{x} = (x_1, \ldots, x_n)"/> and output <img class="math" src="images/math/49c8d8eac2f748458c44dcd8555d8f8f18c9bb73.png" alt="\vec{y} = (y_1,\ldots,y_m)"/>. All difference pairs of an S-box, <img class="math" src="images/math/3ec8ff39149a214f5de3e7e60277865acd13e093.png" alt="(\Delta \vec{x}, \Delta \vec{y})"/>, can be examined and the probability of <img class="math" src="images/math/3e52e75109f778aa34ae7be337b1e061466f7092.png" alt="\Delta \vec{y}"/> given <img class="math" src="images/math/7e177a032c100f921e03e71a8f40682633a66730.png" alt="\Delta \vec{x}"/> can be derived by considering input pairs <img class="math" src="images/math/d3ecd822702cc4954230155a060495f3af8890f3.png" alt="(\vec{x}^{'},\vec{x}^{''})"/> such that <img class="math" src="images/math/3127c9a672eeeee41642b8ce8e4c7fab1b75d60a.png" alt="\vec{x}^{'}+\vec{x}^{''} = \Delta \vec{x}"/>. Since the ordering of the pair is not relevant, for a <img class="math" src="images/math/b5ed9eeee5f84041f3948f1eb1b4385832706f8c.png" alt="n \times m"/> S-box we need only consider all <img class="math" src="images/math/372fc4dd1270e8bd966735a2567c798ab49d57c8.png" alt="2^n"/> values for <img class="math" src="images/math/16b263c5fe488903616d8833840c949a7a36d981.png" alt="\vec{x}^{'}"/> and then the value of <img class="math" src="images/math/7e177a032c100f921e03e71a8f40682633a66730.png" alt="\Delta \vec{x}"/> constrains the value of <img class="math" src="images/math/4ce0c1831ace5f6efb3327bd265ba1d12d664615.png" alt="\vec{x}^{''}"/> to be <img class="math" src="images/math/6a2c048d00801f5f3e6366aa94633526bb7673ff.png" alt="\vec{x}^{''} = \vec{x}^{'}+\Delta \vec{x}"/>. We can derive the resulting values of <img class="math" src="images/math/3e52e75109f778aa34ae7be337b1e061466f7092.png" alt="\Delta \vec{y}"/> for each input pair <img class="math" src="images/math/49273b6130ae7c925c1d3112b382116ef21e6328.png" alt="(\vec{x}^{'}, \vec{x}^{''} = \vec{x}^{'}+\Delta \vec{x})"/>.</p>
<p>We can tabulate the complete differential data for an S-box in the <em>Differential Profile</em> (In the literature, an equivalent matrix called Difference Distribution Table is used as well), which the rows represent <img class="math" src="images/math/7e177a032c100f921e03e71a8f40682633a66730.png" alt="\Delta \vec{x}"/> values and the columns represent <img class="math" src="images/math/3e52e75109f778aa34ae7be337b1e061466f7092.png" alt="\Delta \vec{y}"/> values.</p>
<p>If we divide each element in the Differential Profile by the value on <img class="math" src="images/math/daafa0f16c2f72b726ab4765ece7a5bf560518aa.png" alt="\matr{DP}(F)(\vec{0},\vec{0})"/>, these values represent the probability of the corresponding output difference <img class="math" src="images/math/3e52e75109f778aa34ae7be337b1e061466f7092.png" alt="\Delta \vec{y}"/> value given the input difference <img class="math" src="images/math/7e177a032c100f921e03e71a8f40682633a66730.png" alt="\Delta \vec{x}"/>, that is <img class="math" src="images/math/a3befb3b1dc7b9834b287fd7433ed9f17d0bf214.png" alt="(\Delta \vec{x} \Rightarrow \Delta \vec{y})"/>, called <em>characteristic</em>. In general, entries in the Differential Profile with fewer bits set in the <img class="math" src="images/math/7e177a032c100f921e03e71a8f40682633a66730.png" alt="\Delta \vec{x}"/> and <img class="math" src="images/math/3e52e75109f778aa34ae7be337b1e061466f7092.png" alt="\Delta \vec{y}"/> that have higher probability are desirable.</p>
<p>Let <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/>, if we denote by <img class="math" src="images/math/7d0d547a51ae130764925136a04335c16f9c5a00.png" alt="D_F(\vec{u},\vec{v})"/> the set of vectors where the difference Vector Boolean Function of <em>F</em> in the direction of <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> coincides with <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/> by:</p>
<div class="math">
<p><img src="images/math/1542b6f3d849630ec4f259a59d36a82c1add415f.png" alt="D_F(\vec{u},\vec{v}) = \left\{\vec{x} \in \gf{V_n} \given \Delta_{\vec{u}}F(\vec{x}) = \vec{v} \right\}"/></p>
</div><p>Let <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> where <img class="math" src="images/math/7cf0ee1d1dd72147c42020a13fb60d7c00ba5ad3.png" alt="n \geq m"/>. The matrix containing all possible values of <img class="math" src="images/math/bc642595e0c1a0612110f80f56eb1a356bfe673b.png" alt="\#D_F(\vec{u},\vec{v})"/> is referred to as its <em>XOR or Differential Distribution Table</em>.</p>
<p>Nyberg in <a class="reference internal" href="bibliography.html#nyberg-93" id="id23">[Nyberg:93]</a> introduced the concept of <em>differential uniformity</em> as a measure of the resistance to differential crytanalysis as follows:</p>
<p>A Vector Boolean function <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> is called differentially <img class="math" src="images/math/f16e64e5995eb25ccbd9f671c10ab34c42aa3692.png" alt="\crit{du}(F)"/>-uniform if for all <img class="math" src="images/math/0e9b02c925a685766759a4b9353f239d8f7eb328.png" alt="\vec{u} \neq \vec{0} \in \gf{V_n}"/> and <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/>:</p>
<div class="math">
<p><img src="images/math/33b098708393ecad934fb4c2c7368363c6ff776e.png" alt="\# \left\{ \vec{x} \in \gf{V_n} \given F(\vec{x} + \vec{u}) + F(\vec{x}) = \vec{v} \right\} \leq \crit{du}(F)"/></p>
</div><p>Let <img class="math" src="images/math/f16e64e5995eb25ccbd9f671c10ab34c42aa3692.png" alt="\crit{du}(F)"/> (differential uniformity of <em>F</em>) is the largest value in Differential Distribution Table of <em>F</em> (not counting the first entry in the first row), namely,</p>
<div class="math">
<p><img src="images/math/e5b8b3c8bb413a74165ba9487b3ad969c5ecbcd3.png" alt="\crit{du}(F) = \max_{(\vec{u},\vec{v}) \neq (\vec{0},\vec{0})} \#D_F(\vec{u},\vec{v}) = \max_{(\vec{u},\vec{v}) \neq (\vec{0},\vec{0})} \#\left\{ \vec{x} \in \gf{V_n} \given F(\vec{x}) + F(\vec{x}+\vec{u}) = \vec{v} \right\}"/></p>
</div><p>Let define the function <img class="math" src="images/math/d86f1ae0e2966481c620061483d07295b0df1ba8.png" alt="\delta_F : \gf{V_n} \times \gf{V_m} \to \bbbq"/> as: <img class="math" src="images/math/2dba1947371d32d9aad08a276fd8ea0070643af0.png" alt="\delta_F(\vec{u},\vec{v}) = \frac{1}{2^n} \#D_F(\vec{u},\vec{v})"/>.</p>
<p>The <em>Differential Profile</em> of <em>F</em> can be represented by a matrix whose rows are indexed by <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> and whose columns are indexed by <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/> in lexicographic order, denoted by <img class="math" src="images/math/938fa7985f240a2ca3105295aa03ef6ad631d00e.png" alt="\matr{DP}(F) \in \matr{M}_{2^n \times 2^m}(R)"/> and defined as follows:</p>
<div class="math">
<p><img src="images/math/4a2aac949cea9a61ff68a72fcdb5fc0dfe9b0abd.png" alt="\matr{DP}(F) = 2^{2n+m} \begin{bmatrix}
\delta_F(\boldsymbol{\alpha_0},\boldsymbol{\alpha_0})&amp;\dots&amp;\delta_F(\boldsymbol{\alpha_0},\boldsymbol{\alpha_{2^m-1}}) \\
\delta_F(\boldsymbol{\alpha_1},\boldsymbol{\alpha_0})&amp;\dots&amp;\delta_F(\boldsymbol{\alpha_1},\boldsymbol{\alpha_{2^m-1}}) \\
\hdotsfor[2]{3} \\
\delta_F(\boldsymbol{\alpha_{2^n-1}},\boldsymbol{\alpha_0})&amp;\dots&amp;\delta_F(\boldsymbol{\alpha_{2^n-1}},\boldsymbol{\alpha_{2^m-1}})
\end{bmatrix}"/></p>
</div><p>The maximum value of <img class="math" src="images/math/053b3a2c306006c656222393722bc3b9702f4696.png" alt="\delta_F(\vec{u},\vec{v})"/> is called the <em>differential potential</em> of <em>F</em>:</p>
<div class="math">
<p><img src="images/math/9bd3a9fe1270678022356f1ad1373f9641e33325.png" alt="\crit{dp}(F) =\max \left\{ \delta_F(\vec{u},\vec{v}) \given \fa \vec{u} \in \gf{V_n}, \vec{v} \in \gf{V_m}, (\vec{u},\vec{v}) \neq (\vec{0},\vec{0}) \right\}"/></p>
</div><p>The differential uniformity of <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> and its differential potential are related as: <img class="math" src="images/math/f51e161e58cf1512856e0adce2b80e4299239494.png" alt="\crit{dp}(F) = \frac{1}{2^n} \crit{du}(F)"/>.</p>
<p>It is a measure of the robustness against differential cryptanalysis where <img class="math" src="images/math/7e2f478c985ffe2089790d76eefcd9c45a061661.png" alt="2^{-m} \leq \crit{dp}(F) \leq 1"/> and the lower bound holds if and only if <em>F</em> is bent and the upper bound is reached when <em>F</em> is linear or affine.  The differential uniformity of <img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> and its differential potential are related by <img class="math" src="images/math/a074a88850cb4c8a6375167f1158420b79626925.png" alt="\crit{dp}(F) = 2^{-n} \crit{du}(F)"/>.</p>
</div>
<div class="section" id="id24">
<h3><a class="toc-backref" href="#id71">Library</a><a class="headerlink" href="#id24" title="Permalink to this headline">¶</a></h3>
<p>Note that the Differential Profile does not uniquely determine a Vector Boolean function. Thus, a VBF class cannot be initialized by its Differential Profile. To obtain its representation as Differential Profile, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">DAT</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">DP</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>In the VBF library, several methods have been defined in order to analyse the feasibility of differential cryptanalysis: Differential potential and Differential relations associated with a specific value of the Differential profile. The method used to obtain the differential potential is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">dp</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">RR</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>If we want to obtain the characteristics associated with the value of the Differential Profile &#8220;w&#8221;, we will use this method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">differential</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="n">ZZ</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<p>If we want to obtain the probability that a characteristic <img class="math" src="images/math/a3befb3b1dc7b9834b287fd7433ed9f17d0bf214.png" alt="(\Delta \vec{x} \Rightarrow \Delta \vec{y})"/> holds with the value of the Differential Profile &#8220;w&#8221;, we will use this method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">ProbDif</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">RR</span><span class="o">&amp;</span> <span class="n">x</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">a</span><span class="p">,</span> <span class="n">NTL</span><span class="o">::</span><span class="n">ZZ</span><span class="o">&amp;</span> <span class="n">w</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id25">
<h4>Example<a class="headerlink" href="#id25" title="Permalink to this headline">¶</a></h4>
<p>The following program finds out the Differential Profile of a Vector Boolean function together with the characteristics that have the highest value, except from the value in <img class="math" src="images/math/daafa0f16c2f72b726ab4765ece7a5bf560518aa.png" alt="\matr{DP}(F)(\vec{0},\vec{0})"/>, their probability, this highest value and the differential potential.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">ZZ</span>      <span class="n">w</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">RR</span>      <span class="n">p</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Differential Profile is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">DAT</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">w</span> <span class="o">=</span> <span class="n">maxDAT</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The highest value of the Differential Profile is= &quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">w</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The characteristics that have the highest value are:&quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">differential</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>

   <span class="n">ProbDif</span><span class="p">(</span><span class="n">p</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">w</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;These expressions hold with probability= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">p</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The differential potential is= &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">dp</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Differential Profile is:</span>
<span class="go">[[4096 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 512 0 0 0 512 0 512 1024 0 1024 512 0 0]</span>
<span class="go">[0 0 0 512 0 1536 512 512 0 512 0 0 0 0 512 0]</span>
<span class="go">[0 0 512 0 512 0 0 0 0 1024 512 0 512 0 0 1024]</span>
<span class="go">[0 0 0 512 0 0 1536 0 0 512 0 1024 512 0 0 0]</span>
<span class="go">[0 1024 0 0 0 512 512 0 0 0 1024 0 512 0 0 512]</span>
<span class="go">[0 0 0 1024 0 1024 0 0 0 0 0 0 512 512 512 512]</span>
<span class="go">[0 0 512 512 512 0 512 0 0 512 512 0 0 0 0 1024]</span>
<span class="go">[0 0 0 0 0 0 512 512 0 0 0 1024 0 1024 512 512]</span>
<span class="go">[0 512 0 0 512 0 0 1024 512 0 512 512 512 0 0 0]</span>
<span class="go">[0 512 512 0 0 0 0 0 1536 0 0 512 0 0 1024 0]</span>
<span class="go">[0 0 2048 0 0 512 0 512 0 0 0 0 0 512 0 512]</span>
<span class="go">[0 512 0 0 512 512 512 0 0 0 0 512 0 1536 0 0]</span>
<span class="go">[0 1024 0 0 0 0 0 1024 512 0 512 0 512 0 512 0]</span>
<span class="go">[0 0 512 1024 512 0 0 0 1536 0 0 0 0 0 512 0]</span>
<span class="go">[0 512 0 0 1536 0 0 0 0 1024 0 512 0 0 512 0]</span>
<span class="go">]</span>

<span class="go">The highest value of the Differential Profile is= 2048</span>

<span class="go">The characteristics that have the highest value are:</span>
<span class="go">[1 0 1 1]-&gt;[0 0 1 0]</span>

<span class="go">These expressions hold with probability= 0.5</span>

<span class="go">The differential potential is= 0.5</span>
</pre></div>
</div>
<p>The figure represents the Differential Profile of <em>NibbleSub</em> and emphasizes in blue the elements which achieve the highest value.</p>
<a class="reference internal image-reference" href="images/DP.png"><img alt="images/DP.png" class="align-center" src="images/DP.png" style="width: 750px;" /></a>
</div>
</div>
</div>
<div class="section" id="autocorrelation-spectrum">
<h2><a class="toc-backref" href="#id72">Autocorrelation Spectrum</a><a class="headerlink" href="#autocorrelation-spectrum" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id26">
<h3><a class="toc-backref" href="#id73">Description</a><a class="headerlink" href="#id26" title="Permalink to this headline">¶</a></h3>
<p>The Autocorrelation provides a useful description of a Vector Boolean function in relation to some cryptographic criteria. It is derived from the sequences of the component functions of the Vector Boolean function and does not uniquely determine the Vector Boolean function itself.</p>
<p>The <em>directional derivative</em> of <img class="math" src="images/math/74a88d4301d245a75908ffa09fa3b57b450baa06.png" alt="f \in \funct{F}_n"/> in the direction of <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> is defined as <img class="math" src="images/math/8828a0c3c359eddd715fa4f30bf84bdf52f986dd.png" alt="\Delta_{\vec{u}}f(\vec{x}) = f(\vec{x}+\vec{u}) + f(\vec{x}), \  \  \vec{x} \in \gf{V_n}"/>.</p>
<p>Similarly, the <em>directional derivative</em> of the sequence of a Boolean function <img class="math" src="images/math/3956bc41bc2b1c71819ea481829b4e57d4fde56a.png" alt="\xi_f"/> in the direction of <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> is defined as: <img class="math" src="images/math/e79d0c44033719c93e205ad1f5942ca0699b13de.png" alt="\Delta_{\vec{u}} \chi_f(\vec{x}) = \chi_f(\vec{x}+\vec{u}) \cdot \chi_f(\vec{x}), \  \  \vec{x} \in \gf{V_n}"/>.</p>
<p>The <em>autocorrelation</em> of <img class="math" src="images/math/74a88d4301d245a75908ffa09fa3b57b450baa06.png" alt="f \in \funct{F}_n"/> with respect to the shift <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/>, <img class="math" src="images/math/35fc3242fc5cea254ef084b36dd947275010c210.png" alt="\R_{f}(\vec{u})"/>, is defined by the Polarity Truth Table to be:</p>
<div class="math">
<p><img src="images/math/d4733c6586512aa7ad379c121794e34b327a7fbd.png" alt="\R_f(\vec{u}) = \sum_{\vec{x} \in \gf{V_n}} \chi_f(\vec{x})
\chi_f(\vec{x}+\vec{u})"/></p>
</div><p>From this definition of the autocorrelation function we note two important properties:</p>
<ul class="simple">
<li>For every Boolean function <img class="math" src="images/math/d7fe2aa8df420f634094bf8a4fbbfefbc933ddea.png" alt="\R_f(\vec{0})=2^n"/>, since <img class="math" src="images/math/69cc5d123ba39f6951ba58b52c5a0cd8bbd765d9.png" alt="\left(\chi_f(\vec{x}) \right)^2 = 1 \ \fa \vec{x} \in \gf{V_n}"/>.</li>
<li>The value of <img class="math" src="images/math/fa2c0ced20eb4bf36f1e4aab389df8a3dab956c7.png" alt="\R_f(\vec{u})"/> when <img class="math" src="images/math/cea5bc9c71b93e98a4e766ca653f56f36b6433f2.png" alt="\vec{u} \neq \vec{0}"/> must be proportional to the correlation between <img class="math" src="images/math/5737e70e74330713755d6427be6b174b546f8016.png" alt="f(\vec{x}+\vec{u})"/> and <img class="math" src="images/math/54694b09d48af5442a1c8c3dfda9329a3e8ac9c0.png" alt="f(\vec{x})"/>, i.e.: <img class="math" src="images/math/6a6bd9317e7ccc2fb6f033d8e32b612af56a345c.png" alt="\R_f(\vec{u}) = 2^n \cdot \Cor \left(f(\vec{x}+\vec{u}),f(\vec{x}) \right)"/>.</li>
</ul>
<p>The Aucorrelation Spectrum gives an indication of the imbalance of all first order derivatives of the component functions of a Vector Boolean function. As differential cryptanalysis exploits imbalanced derivatives of Vector Boolean functions, the Aucorrelation Spectrum is vital in the analysis.</p>
</div>
<div class="section" id="linear-structures">
<h3><a class="toc-backref" href="#id74">Linear structures</a><a class="headerlink" href="#linear-structures" title="Permalink to this headline">¶</a></h3>
<p>If the <em>directional derivative</em> of <img class="math" src="images/math/74a88d4301d245a75908ffa09fa3b57b450baa06.png" alt="f \in \funct{F}_n"/> in the direction of <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/>: <img class="math" src="images/math/1eed6691ad85449f69c50377359ed5dc51fb290d.png" alt="\Delta_{\vec{u}}f(\vec{x}) = f(\vec{x}+\vec{u}) + f(\vec{x})"/> is a constant function, then <img class="math" src="images/math/1a6c1898d32eab11691ec80880b75abfe23fe906.png" alt="\vec{u}"/> is a <em>linear structure</em> of <img class="math" src="images/math/2a426db098eedef98034e4420b75ae437f57d191.png" alt="f"/> <a class="reference internal" href="bibliography.html#lai-95" id="id27">[Lai:95]</a> <a class="reference internal" href="bibliography.html#chaum-e85" id="id28">[Chaum:E85]</a>. The zero vector <img class="math" src="images/math/357d88ee8a474fafd1a70ba8e97bcb713bda667b.png" alt="\vec{0}"/> is a trivial linear structure since <img class="math" src="images/math/f6e755c66dd324584c177faa7a1ba7def3ea1a2f.png" alt="\Delta_{\vec{0}}f(\vec{x}) = 0 \ \ \fa \vec{x} \in \gf{V_n}"/>. From the point of view of autocorrelation, a vector in <img class="math" src="images/math/358b25c3571d4783e5d1120ede7efe9c6a4557aa.png" alt="\gf{V_n}"/> is a linear structure if it satisfies the following:</p>
<p>The vector <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> is a linear structure of <img class="math" src="images/math/2a426db098eedef98034e4420b75ae437f57d191.png" alt="f"/> if and only if <img class="math" src="images/math/63c9058a564d5956d959700890d9a39e60da8e42.png" alt="|\R_f(\vec{u})|= 2^n"/>.</p>
<p>The notion of linear structures can be extended for the case of Vector Boolean functions. The definition of a Vector Boolean function that has a linear structure was originally proposed by Chaum <a class="reference internal" href="bibliography.html#chaum-e85" id="id29">[Chaum:E85]</a> and Evertse <a class="reference internal" href="bibliography.html#evertse-87" id="id30">[Evertse:87]</a>. They defined that a Vector Boolean function <em>F</em> has a linear structure by considering the existence of nontrivial linear structure in any of the component functions of <em>F</em>.</p>
<p><img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> is said to have a linear structure if there exists a nonzero vector <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> together with a nonzero vector <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/> such that <img class="math" src="images/math/37145b0b9d16785ceaf2e05751e34913a620a54c.png" alt="\vec{v} \cdot F(\vec{x}) + \vec{v} \cdot F(\vec{x}+ \vec{u})"/> takes the same value <img class="math" src="images/math/5c51c77fff6e887fe6646c38afbe89649b7f97ad.png" alt="c \in \gf{GF(2)} \ \ \fa \vec{x} \in \gf{V_n}"/>.</p>
<p><img class="math" src="images/math/5540a3041be53b05c513f03c131ad45ad3e8996d.png" alt="F \in \funct{F}_{n,m}"/> is said to have a linear structure if there exists a nonzero vector <img class="math" src="images/math/fd52e16c218f8700374176f9666f799c29eba3ec.png" alt="\vec{u} \in \gf{V_n}"/> together with a nonzero vector <img class="math" src="images/math/578c9880e2c9877d8850a212cb95b563ce99d607.png" alt="\vec{v} \in \gf{V_m}"/> such that <img class="math" src="images/math/6fa46ecd93b63c4151d2d22b3caa498aab0b2046.png" alt="|\R_{\vec{v} \cdot F}(\vec{u})|= 2^n"/>.</p>
<p>Nonlinear cryptographic functions used in block ciphers should have no nonzero linear structures <a class="reference internal" href="bibliography.html#evertse-87" id="id31">[Evertse:87]</a>. The existence of nonzero linear structures, for the functions implemented in stream ciphers, is a potential risk that should also be avoided, despite the fact that such existence could not be used in attacks, so far.</p>
</div>
<div class="section" id="id32">
<h3><a class="toc-backref" href="#id75">Library</a><a class="headerlink" href="#id32" title="Permalink to this headline">¶</a></h3>
<p>To obtain its representation as Autocorrelation Spectrum, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">AC</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">R</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>The method used to obtain the linear structures is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">LS</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id33">
<h4>Example<a class="headerlink" href="#id33" title="Permalink to this headline">¶</a></h4>
<p>The following program finds out the Autocorrelation Spectrum of a Vector Boolean function together with its linear structures having as input its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Autocorrelation Spectrum is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">AC</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The linear structures are: &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">LS</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Autocorrelation Spectrum is:</span>
<span class="go">[[16 16 16 16 16 16 16 16 16 16 16 16 16 16 16 16]</span>
<span class="go">[16 0 0 0 0 0 -8 -8 -8 -8 -8 8 0 0 8 8]</span>
<span class="go">[16 -8 0 -8 -8 0 0 8 8 -8 0 0 -8 8 -8 8]</span>
<span class="go">[16 0 0 0 0 0 0 -16 -8 8 0 0 0 0 -8 8]</span>
<span class="go">[16 0 -8 0 0 -16 0 8 0 8 -8 -8 -8 0 8 8]</span>
<span class="go">[16 0 0 -8 0 0 0 -8 0 -8 8 -8 0 -8 8 8]</span>
<span class="go">[16 -8 0 0 -8 0 -8 8 0 -8 0 0 8 0 -8 8]</span>
<span class="go">[16 0 -8 0 0 0 0 -8 0 8 0 0 0 -8 -8 8]</span>
<span class="go">[16 -8 -8 0 -8 0 0 8 -8 8 0 0 0 0 8 -8]</span>
<span class="go">[16 0 0 8 0 0 0 -8 0 -8 0 0 -8 0 8 -8]</span>
<span class="go">[16 8 0 0 8 0 8 8 -8 -8 0 -8 0 0 -8 -16]</span>
<span class="go">[16 0 -8 -8 0 16 -8 -8 8 8 -8 -8 8 8 -8 -8]</span>
<span class="go">[16 -8 8 -8 -8 0 -8 8 0 8 0 0 0 -8 8 -8]</span>
<span class="go">[16 0 0 0 0 0 8 -8 0 -16 0 0 0 0 8 -8]</span>
<span class="go">[16 8 0 8 8 0 0 8 0 -8 -8 0 0 -8 -16 -8]</span>
<span class="go">[16 0 8 0 0 -16 0 -8 0 8 8 8 -8 0 -8 -8]</span>
<span class="go">]</span>

<span class="go">The linear structures are:</span>
<span class="go">([0 0 1 1],[0 1 1 1])</span>
<span class="go">([0 1 0 0],[0 1 0 1])</span>
<span class="go">([1 0 1 0],[1 1 1 1])</span>
<span class="go">([1 0 1 1],[0 1 0 1])</span>
<span class="go">([1 1 0 1],[1 0 0 1])</span>
<span class="go">([1 1 1 0],[1 1 1 0])</span>
<span class="go">([1 1 1 1],[0 1 0 1])</span>
</pre></div>
</div>
<p>We can notice that <em>NibbleSub</em> S-box has seven linear structures which are the following:</p>
<p>The figure represents the Autocorrelation Spectrum of <em>NibbleSub</em> and emphasizes in red the values corresponding these linear structures.</p>
<a class="reference internal image-reference" href="images/ls.png"><img alt="images/ls.png" class="align-center" src="images/ls.png" style="width: 750px;" /></a>
</div>
</div>
</div>
<div class="section" id="affine-function-and-affine-equivalence">
<h2><a class="toc-backref" href="#id76">Affine function and affine equivalence</a><a class="headerlink" href="#affine-function-and-affine-equivalence" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id34">
<h3><a class="toc-backref" href="#id77">Description</a><a class="headerlink" href="#id34" title="Permalink to this headline">¶</a></h3>
<p>A Boolean linear function is defined as a Boolean function consisting only of the sum of single input variables. Similarly, the set of Boolean affine functions is defined as the set of linear functions and their complements. A mathematical description of the linear and affine Boolean functions is given as follows.</p>
<p>A Boolean linear function is defined as the sum of a subset of the input variables, denoted <img class="math" src="images/math/9e711cc400cff4f137ae4307927e765968b00a12.png" alt="l_{\vec{u}}(\vec{x})=u_1x_1+u_2x_2+ \cdots + u_nx_n"/> where <img class="math" src="images/math/33c43f6a4a8bc0a35b20dc24054dbc54d9d35e9d.png" alt="\vec{u} = (u_1, \ldots, u_n) \in \gf{V_n}"/>.</p>
<p>The set of Boolean affine functions are the linear functions and their complements, denoted <img class="math" src="images/math/902b1c327551a4ae45e967f00f339365d38348ac.png" alt="l_{\vec{u},b}(\vec{x})=l_{\vec{u}}(\vec{x})+b"/> where <img class="math" src="images/math/1567fd5a07504f858f6998bbad26ee8abfd58539.png" alt="b \in \gf{GF(2)}"/>.</p>
<p>An affine Vector Boolean function is defined in terms of a linear Vector Boolean function and a dyadic shift. A linear Vector Boolean function involves the multiplication of the input vector by a Boolean matrix. A dyadic shift (or translation) involves the complement of a subset of input bits. As such, an affine Vector Boolean function may be defined as the combination of a linear Vector Boolean function and dyadic shift.  A mathematical description of the linear and affine Vector Boolean functions is given as follows.</p>
<p>A Vector Boolean function <img class="math" src="images/math/516ed0504c9d5ee3086d7b2340dd84b688a23ff0.png" alt="L_{\matr{A},\vec{b}} \in \funct{F}_{n,m}"/> defined as <img class="math" src="images/math/d247dc14ef7630f11fb8c3549cf07c2c8cccd293.png" alt="L_{\matr{A},\vec{b}}(\vec{x}) = \vec{x} \cdot \matr{A} + \vec{b}"/> with <img class="math" src="images/math/16c7203e97d1ec612388353a3caed6895c2aa135.png" alt="\vec{x} \in \gf{V_n}, \matr{A} \in \matr{M}_{n \times m}(\gf{GF(2)})"/> and <img class="math" src="images/math/0066c65eca244bc129d8d71059a6eca12d50b8b4.png" alt="\vec{b} \in \gf{V_m}"/> so that if <img class="math" src="images/math/1ce32c399addc5c4350469fac1239721e9d2c426.png" alt="\vec{b} = \vec{0}"/> then <em>F</em> is linear and if <img class="math" src="images/math/7ec9c5f43c40fb0327b0def9319b85d51d52d8ba.png" alt="\vec{b} \neq \vec{0}"/> then <em>F</em> is affine.</p>
<div class="section" id="affine-equivalence-of-boolean-functions">
<h4>Affine equivalence of Boolean functions<a class="headerlink" href="#affine-equivalence-of-boolean-functions" title="Permalink to this headline">¶</a></h4>
<p>Equivalence classes provide a powerful tool in both the construction and analysis of Boolean functions for cryptography. In particular, rather than considering the entire space of <img class="math" src="images/math/43e51163e798c53fcce5b8b6279941c5b0a2e178.png" alt="2^{2^n}"/> functions a reduced view can be found in the consideration of only one function from each equivalence class.</p>
<p>If <img class="math" src="images/math/79a863f3495dced406f828b5e5fb33c62ea45a3d.png" alt="g(\vec{x}) = f(\matr{A} \vec{x} + \vec{b}) + \vec{c}\vec{x}+d"/></p>
<p>where <img class="math" src="images/math/5d9adac746f460c29c90be661d3c924692cf7405.png" alt="\matr{A} \in \matr{M}_{n \times n}(\gf{GF(2)})"/>    non-singular, <img class="math" src="images/math/80d8daebd5ab21d599b1aae799d701b05eadd6a7.png" alt="\vec{b}, \vec{c} \in \gf{V_n}"/> and <img class="math" src="images/math/3e9539c1a19cede1087d3f9fd06b1576f88567ff.png" alt="d \in \gf{GF(2)}"/> and it is an affine transformation. The functions <em>f</em> and <em>g</em> satisfying the previous equation are called equivalent under the action of <img class="math" src="images/math/269652bb1937b5ff0740c39e6f3e6c4943557893.png" alt="AGL(n, 2)"/>.</p>
<p>Of particular interest in the study of equivalence classes is the effect of the affine transformation on the algebraic degree, the Walsh Spectrum and Autocorrelation Spectrum of a Boolean function.</p>
</div>
<div class="section" id="frequency-distribution-of-absolute-values-of-walsh-spectrum">
<h4>Frequency distribution of absolute values of Walsh Spectrum<a class="headerlink" href="#frequency-distribution-of-absolute-values-of-walsh-spectrum" title="Permalink to this headline">¶</a></h4>
<p>The effect of the application of an affine transformation to a Boolean function on the Walsh Spectrum is to rearrange the values and hence, the Walsh value distributions are invariant under all affine transformations <a class="reference internal" href="bibliography.html#preneel-93" id="id35">[Preneel:93]</a>:</p>
<div class="math">
<p><img src="images/math/fc6c463b3d87543b3313b2212ec3f15570ac2ad8.png" alt="\walsh{\chi}_g(\vec{u}) = (-1)^{\vec{c} \cdot \matr{A}^{-1} \vec{b}} (-1)^{\vec{u} \cdot \matr{A}^{-1} \vec{b}} \walsh{\chi}_f\left( \left(  \matr{A}^{-1} \right) \vec{u} + \left(  \matr{A}^{-1} \right) \vec{c} \right)"/></p>
</div><p>Thus nonlinearity is also invariant under affine transformation.</p>
</div>
<div class="section" id="frequency-distribution-of-absolute-values-of-autocorrelation-spectrum">
<h4>Frequency distribution of absolute values of Autocorrelation Spectrum<a class="headerlink" href="#frequency-distribution-of-absolute-values-of-autocorrelation-spectrum" title="Permalink to this headline">¶</a></h4>
<p>The effect of the application of an affine transformation to a Boolean function on the Autocorrelation Spectrum is to rearrange the values and hence, the Autocorrelation value distributions are invariant under all affine transformations <a class="reference internal" href="bibliography.html#preneel-93" id="id36">[Preneel:93]</a>:</p>
<div class="math">
<p><img src="images/math/04f4a37c31970c60dbb313c3dd52e9a78d886f55.png" alt="\R_{g}(\vec{u}) = (-1)^{\vec{u} \cdot \vec{c} } \R_{f}(         \matr{A} \vec{u})"/></p>
</div><p>Thus absolute indicator is also invariant under affine transformation.</p>
</div>
</div>
<div class="section" id="id37">
<h3><a class="toc-backref" href="#id78">Library</a><a class="headerlink" href="#id37" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized for a affine Vector Boolean function giving its corresponding matrix and vector by the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putaffine</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span><span class="o">&amp;</span> <span class="n">A</span><span class="p">,</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">vec_GF2</span><span class="o">&amp;</span>        <span class="n">b</span><span class="p">)</span>
</pre></div>
</div>
<p>The method used to obtain the Frequency distribution of the absolute values of the Walsh Spectrum is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">printFWH</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>The method used to obtain the Frequency distribution of the absolute values of the Autocorrelation Spectrum is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">printFAC</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id38">
<h4>Example<a class="headerlink" href="#id38" title="Permalink to this headline">¶</a></h4>
<p>The following program finds out the Walsh Spectrum, Frequency distribution of the absolute values of the Walsh Spectrum,  Autocorrelation Spectrum, and Frequency distribution of the absolute values of the Autocorrelation Spectrum of a Vector Boolean function having as input the matrix <img class="math" src="images/math/83e8380c1f93464e4f2ad204f51ceaa5974dd037.png" alt="\matr{A}"/> and the vector <img class="math" src="images/math/ee99bb729a6cb6a85c1aff9d4031b51fd36144d7.png" alt="\vec{b}"/> associated with an affine function where:</p>
<div class="math">
<p><img src="images/math/db6546e8d269ceeed8213dfdd5bc7dcb715ed214.png" alt="\matr{A} = \begin{bmatrix} 0 &amp; 1 \\ 1 &amp; 0 \\ \end{bmatrix}, \ \ \vec{b} = (0,1)"/></p>
</div><div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">A</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">vec_GF2</span> <span class="n">b</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">A</span><span class="p">;</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">b</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">putaffine</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">b</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Walsh Spectrum is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">Walsh</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Frequency distribution of the absolute values of</span>
   <span class="n">the</span> <span class="n">Walsh</span> <span class="nl">Spectrum</span><span class="p">:</span><span class="s">&quot; &lt;&lt; endl;</span>
   <span class="n">printFWH</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Autocorrelation Spectrum is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">AC</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Frequency distribution of the absolute values of</span>
   <span class="n">the</span> <span class="n">Autocorrelation</span> <span class="nl">Spectrum</span><span class="p">:</span><span class="s">&quot; &lt;&lt; endl;</span>
   <span class="n">printFAC</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Walsh Spectrum is:</span>
<span class="go">[[4 0 0 0]</span>
<span class="go">[0 0 4 0]</span>
<span class="go">[0 -4 0 0]</span>
<span class="go">[0 0 0 -4]</span>
<span class="go">]</span>

<span class="go">Frequency distribution of the absolute values of the Walsh Spectrum:</span>
<span class="go">(0,3),(4,1)</span>
<span class="go">(0,3),(4,1)</span>
<span class="go">(0,3),(4,1)</span>

<span class="go">The Autocorrelation Spectrum is:</span>
<span class="go">[[4 4 4 4]</span>
<span class="go">[4 4 -4 -4]</span>
<span class="go">[4 -4 4 -4]</span>
<span class="go">[4 -4 -4 4]</span>
<span class="go">]</span>
<span class="go">Frequency distribution of the absolute values of the Autocorrelation Spectrum:</span>
<span class="go">(4,4)</span>
<span class="go">(4,4)</span>
<span class="go">(4,4)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="cycle-structure-fixed-points-and-negated-fixed-points">
<h2><a class="toc-backref" href="#id79">Cycle structure, fixed points and negated fixed points</a><a class="headerlink" href="#cycle-structure-fixed-points-and-negated-fixed-points" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id39">
<h3><a class="toc-backref" href="#id80">Description</a><a class="headerlink" href="#id39" title="Permalink to this headline">¶</a></h3>
<p>The <em>cycle structure</em> of an invertible vector Boolean function <img class="math" src="images/math/841b86f0d9354a22ef8d115f559b85362ce7045d.png" alt="F \in \funct{F}_{n,n}"/> (permutation) describes the number of cycles and their length.</p>
<p>A permutation can also be written in a way that groups together the images of a given number under repeated applications of <em>F</em>. For example, the permutation:</p>
<div class="math">
<p><img src="images/math/ac7f3fc463e324ad32435211fe5cd0070ff94f0d.png" alt="F = \begin{bmatrix}
1 &amp; 2 &amp; 3 &amp; 4 &amp; 5 &amp; 6 &amp; 7 &amp; 8 &amp; 9 \\
3 &amp; 6 &amp; 4 &amp; 7 &amp; 5 &amp; 9 &amp; 1 &amp; 8 &amp; 2
\end{bmatrix}"/></p>
</div><p>can be written</p>
<div class="math">
<p><img src="images/math/16e771f35d14e3eeb74cf28515f9078e216ecd19.png" alt="F = (1 3 4 7)(2 6 9)(5)(8)"/></p>
</div><p>The first group of numbers in parentheses indicates that 1 gets mapped to 3, 3 gets mapped to 4, 4 gets mapped to 7, and 7 gets mapped back to 1. Each of the other groupings is interpreted in a similar way. These groups of numbers are called cycles, and this notation for permutations is referred to as cycle notation. Following are several facts relating to cycles and cycle notation:</p>
<ol class="arabic simple">
<li>A cycle of <em>k</em> numbers is referred to as a <em>k</em>-cycle or a cycle of length <em>k</em>; for example, <img class="math" src="images/math/049e31c90f2f115ec4f7401f95595c4f567581c4.png" alt="(1 3 4 7)"/> is a <em>4</em>-cycle or a cycle of length <em>4</em>.</li>
<li>A cycle of one number indicates that the number is mapped to itself, and 1-cycles are often referred to as <em>fixed points</em>. In the example above, there are two fixed points: <em>5</em> and <em>8</em>.</li>
<li>It does not matter which number is written first in a cycle, as long as the order of the numbers is preserved. For example, <img class="math" src="images/math/4fb5d95fd1224844c446fc85475eeb417a743cc4.png" alt="(1 3 4 7) = (4 7 1 3)"/>, but <img class="math" src="images/math/006b618f0fbeb517b081d23090f9e41c831c3b9d.png" alt="(1 3 4 7) \neq (1 4 3 7)"/>.</li>
</ol>
<p>A cycle structure with a low number of cycles of high length is considered well suited to be used in cipher design. This fact means that many transpositions are present.</p>
<p>The <em>fixed points</em> of <em>F</em> are those which belong to the set <img class="math" src="images/math/67ecfff87b51af7cc2d76dfe6da41d060bf94203.png" alt="\{ \vec{x} \given F(\vec{x})=\vec{x} \}"/>. The <em>negated fixed points</em> of <em>F</em> belong to the set <img class="math" src="images/math/44f44e19385db6320102f630f1d906015d8e9532.png" alt="\{ \vec{x} \given F(\vec{x})= \overline{\vec{x}} \}"/> where <img class="math" src="images/math/9990e0056fb9cfa9e7f9b32aa050c184d9dfd2a8.png" alt="\overline{\vec{x}}"/> is the inverse of <img class="math" src="images/math/238c379726aaa131539d14959425122f18a7f70a.png" alt="\vec{x}"/> or the vector resulting from adding <em>1</em> to each of its components.</p>
<p>A cryptographic primitive with a high number of fixed and/or
negated fixed points is considered to be not well designed, since it lacks the needed randomness.</p>
</div>
<div class="section" id="id40">
<h3><a class="toc-backref" href="#id81">Library</a><a class="headerlink" href="#id40" title="Permalink to this headline">¶</a></h3>
<p>The method used to obtain the Cycle Structure is the following:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">Cycle</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>The method used to print the Cycle structure so that each row has two values separated by a comma: the first one is the Cycle length and the second one is the number of cycles for this length.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">printCycle</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>The fixed points of <em>F</em> are obtained by this method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">fixedpoints</span><span class="p">(</span><span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>The negated fixed points of <em>F</em> are obtained by this method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">negatedfixedpoints</span><span class="p">(</span><span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id41">
<h4>Example<a class="headerlink" href="#id41" title="Permalink to this headline">¶</a></h4>
<p>The following program prints the cycle structure of a Vector Boolean function having as input its Truth Table.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Cycle Structure is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">printCycle</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">F</span><span class="p">);</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The fixed points are the following:&quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">fixedpoints</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The negated fixed points are the following:&quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">negatedfixedpoints</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>If we use as input of this program the Truth Table of <em>NibbleSub</em>, the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Cycle Structure is:</span>
<span class="go">2,1</span>
<span class="go">14,1</span>

<span class="go">The fixed points are the following:</span>
<span class="go">[]</span>

<span class="go">The negated fixed points are the following:</span>
<span class="go">[[0 0 1 0]</span>
<span class="go">[0 1 1 1]</span>
<span class="go">]</span>
</pre></div>
</div>
<p>which means:</p>
<table border="1" class="docutils">
<colgroup>
<col width="44%" />
<col width="56%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Cycle structure of <em>NibbleSub</em></th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Cycle length</td>
<td>Number of cycles</td>
</tr>
<tr class="row-odd"><td>2</td>
<td>1</td>
</tr>
<tr class="row-even"><td>14</td>
<td>1</td>
</tr>
</tbody>
</table>
<p>It has no fixed points and 2 negated fixed points which are the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">[0 0 1 0]</span>
<span class="go">[0 1 1 1]</span>
</pre></div>
</div>
<p>This is because <img class="math" src="images/math/e307681c065aac69255a881ca3a6f269b6e4e898.png" alt="NibbleSub[(1,1,0,1)]=(0,0,1,0)"/> and <img class="math" src="images/math/c17e819c3dd53da0ba49d0f3f09e269612dab563.png" alt="NibbleSub[(1,0,0,0)]=(0,1,1,1)"/>.</p>
</div>
</div>
</div>
<div class="section" id="permutation-matrix">
<h2><a class="toc-backref" href="#id82">Permutation matrix</a><a class="headerlink" href="#permutation-matrix" title="Permalink to this headline">¶</a></h2>
<div class="section" id="id42">
<h3><a class="toc-backref" href="#id83">Description</a><a class="headerlink" href="#id42" title="Permalink to this headline">¶</a></h3>
<p>If <em>F</em> is a Boolean permutation, that is, it is bijective and has the same number of input bits as output bits <em>(n=m)</em>, then it can be defined as an array: <img class="math" src="images/math/b2ba7bcf6d01a7b023974200385a3b1f8e6d6c2d.png" alt="F = \begin{bmatrix} F(1) &amp; \dots &amp; F(n) \end{bmatrix}"/> where <img class="math" src="images/math/8c4eed432affb8e31196883aeb0587b45713a11d.png" alt="F(i)"/> is the output bit of the input bit <em>i</em> for <em>F</em>.</p>
</div>
<div class="section" id="id43">
<h3><a class="toc-backref" href="#id84">Library</a><a class="headerlink" href="#id43" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its permutation vector with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putper</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain its representation as permutation vector, the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">PER</span><span class="p">(</span><span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id44">
<h4>Example<a class="headerlink" href="#id44" title="Permalink to this headline">¶</a></h4>
<p>The following program finds out the Truth Table of a Vector Boolean function having as input its Permutation Vector:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">[ 1 2 3 4 13 14 15 16 9 10 11 12 5 6 7 8 ]</span>
</pre></div>
</div>
<p>For example, you can see bit 13 moves to bit 5, while bit 5 moves to bit 13.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span>  <span class="n">a</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">a</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">putper</span><span class="p">(</span><span class="n">a</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Truth Table is:&quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">TT</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The first 10 lines of the output of the program would be the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Truth Table is:</span>
<span class="go">[[0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 0 1 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 1 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 0 1 1 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 0 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 0 1 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 1 0 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 0 1 1 1 0 0 0 0 0 0 0 0]</span>
<span class="go">[0 0 0 0 1 0 0 0 0 0 0 0 0 0 0 0]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="des-representations">
<h2><a class="toc-backref" href="#id85">DES representations</a><a class="headerlink" href="#des-representations" title="Permalink to this headline">¶</a></h2>
<p>The VBF library accepts to types of representations of DES <a class="reference internal" href="bibliography.html#des-77" id="id45">[DES:77]</a> components:</p>
<ol class="arabic">
<li><p class="first"><em>Expansion and Compression DES permutations</em>. It can be used to represent both the Compression Permutation in the Key Transformation of DES and the Expansion Permutation Feistel Function of the DES cipher. The Compression Permutation permutes the order of the bits as well as selects a subset of bits. The Expansion Permutation expands the right half of the data, <img class="math" src="images/math/1c8369633f86704231451b8f07c4280703eee4cf.png" alt="R_i"/>, from 32 bits to 48 bits. Because this operation changes the order of the bits as well as repeating certain bits, it is known as an expansion permutation.</p>
</li>
<li><p class="first"><em>DES S-box Substitution</em>. Each S-box is a table of 4 rows and 16 columns. Each entry in the box is a 4-bit number. The 6 input bits of the S-box specify under which row and column number to look for the output.</p>
<blockquote>
<div><p>The input bits specify an entry in the S-box as follows: Consider an S-box input of 6-bits,
labeled <img class="math" src="images/math/fdb63f0bbfb9d0d8d42d2108cfb6bcf49c35f3e8.png" alt="b_1, b_2, b_3, b_4, b_5,"/> and <img class="math" src="images/math/4472c1fbd4866cabfd7f8573ddfcea73350a1b02.png" alt="b_6"/>. Bits <img class="math" src="images/math/2b363420136d2cb9e770ecdeb09538e660ca518a.png" alt="b_1"/> and <img class="math" src="images/math/4472c1fbd4866cabfd7f8573ddfcea73350a1b02.png" alt="b_6"/> are combined to form a 2-bit number, from 0 to 3, which corresponds to a row in the table. The middle 4 bits, <img class="math" src="images/math/70de1748de857458694e38395c104825caa59c08.png" alt="b_2"/> through <img class="math" src="images/math/4a36c69310250017426a7c59b945c1bd946cb5e5.png" alt="b_5"/>, are combined to form a 4-bit number, from 0 to 15, which corresponds to a column in the table.</p>
<p>For example, assume that the input to the first S-box (i.e. bits 1 to 6 of the XOR function) is <em>110011</em>. The first and last bits combine to form <em>11</em>, which corresponds to row 3 of the first S-box. The middle 4 bits combine to form <em>1001</em>, which corresponds to the column 9 of the same S-box. The entry under row 3, column 9 of S-box 1 is 11 (count rows and columns starting from 0). The value <em>1110</em> is substituted for <em>001011</em></p>
<p>The following figures list the eight S-boxes used in DES. Each S-box replaces a 6-bit input with a 4-bit output. Given a 6-bit input, the 4-bit output is found by selecting the row using the outer two bits, and the column using the inner four bits. For example, an input &#8220;011011&#8221; has outer bits &#8220;01&#8221; and inner bits &#8220;1101&#8221;; noting that the first row is &#8220;00&#8221; and the first column is &#8220;0000&#8221;, the corresponding output for S-box S5 would be &#8220;1001&#8221; (=9), the value in the second row, 14th column.</p>
<a class="reference internal image-reference" href="images/S1-4.png"><img alt="images/S1-4.png" class="align-center" src="images/S1-4.png" style="width: 750px;" /></a>
<a class="reference internal image-reference" href="images/S5-8.png"><img alt="images/S5-8.png" class="align-center" src="images/S5-8.png" style="width: 750px;" /></a>
</div></blockquote>
</li>
</ol>
<div class="section" id="id46">
<h3><a class="toc-backref" href="#id86">Library</a><a class="headerlink" href="#id46" title="Permalink to this headline">¶</a></h3>
<p>A VBF class can be initialized giving its Expansion and Compression DES permutation vector with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putexp_comp</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span><span class="o">&amp;</span> <span class="n">v</span><span class="p">)</span>
</pre></div>
</div>
<p>A VBF class can be initialized giving its DES-like S-box representation matrix with the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putsbox</span><span class="p">(</span><span class="k">const</span> <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span><span class="o">&amp;</span> <span class="n">S</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="id47">
<h4>Example<a class="headerlink" href="#id47" title="Permalink to this headline">¶</a></h4>
<p>The following program prints the Truth Table of a Expansion permutation and of the DES S1 S-box. The inputs are respectively the following:</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">[ 4 1 2 3 4 1 ]</span>
</pre></div>
</div>
<div class="highlight-console"><div class="highlight"><pre><span class="go">[[14 4 13 1 2 15 11 8 3 10 6 12 5 9 0 7 ]</span>
<span class="go">[ 0 15 7 4 14 2 13 1 10 6 12 11 9 5 3 8 ]</span>
<span class="go">[ 4 1 14 8 13 6 2 11 15 12 9 7 3 10 5 0]</span>
<span class="go">[ 15 12 8 2 4 9 1 7 5 11 3 14 10 0 6 13]]</span>
</pre></div>
</div>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span> <span class="n">F</span><span class="p">,</span><span class="n">G</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">vec_ZZ</span> <span class="n">v</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_ZZ</span> <span class="n">S</span><span class="p">;</span>

   <span class="n">ifstream</span> <span class="n">inputv</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">inputv</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">inputv</span> <span class="o">&gt;&gt;</span> <span class="n">v</span><span class="p">;</span>
   <span class="n">inputv</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
   <span class="n">F</span><span class="p">.</span><span class="n">putexp_comp</span><span class="p">(</span><span class="n">v</span><span class="p">);</span>

   <span class="n">ifstream</span> <span class="n">inputS</span><span class="p">(</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">inputS</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">inputS</span> <span class="o">&gt;&gt;</span> <span class="n">S</span><span class="p">;</span>
   <span class="n">inputS</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>
   <span class="n">G</span><span class="p">.</span><span class="n">putsbox</span><span class="p">(</span><span class="n">S</span><span class="p">);</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Truth Table of Expansion Permutation is:&quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">TT</span><span class="p">(</span><span class="n">F</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The Truth Table of S1 DES S-box is:&quot;</span>
   <span class="o">&lt;&lt;</span> <span class="n">endl</span> <span class="o">&lt;&lt;</span> <span class="n">TT</span><span class="p">(</span><span class="n">G</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The output of the program would be the following (Only a few values of S1 Truth Table is printed for space reasons):</p>
<div class="highlight-console"><div class="highlight"><pre><span class="go">The Truth Table of Expansion Permutation is:</span>
<span class="go">[[0 0 0 0 0 0]</span>
<span class="go">[1 0 0 0 1 0]</span>
<span class="go">[0 0 0 1 0 0]</span>
<span class="go">[1 0 0 1 1 0]</span>
<span class="go">[0 0 1 0 0 0]</span>
<span class="go">[1 0 1 0 1 0]</span>
<span class="go">[0 0 1 1 0 0]</span>
<span class="go">[1 0 1 1 1 0]</span>
<span class="go">[0 1 0 0 0 1]</span>
<span class="go">[1 1 0 0 1 1]</span>
<span class="go">[0 1 0 1 0 1]</span>
<span class="go">[1 1 0 1 1 1]</span>
<span class="go">[0 1 1 0 0 1]</span>
<span class="go">[1 1 1 0 1 1]</span>
<span class="go">[0 1 1 1 0 1]</span>
<span class="go">[1 1 1 1 1 1]</span>
<span class="go">]</span>

<span class="go">The Truth Table of S1 DES S-box is:</span>
<span class="go">[[1 1 1 0]</span>
<span class="go">[0 0 0 0]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[1 1 1 1]</span>
<span class="go">[1 1 0 1]</span>
<span class="go">[0 1 1 1]</span>
<span class="go">[0 0 0 1]</span>
<span class="go">[0 1 0 0]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[1 1 1 0]</span>
<span class="go">[1 1 1 1]</span>
<span class="go">[0 0 1 0]</span>
<span class="go">[1 0 1 1]</span>
<span class="go">[1 1 0 1]</span>
<span class="go">[1 0 0 0]</span>
<span class="go">[0 0 0 1]</span>
<span class="go">...</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="auxiliary-functions">
<h2><a class="toc-backref" href="#id87">Auxiliary functions</a><a class="headerlink" href="#auxiliary-functions" title="Permalink to this headline">¶</a></h2>
<p>In order to compute the matrices described above, some functions have been
implemented which allow to obtain some of these matrices from others:</p>
<ol class="arabic simple">
<li>A function whose input is an ANF table and its output is the Truth Table: <code class="code docutils literal"><span class="pre">mat_GF2</span> <span class="pre">rev(const</span> <span class="pre">mat_GF2&amp;</span> <span class="pre">A,</span> <span class="pre">int</span> <span class="pre">n,</span> <span class="pre">int</span> <span class="pre">m)</span></code>.</li>
<li>A function whose input is the Characteristic Function and its output is the Truth Table: <code class="code docutils literal"><span class="pre">mat_GF2</span> <span class="pre">truthtable(const</span> <span class="pre">mat_ZZ&amp;</span> <span class="pre">C,</span> <span class="pre">int</span> <span class="pre">n,</span> <span class="pre">int</span> <span class="pre">m)</span></code>.</li>
<li>A function whose input is the Truth Table and its output is the Characteristic Function: <code class="code docutils literal"><span class="pre">mat_ZZ</span> <span class="pre">charfunct(const</span> <span class="pre">mat_GF2&amp;</span> <span class="pre">T,</span> <span class="pre">int</span> <span class="pre">n,</span> <span class="pre">int</span> <span class="pre">m)</span></code>.</li>
<li>A function whose input is the Walsh Spectrum and its output is the Characteristic Function (that is the Inverse Walsh Transform): <code class="code docutils literal"><span class="pre">mat_ZZ</span> <span class="pre">invwt(const</span> <span class="pre">mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">int</span> <span class="pre">n,</span> <span class="pre">int</span> <span class="pre">m)</span></code>.</li>
<li>A matrix representing the linear combinations of Truth Table coordinate functions <code class="code docutils literal"><span class="pre">void</span> <span class="pre">LTT(NTL::mat_GF2&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">a)</span></code>.</li>
<li>A matrix representing character form of Truth Table coordinate functions <code class="code docutils literal"><span class="pre">void</span> <span class="pre">CTT(NTL::mat\_GF2\&amp;</span> <span class="pre">X,</span> <span class="pre">VBF\&amp;</span> <span class="pre">a)</span></code>.</li>
</ol>
</div>
<div class="section" id="summary">
<h2><a class="toc-backref" href="#id88">Summary</a><a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>Table <a class="reference internal" href="representations_d/summary.html#representation"><span>Representations Table</span></a> lists the member functions related to
methods of vector Boolean functions initialization. Table
<a class="reference internal" href="representations_d/summary.html#characterization"><span>Characterizations Table</span></a> lists the member functions related to the characterizations of vector Boolean functions as described above. Most of the member
functions of <em>VBF</em> have an in-line definition, for instance: <code class="code docutils literal"><span class="pre">void</span> <span class="pre">TT(NTL::mat_GF2&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code> is also defined as <code class="code docutils literal"><span class="pre">inline</span> <span class="pre">NTL::mat_GF2</span> <span class="pre">TT(VBF&amp;</span> <span class="pre">F)</span></code>.</p>
<table border="1" class="docutils" id="representation">
<colgroup>
<col width="33%" />
<col width="67%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Representation of VBF</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>SYNTAX</strong></td>
<td><strong>DESCRIPTION</strong></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">puttt(const</span> <span class="pre">NTL::mat_GF2&amp;</span> <span class="pre">X)</span></code></td>
<td><img class="math" src="images/math/fa5718542e92211e1d6f25c71a5ed5a2f1481178.png" alt="\matr{TT}_F = \matr{T}"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putHexTT(istream&amp;</span> <span class="pre">s)</span></code></td>
<td>VBF which has an hexadecimal representation of its truth table defined by <em>s</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putDecTT(const</span> <span class="pre">NTL::vec_long&amp;</span> <span class="pre">d,const</span> <span class="pre">long&amp;</span> <span class="pre">m)</span></code></td>
<td>VBF with a decimal representation of its truth table defined by <em>d</em> and <em>m</em> is the number of component Boolean functions</td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putltt(const</span> <span class="pre">NTL::mat_GF2&amp;</span> <span class="pre">L)</span></code></td>
<td><img class="math" src="images/math/0ce45a21c432f5815ce1b722281d941664d18bbb.png" alt="\matr{LTT}_F = \matr{L}"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putctt(const</span> <span class="pre">NTL::mat_ZZ&amp;</span> <span class="pre">C)</span></code></td>
<td><img class="math" src="images/math/10c03073be22401651d5e1c175c23b47921bddc3.png" alt="\matr{CTT}_F = \matr{C}"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putirrpol(GF2X&amp;</span> <span class="pre">g)</span></code>
<code class="code docutils literal"><span class="pre">void</span> <span class="pre">puttrace(string&amp;</span> <span class="pre">f)</span></code></td>
<td>Set <em>F</em> by its trace <em>f</em> and the irreducible polynomial <em>g</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putpol(vec_pol&amp;</span> <span class="pre">p)</span></code></td>
<td>Set <em>F</em> with Polynomials in <em>ANF</em> equals to <em>p</em></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putanf(const</span> <span class="pre">NTL::mat_GF2&amp;</span> <span class="pre">A)</span></code></td>
<td><img class="math" src="images/math/191c1b686dda50311a0e79cb88bff4fbbc31221e.png" alt="\matr{ANF}_F = \matr{A}"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putchar(const</span> <span class="pre">NTL::mat_ZZ&amp;</span> <span class="pre">C)</span></code></td>
<td><img class="math" src="images/math/7e5eadf66c9e20213de2f3df6fceb851b4421f66.png" alt="\matr{Img}(F) = \matr{C}"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putwalsh(const</span> <span class="pre">NTL::mat_ZZ&amp;</span> <span class="pre">W)</span></code></td>
<td><img class="math" src="images/math/06db45dc83d39102dd8a834bd462acea57b5d14f.png" alt="\matr{WS}(F) = \matr{W}"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putper(const</span> <span class="pre">NTL::vec_ZZ&amp;</span> <span class="pre">v)</span></code></td>
<td>VBF which is a permutation defined by <img class="math" src="images/math/52905f8cd19f2e4c69545d8082039da5b51c061d.png" alt="\vec{v}"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putexp_comp(const</span> <span class="pre">NTL::vec_ZZ&amp;</span> <span class="pre">v)</span></code></td>
<td>VBF defined by Expansion and Compression DES vector <img class="math" src="images/math/52905f8cd19f2e4c69545d8082039da5b51c061d.png" alt="\vec{v}"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">putsbox(const</span> <span class="pre">NTL::mat_ZZ&amp;</span> <span class="pre">S)</span></code></td>
<td>VBF which is a DES S-Box defined by <em>S</em></td>
</tr>
</tbody>
</table>
<table border="1" class="docutils" id="characterization">
<colgroup>
<col width="39%" />
<col width="61%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head" colspan="2">Characterization of VBF</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td><strong>SYNTAX</strong></td>
<td><strong>DESCRIPTION</strong></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">TT(NTL::mat_GF2&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/e99f9696c04fd619293c5bce2756cc4e2c9e0fad.png" alt="\matr{X}=\matr{T}_F"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">getHexTT(ostream&amp;</span> <span class="pre">s)</span></code></td>
<td><em>s</em> is the hexadecimal representation of the truth table of <em>F</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">NTL::vec_long</span> <span class="pre">getDecTT()</span> <span class="pre">const</span></code></td>
<td>Decimal representation of the truth table</td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">long</span> <span class="pre">weight(VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Weight of <em>F</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">LTT(NTL::mat_GF2&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/cdb195ca62fe065389f9831d760575a8d0a8060e.png" alt="\matr{X}=\matr{LTT}_F"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">CTT(NTL::mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/d3542e40066fcabbbaac9a31758f724bed4d2980.png" alt="\matr{X}=\matr{CTT}_F"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">Trace(GF2EX&amp;</span> <span class="pre">f,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><em>F</em> has a trace representation defined by <em>f</em></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">Pol(NTL_SNS</span> <span class="pre">ostream&amp;</span> <span class="pre">s,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><em>s</em> contains the Polynomials in <em>ANF</em> of <em>F</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">ANF(NTL::mat_GF2&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/d8ac2593b9c3e8f1ecd88e05339390230bbef385.png" alt="\matr{X}=\matr{ANF}_F"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">Charact(NTL::mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/4fe56c4a66dc144357b87f8bb64c868cc5a8a6e5.png" alt="\matr{X}=\matr{Img(F)}"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">Walsh(NTL::mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/9758b28b15d6cedfca78fbe87a6f2a681a891c3e.png" alt="\matr{X}=\matr{WS}(F)"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">LAT(NTL::mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/1debf2417574c3d43e54e464a3c9cda69120b189.png" alt="\matr{X}=\matr{LP}(F)"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">lp(NTL::RR&amp;</span> <span class="pre">x,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/f81882fe608ed481f5a30a12b2f164573da18ed3.png" alt="\crit{lp}(F)=x"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">linear(NTL_SNS</span> <span class="pre">ostream&amp;</span> <span class="pre">s,</span> <span class="pre">VBF&amp;</span> <span class="pre">F,</span> <span class="pre">ZZ&amp;</span> <span class="pre">x)</span></code></td>
<td>Linear relations associated with the value <em>x</em> of the Linear Profile of <em>F</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">ProbLin(NTL::RR&amp;</span> <span class="pre">x,</span> <span class="pre">VBF&amp;</span> <span class="pre">F,</span> <span class="pre">NTL::ZZ&amp;</span> <span class="pre">w)</span></code></td>
<td>Probability of Linear relations associated with the value <em>w</em> of the Linear Profile of <em>F</em></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">DAT(NTL::mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/cddf18529b28cbf23183af42e44138709e61a479.png" alt="\matr{X}=\matr{DP}(F)"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">dp(NTL::RR&amp;</span> <span class="pre">x,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/283eaca73f1d203323eae8aa3d4b092712e1aa92.png" alt="\crit{dp}(F)=x"/></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">differential(NTL_SNS</span> <span class="pre">ostream&amp;</span> <span class="pre">s,</span> <span class="pre">VBF&amp;</span> <span class="pre">F,</span> <span class="pre">ZZ&amp;</span> <span class="pre">x)</span></code></td>
<td>Differential relations associated with the value <em>x</em> of the Differential Profile of <em>F</em></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">ProbDif(NTL::RR&amp;</span> <span class="pre">x,</span> <span class="pre">VBF&amp;</span> <span class="pre">F,</span> <span class="pre">NTL::ZZ&amp;</span> <span class="pre">w)</span></code></td>
<td>Probability of characteristics associated with the value <em>w</em> of the Differential Profile of <em>F</em></td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">AC(NTL::mat_ZZ&amp;</span> <span class="pre">X,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/8c490428249568d77ea3b7320dd5addb7c7d28eb.png" alt="\matr{X}=\matr{R}(F)"/></td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">NTL::mat_GF2</span> <span class="pre">LS(VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Returns a matrix whose rows are the linear structures</td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">printFWH(NTL_SNS</span> <span class="pre">ostream&amp;</span> <span class="pre">s,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Frequency distribution of the absolute values of the Walsh Spectrum</td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">printFAC(NTL_SNS</span> <span class="pre">ostream&amp;</span> <span class="pre">s,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Frequency distribution of the absolute values of the Autocorrelation Spectrum</td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">Cycle(NTL::vec_ZZ&amp;</span> <span class="pre">v,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/52905f8cd19f2e4c69545d8082039da5b51c061d.png" alt="\vec{v}"/> is the Cycle Structure</td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">printCycle(NTL_SNS</span> <span class="pre">ostream&amp;</span> <span class="pre">s,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Print Cycle Structure</td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">NTL::mat_GF2</span> <span class="pre">fixedpoints(VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Return fixed points</td>
</tr>
<tr class="row-odd"><td><code class="code docutils literal"><span class="pre">NTL::mat_GF2</span> <span class="pre">negatedfixedpoints(VBF&amp;</span> <span class="pre">F)</span></code></td>
<td>Return negated fixed points</td>
</tr>
<tr class="row-even"><td><code class="code docutils literal"><span class="pre">void</span> <span class="pre">PER(NTL::vec_ZZ&amp;</span> <span class="pre">v,</span> <span class="pre">VBF&amp;</span> <span class="pre">F)</span></code></td>
<td><img class="math" src="images/math/52905f8cd19f2e4c69545d8082039da5b51c061d.png" alt="\vec{v}"/> is the permutation vector defined by <em>F</em></td>
</tr>
</tbody>
</table>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="criteria.html" class="btn btn-neutral float-right" title="Cryptographic Criteria">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="using.html" class="btn btn-neutral" title="Using the library"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jose Antonio Alvarez Cubero.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="static/jquery.js"></script>
      <script type="text/javascript" src="static/underscore.js"></script>
      <script type="text/javascript" src="static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-60418502-1', 'auto');
    ga('send', 'pageview');

  </script>
   

</body>
</html>