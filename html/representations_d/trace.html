

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Trace representation &mdash; VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="../static/css/theme.css" type="text/css" />
  

  

  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms 1.0.1 documentation" href="../index.html"/> 

  
  <script src="../static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="../index.html" class="icon icon-home"> VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms
          

          
            
            <img src="../static/wrapping_paper-binary.jpg" class="logo" />
          
          </a>

          
            
            
              <div class="version">
                1.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../preface.html">1. Preface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../intro.html">2. Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../using.html">3. Using the library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../representations.html">4. Representations and characterizations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../criteria.html">5. Cryptographic Criteria</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations.html">6. Operations and constructions over Vector Boolean Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../aes.html">7. Analysis of AES competition cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cryptec.html">8. Analysis of CRYPTEC project cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../nessie.html">9. Analysis of NESSIE project cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../other.html">10. Analysis of other cryptographic algorithms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design.html">11. Design of cryptographically robust Vector Boolean functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq.html">12. FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">13. Bibliography</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">VBF Library: User Manual, Analysis and Design of Cryptographic Algorithms</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Trace representation</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../sources/representations_d/trace.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="trace-representation">
<h1>Trace representation<a class="headerlink" href="#trace-representation" title="Permalink to this headline">¶</a></h1>
<div class="section" id="description">
<h2>Description<a class="headerlink" href="#description" title="Permalink to this headline">¶</a></h2>
<p>We identify a Boolean function in <em>n</em> variables with a function from <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/> to <img class="math" src="../images/math/7226a807fa9c82958d0ddd8fb72d9287d29411f1.png" alt="\gf{GF(2)}"/> and Vector Boolean function in <em>n</em> variables with a function from <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/> to <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/>.</p>
<p>A <em>trace</em> is a function over a finite field <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/> defined as: <img class="math" src="../images/math/6c181b339999fd4fdd76d2bf072aee905307896b.png" alt="tr(\vec{x}) = \sum_{i=0}^{2^n-1} x^i"/></p>
<p>Since there is is an isomorphism between <img class="math" src="../images/math/323bd5c05c5c9e23cbaa1f1b2ec96d5318145d5c.png" alt="\gf{V_n}"/> and <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/>, it is possible to identify the trace function with a Boolean function in <em>n</em> variables. Analogously, a Vector Boolean function can be identified with trace as follows:</p>
<p>When <em>m=n</em>, we endow <img class="math" src="../images/math/323bd5c05c5c9e23cbaa1f1b2ec96d5318145d5c.png" alt="\gf{V_n}"/> with the structure of the field <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/>. Any <img class="math" src="../images/math/214dc8e43abe968464421883287c148a68e97541.png" alt="F \in \funct{F}_{n,n}"/> admits a unique <em>univariate polynomial representation</em> over <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/>, of degree at most <img class="math" src="../images/math/73b96dce619bef68a2b2dc4dc0f2ac36a6b0cb62.png" alt="2^n-1"/>:</p>
<div class="math">
<p><img src="../images/math/0d759df017c574e81696ff3876b86c96a2abd177.png" alt="F(\vec{x}) = \sum_{i=0}^{2^n-1} \delta_i x^i, \ \delta_i \in \gf{GF(2^n)}"/></p>
</div><p>A general way to derive this polynomial representation is given by a Lagrange interpolation from the knowledge of the irreducible polynomial of degree <em>n</em> over <img class="math" src="../images/math/7226a807fa9c82958d0ddd8fb72d9287d29411f1.png" alt="\gf{GF(2)}"/> associated with the field <img class="math" src="../images/math/701217b291646e2a10f11025289db30ffe7410e8.png" alt="GF(2^n)"/> and the Truth Table of <em>F</em>.</p>
<p>The <em>interpolation attack</em> <a class="reference internal" href="../bibliography.html#jakobsenk-97" id="id1">[JakobsenK:97]</a> is efficient when the degree of the univariate polynomial representation of the S-box over <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/> is low or when the distance of the S-box to the set of low univariate degree functions is small. This attack exploits the low degree of the algebraic relation between some input (respective output) and intermediate data to infer some keybits relating the output (respective input) and the intermediate data.</p>
</div>
<div class="section" id="library">
<h2>Library<a class="headerlink" href="#library" title="Permalink to this headline">¶</a></h2>
<p>A VBF class can be initialized giving its trace <em>f</em> and the irreducible polynomial <em>g</em> with the following methods:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">putirrpol</span><span class="p">(</span><span class="n">GF2X</span><span class="o">&amp;</span> <span class="n">g</span><span class="p">)</span>
<span class="kt">void</span> <span class="n">puttrace</span><span class="p">(</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
<p>To obtain a Vector Boolean function trace representation the following method must be used:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">Trace</span><span class="p">(</span><span class="n">GF2EX</span><span class="o">&amp;</span> <span class="n">f</span><span class="p">,</span> <span class="n">VBF</span><span class="o">&amp;</span> <span class="n">F</span><span class="p">)</span>
</pre></div>
</div>
<p>and to print the trace representation use the following method:</p>
<div class="highlight-c"><div class="highlight"><pre><span class="kt">void</span> <span class="n">print</span><span class="p">(</span><span class="n">NTL_SNS</span> <span class="n">ostream</span><span class="o">&amp;</span> <span class="n">s</span><span class="p">,</span> <span class="n">GF2EX</span><span class="o">&amp;</span> <span class="n">f</span><span class="p">,</span> <span class="k">const</span> <span class="kt">long</span><span class="o">&amp;</span> <span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>The following program provides the Trace representation over <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/> of a Vector Boolean function with Truth Table in a file with extension “.tt”. <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/> is constructed with the irreducible polynomial whose corresponding GF2X representation is in a file with extension “.irr”. The class GF2X implements polynomial arithmetic modulo 2 and a polynomial is represented as a coefficient vector.</p>
<div class="highlight-c"><div class="highlight"><pre><span class="cp">#include &lt;iostream&gt;</span>
<span class="cp">#include &lt;fstream&gt;</span>
<span class="cp">#include &quot;VBF.h&quot;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span>
<span class="p">{</span>
   <span class="n">using</span> <span class="n">namespace</span> <span class="n">VBFNS</span><span class="p">;</span>

   <span class="n">VBF</span>          <span class="n">F</span><span class="p">;</span>
   <span class="n">NTL</span><span class="o">::</span><span class="n">mat_GF2</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">GF2X</span> <span class="n">g</span><span class="p">;</span>
   <span class="n">GF2EX</span> <span class="n">f</span><span class="p">;</span>
   <span class="kt">int</span> <span class="n">d</span><span class="p">;</span>
   <span class="kt">char</span> <span class="n">file</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.irr&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ifstream</span> <span class="n">input1</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input1</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input1</span> <span class="o">&gt;&gt;</span> <span class="n">g</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">putirrpol</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
   <span class="n">input1</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">sprintf</span><span class="p">(</span><span class="n">file</span><span class="p">,</span><span class="s">&quot;%s.tt&quot;</span><span class="p">,</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]);</span>
   <span class="n">ifstream</span> <span class="n">input</span><span class="p">(</span><span class="n">file</span><span class="p">);</span>
   <span class="k">if</span><span class="p">(</span><span class="o">!</span><span class="n">input</span><span class="p">)</span> <span class="p">{</span>
      <span class="n">cerr</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;Error opening &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">file</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
      <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
   <span class="p">}</span>
   <span class="n">input</span> <span class="o">&gt;&gt;</span> <span class="n">T</span><span class="p">;</span>
   <span class="n">F</span><span class="p">.</span><span class="n">puttt</span><span class="p">(</span><span class="n">T</span><span class="p">);</span>
   <span class="n">input</span><span class="p">.</span><span class="n">close</span><span class="p">();</span>

   <span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">&quot;The trace representation is &quot;</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
   <span class="n">f</span> <span class="o">=</span> <span class="n">Trace</span><span class="p">(</span><span class="n">F</span><span class="p">);</span>
   <span class="n">d</span> <span class="o">=</span> <span class="n">deg</span><span class="p">(</span><span class="n">g</span><span class="p">);</span>
   <span class="n">print</span><span class="p">(</span><span class="n">cout</span><span class="p">,</span><span class="n">f</span><span class="p">,</span><span class="n">d</span><span class="p">);</span>

   <span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>In this cipher, <img class="math" src="../images/math/775382db92bf1a061ee03b1ac0d0fd46abdf6cf5.png" alt="\gf{GF(2^8)}"/> is constructed with the irreducible polynomial <img class="math" src="../images/math/d2b761984e8df10955320ba48ae358bab414b193.png" alt="g(\vec{x}) = {\vec{x}}^8+{\vec{x}}^4+{\vec{x}}^3+\vec{x}+\vec{1}"/>. The inputs of this program would be the Truth Table of <img class="math" src="../images/math/fe3bc1432d4848ccb2b049c70b1d52ecd4255783.png" alt="S_{RD}"/> in a file with extension “.tt” and the corresponding GF2X representation of <img class="math" src="../images/math/7d2c699ad6e53faddcd02758a0d028bfc6fdb959.png" alt="g: [1 1 0 1 1 0 0 0 1]"/> in a file with extension “.irr”. The output of the program would be a GF2EX which represents polynomials over GF2E, and so can be used, for example, for arithmetic in <img class="math" src="../images/math/a16b2a1e3c941e219b292cbba12545321112d3ff.png" alt="\gf{GF(2^n)}"/>:</p>
<div class="math">
<p><img src="../images/math/08106a81fee14072c327b61f9a903dbdeedc5d62.png" alt="05 \cdot x^{254} + 09 \cdot x^{253} + f9 \cdot x^{251} + 25 \cdot x^{247} + f4 \cdot x^{239} + 01 \cdot x^{223} + b5 \cdot x^{191} + 8f \cdot x^{127} + 63"/></p>
</div><p>The coefficients are elements of <img class="math" src="../images/math/775382db92bf1a061ee03b1ac0d0fd46abdf6cf5.png" alt="\gf{GF(2^8)}"/>.</p>
</div>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2015, Jose Antonio Alvarez Cubero.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'../',
            VERSION:'1.0.1',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="../static/jquery.js"></script>
      <script type="text/javascript" src="../static/underscore.js"></script>
      <script type="text/javascript" src="../static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="../static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>